/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={752:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(730),o=n(582),a=n(19),c=n(313),u=n(424),l=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")},e}(),h="@firebase/app",d="0.9.24",p=new a.Logger("@firebase/app"),f="[DEFAULT]",m=((r={})[h]="fire-core",r["@firebase/app-compat"]="fire-core-compat",r["@firebase/analytics"]="fire-analytics",r["@firebase/analytics-compat"]="fire-analytics-compat",r["@firebase/app-check"]="fire-app-check",r["@firebase/app-check-compat"]="fire-app-check-compat",r["@firebase/auth"]="fire-auth",r["@firebase/auth-compat"]="fire-auth-compat",r["@firebase/database"]="fire-rtdb",r["@firebase/database-compat"]="fire-rtdb-compat",r["@firebase/functions"]="fire-fn",r["@firebase/functions-compat"]="fire-fn-compat",r["@firebase/installations"]="fire-iid",r["@firebase/installations-compat"]="fire-iid-compat",r["@firebase/messaging"]="fire-fcm",r["@firebase/messaging-compat"]="fire-fcm-compat",r["@firebase/performance"]="fire-perf",r["@firebase/performance-compat"]="fire-perf-compat",r["@firebase/remote-config"]="fire-rc",r["@firebase/remote-config-compat"]="fire-rc-compat",r["@firebase/storage"]="fire-gcs",r["@firebase/storage-compat"]="fire-gcs-compat",r["@firebase/firestore"]="fire-fst",r["@firebase/firestore-compat"]="fire-fst-compat",r["fire-js"]="fire-js",r.firebase="fire-js-all",r),g=new Map,y=new Map;function v(e,t){try{e.container.addComponent(t)}catch(n){p.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function w(e){var t,n,r=e.name;if(y.has(r))return p.debug("There were multiple attempts to register component ".concat(r,".")),!1;y.set(r,e);try{for(var i=o.__values(g.values()),s=i.next();!s.done;s=i.next())v(s.value,e)}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!0}function b(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var E=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call initializeApp() first",i["bad-app-name"]="Illegal App name: '{$appName}",i["duplicate-app"]="Firebase App named '{$appName}' already exists with different options or config",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["no-options"]="Need to provide options, when not being deployed to hosting via source.",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i["idb-open"]="Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",i["idb-get"]="Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",i["idb-set"]="Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",i["idb-delete"]="Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.",i),_=new c.ErrorFactory("app","Firebase",E),C=function(){function e(e,t,n){var r=this;this._isDeleted=!1,this._options=o.__assign({},e),this._config=o.__assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new s.Component("app",(function(){return r}),"PUBLIC"))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed(),this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed(),this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return this.checkDestroyed(),this._config},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function(){return this._isDeleted},set:function(e){this._isDeleted=e},enumerable:!1,configurable:!0}),e.prototype.checkDestroyed=function(){if(this.isDeleted)throw _.create("app-deleted",{appName:this._name})},e}();function I(e,t){var n,r;void 0===t&&(t={});var i=e;"object"!=typeof t&&(t={name:t});var a=o.__assign({name:f,automaticDataCollectionEnabled:!1},t),u=a.name;if("string"!=typeof u||!u)throw _.create("bad-app-name",{appName:String(u)});if(i||(i=c.getDefaultAppConfig()),!i)throw _.create("no-options");var l=g.get(u);if(l){if(c.deepEqual(i,l.options)&&c.deepEqual(a,l.config))return l;throw _.create("duplicate-app",{appName:u})}var h=new s.ComponentContainer(u);try{for(var d=o.__values(y.values()),p=d.next();!p.done;p=d.next()){var m=p.value;h.addComponent(m)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}var v=new C(i,a,h);return g.set(u,v),v}function S(e,t,n){var r,i=null!==(r=m[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var c=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&c.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&c.push("and"),a&&c.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void p.warn(c.join(" "))}w(new s.Component("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}var D="firebase-heartbeat-database",T=1,A="firebase-heartbeat-store",x=null;function k(){return x||(x=u.openDB(D,T,{upgrade:function(e,t){0===t&&e.createObjectStore(A)}}).catch((function(e){throw _.create("idb-open",{originalErrorMessage:e.message})}))),x}function P(e){return o.__awaiter(this,void 0,void 0,(function(){var t,n;return o.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,k()];case 1:return[4,r.sent().transaction(A).objectStore(A).get(N(e))];case 2:return[2,r.sent()];case 3:return(t=r.sent())instanceof c.FirebaseError?p.warn(t.message):(n=_.create("idb-get",{originalErrorMessage:null==t?void 0:t.message}),p.warn(n.message)),[3,4];case 4:return[2]}}))}))}function L(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,k()];case 1:return n=o.sent(),[4,(r=n.transaction(A,"readwrite")).objectStore(A).put(t,N(e))];case 2:return o.sent(),[4,r.done];case 3:return o.sent(),[3,5];case 4:return(i=o.sent())instanceof c.FirebaseError?p.warn(i.message):(s=_.create("idb-set",{originalErrorMessage:null==i?void 0:i.message}),p.warn(s.message)),[3,5];case 5:return[2]}}))}))}function N(e){return"".concat(e.name,"!").concat(e.options.appId)}var O=function(){function e(e){var t=this;this.container=e,this._heartbeatsCache=null;var n=this.container.getProvider("app").getImmediate();this._storage=new R(n),this._heartbeatsCachePromise=this._storage.read().then((function(e){return t._heartbeatsCache=e,e}))}return e.prototype.triggerHeartbeat=function(){var e,t;return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,s;return o.__generator(this,(function(o){switch(o.label){case 0:return n=this.container.getProvider("platform-logger").getImmediate(),r=n.getPlatformInfoString(),i=M(),null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)?[3,2]:(s=this,[4,this._heartbeatsCachePromise]);case 1:if(s._heartbeatsCache=o.sent(),null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return[2];o.label=2;case 2:return this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((function(e){return e.date===i}))?[2]:(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),[2,this._storage.overwrite(this._heartbeatsCache)])}}))}))},e.prototype.getHeartbeatsHeader=function(){var e;return o.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,s;return o.__generator(this,(function(a){switch(a.label){case 0:return null!==this._heartbeatsCache?[3,2]:[4,this._heartbeatsCachePromise];case 1:a.sent(),a.label=2;case 2:return null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length?[2,""]:(t=M(),n=function(e,t){var n,r;void 0===t&&(t=1024);var i=[],s=e.slice(),a=function(e){var n=i.find((function(t){return t.agent===e.agent}));if(n){if(n.dates.push(e.date),F(i)>t)return n.dates.pop(),"break"}else if(i.push({agent:e.agent,dates:[e.date]}),F(i)>t)return i.pop(),"break";s=s.slice(1)};try{for(var c=o.__values(e),u=c.next();!u.done&&"break"!==a(u.value);u=c.next());}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return{heartbeatsToSend:i,unsentEntries:s}}(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,i=n.unsentEntries,s=c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,[4,this._storage.overwrite(this._heartbeatsCache)]):[3,4]);case 3:return a.sent(),[3,5];case 4:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache),a.label=5;case 5:return[2,s]}}))}))},e}();function M(){return(new Date).toISOString().substring(0,10)}var R=function(){function e(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e.prototype.runIndexedDBEnvironmentCheck=function(){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(e){return c.isIndexedDBAvailable()?[2,c.validateIndexedDBOpenable().then((function(){return!0})).catch((function(){return!1}))]:[2,!1]}))}))},e.prototype.read=function(){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(t){switch(t.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return t.sent()?[3,2]:[2,{heartbeats:[]}];case 2:return[4,P(this.app)];case 3:return(null==(e=t.sent())?void 0:e.heartbeats)?[2,e]:[2,{heartbeats:[]}];case 4:return[2]}}))}))},e.prototype.overwrite=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,L(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})]}}))}))},e.prototype.add=function(e){var t;return o.__awaiter(this,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return[4,this._canUseIndexedDBPromise];case 1:return r.sent()?[3,2]:[2];case 2:return[4,this.read()];case 3:return n=r.sent(),[2,L(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:o.__spreadArray(o.__spreadArray([],o.__read(n.heartbeats),!1),o.__read(e.heartbeats),!1)})]}}))}))},e}();function F(e){return c.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}w(new s.Component("platform-logger",(function(e){return new l(e)}),"PRIVATE")),w(new s.Component("heartbeat",(function(e){return new O(e)}),"PRIVATE")),S(h,d,"node"),S(h,d,"cjs5"),S("fire-js",""),Object.defineProperty(t,"FirebaseError",{enumerable:!0,get:function(){return c.FirebaseError}}),t.SDK_VERSION="10.7.0",t._DEFAULT_ENTRY_NAME=f,t._addComponent=v,t._addOrOverwriteComponent=function(e,t){e.container.addOrOverwriteComponent(t)},t._apps=g,t._clearComponents=function(){y.clear()},t._components=y,t._getProvider=b,t._registerComponent=w,t._removeServiceInstance=function(e,t,n){void 0===n&&(n=f),b(e,t).clearInstance(n)},t.deleteApp=function(e){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(n){switch(n.label){case 0:return t=e.name,g.has(t)?(g.delete(t),[4,Promise.all(e.container.getProviders().map((function(e){return e.delete()})))]):[3,2];case 1:n.sent(),e.isDeleted=!0,n.label=2;case 2:return[2]}}))}))},t.getApp=function(e){void 0===e&&(e=f);var t=g.get(e);if(!t&&e===f&&c.getDefaultAppConfig())return I();if(!t)throw _.create("no-app",{appName:e});return t},t.getApps=function(){return Array.from(g.values())},t.initializeApp=I,t.onLog=function(e,t){if(null!==e&&"function"!=typeof e)throw _.create("invalid-log-argument");a.setUserLogHandler(e,t)},t.registerVersion=S,t.setLogLevel=function(e){a.setLogLevel(e)}},730:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(582),i=n(313),s=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),o="[DEFAULT]",a=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.Deferred;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}try{for(var i=r.__values(this.instancesDeferred.entries()),s=i.next();!s.done;s=i.next()){var a=r.__read(s.value,2),c=a[0],u=a[1],l=this.normalizeInstanceIdentifier(c);try{var h=this.getOrInitializeService({instanceIdentifier:l});u.resolve(h)}catch(e){}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=o),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var e;return r.__generator(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(r.__spreadArray(r.__spreadArray([],r.__read(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),!1),r.__read(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()}))),!1))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=o),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e=o),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.options,s=void 0===i?{}:i,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error("".concat(this.name,"(").concat(o,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=r.__values(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=r.__read(u.value,2),h=l[0],d=l[1];o===this.normalizeInstanceIdentifier(h)&&d.resolve(a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i,s=this.onInitCallbacks.get(t);if(s)try{for(var o=r.__values(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===o?void 0:t),options:i}),this.instances.set(n,s),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=o),this.component?this.component.multipleInstances?e:o:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}(),c=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new a(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}();t.Component=s,t.ComponentContainer=c,t.Provider=a},23:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(752),i=n(730),s=n(19),o=n(313),a=n(816);const c="@firebase/firestore";class u{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}u.UNAUTHENTICATED=new u(null),u.GOOGLE_CREDENTIALS=new u("google-credentials-uid"),u.FIRST_PARTY=new u("first-party-uid"),u.MOCK_USER=new u("mock-user");let l="10.7.0";const h=new s.Logger("@firebase/firestore");function d(){return h.logLevel}function p(e,...t){if(h.logLevel<=s.LogLevel.DEBUG){const n=t.map(g);h.debug(`Firestore (${l}): ${e}`,...n)}}function f(e,...t){if(h.logLevel<=s.LogLevel.ERROR){const n=t.map(g);h.error(`Firestore (${l}): ${e}`,...n)}}function m(e,...t){if(h.logLevel<=s.LogLevel.WARN){const n=t.map(g);h.warn(`Firestore (${l}): ${e}`,...n)}}function g(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function y(e="Unexpected state"){const t=`FIRESTORE (${l}) INTERNAL ASSERTION FAILED: `+e;throw f(t),new Error(t)}function v(e,t){e||y()}function w(e,t){return e}const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class E extends o.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class C{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(u.UNAUTHENTICATED)))}shutdown(){}}class S{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class D{constructor(e){this.t=e,this.currentUser=u.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new _;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new _,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{p("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(p("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new _)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(p("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(v("string"==typeof t.accessToken),new C(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return v(null===e||"string"==typeof e),new u(e)}}class T{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=u.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class A{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new T(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(u.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class x{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&p("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,p("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{p("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):p("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(v("string"==typeof e.token),this.R=e.token,new x(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function P(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class L{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=P(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function N(e,t){return e<t?-1:e>t?1:0}function O(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function M(e){return e+"\0"}class R{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new E(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new E(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new E(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new E(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return R.fromMillis(Date.now())}static fromDate(e){return R.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new R(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?N(this.nanoseconds,e.nanoseconds):N(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class F{constructor(e){this.timestamp=e}static fromTimestamp(e){return new F(e)}static min(){return new F(new R(0,0))}static max(){return new F(new R(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class j{constructor(e,t,n){void 0===t?t=0:t>e.length&&y(),void 0===n?n=e.length-t:n>e.length-t&&y(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===j.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof j?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class V extends j{construct(e,t,n){return new V(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new E(b.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new V(t)}static emptyPath(){return new V([])}}const B=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class U extends j{construct(e,t,n){return new U(e,t,n)}static isValidIdentifier(e){return B.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),U.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new U(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new E(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new E(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new E(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new E(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new U(t)}static emptyPath(){return new U([])}}class q{constructor(e){this.path=e}static fromPath(e){return new q(V.fromString(e))}static fromName(e){return new q(V.fromString(e).popFirst(5))}static empty(){return new q(V.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===V.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return V.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new q(new V(e.slice()))}}class z{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function G(e){return e.fields.find((e=>2===e.kind))}function $(e){return e.fields.filter((e=>2!==e.kind))}function K(e,t){let n=N(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(n=Q(e.fields[r],t.fields[r]),0!==n)return n;return N(e.fields.length,t.fields.length)}z.UNKNOWN_ID=-1;class H{constructor(e,t){this.fieldPath=e,this.kind=t}}function Q(e,t){const n=U.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:N(e.kind,t.kind)}class W{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new W(0,J.min())}}function Y(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=F.fromTimestamp(1e9===r?new R(n+1,0):new R(n,r));return new J(i,q.empty(),t)}function X(e){return new J(e.readTime,e.key,-1)}class J{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new J(F.min(),q.empty(),-1)}static max(){return new J(F.max(),q.empty(),-1)}}function Z(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=q.comparator(e.documentKey,t.documentKey),0!==n?n:N(e.largestBatchId,t.largestBatchId))}const ee="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class te{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ne(e){if(e.code!==b.FAILED_PRECONDITION||e.message!==ee)throw e;p("LocalStore","Unexpectedly lost primary lease")}class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&y(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(e){return re.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,n)=>{t(e)}))}static reject(e){return new re(((t,n)=>{n(e)}))}static waitFor(e){return new re(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=re.resolve(!1);for(const n of e)t=t.next((e=>e?re.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new re(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new re(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class ie{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new _,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ae(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=de(t.target.error);this.V.reject(new ae(e,n))}}static open(e,t,n,r){try{return new ie(t,e.transaction(r,n))}catch(e){throw new ae(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(p("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ue(t)}}class se{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===se.S(o.getUA())&&f("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return p("SimpleDb","Removing database:",e),le(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!o.isIndexedDBAvailable())return!1;if(se.C())return!0;const e=o.getUA(),t=se.S(e),n=0<t&&t<10,r=se.v(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(p("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new ae(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new E(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new E(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new ae(e,r))},r.onupgradeneeded=e=>{p("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.N(t,r.transaction,e.oldVersion,this.version).next((()=>{p("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=e=>this.B(e)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.O(e);const t=ie.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),re.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(p("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class oe{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return le(this.k.delete())}}class ae extends E{constructor(e,t){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ce(e){return"IndexedDbTransactionError"===e.name}class ue{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(p("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(p("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),le(n)}add(e){return p("SimpleDb","ADD",this.store.name,e,e),le(this.store.add(e))}get(e){return le(this.store.get(e)).next((t=>(void 0===t&&(t=null),p("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return p("SimpleDb","DELETE",this.store.name,e),le(this.store.delete(e))}count(){return p("SimpleDb","COUNT",this.store.name),le(this.store.count())}W(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const e=this.cursor(n),t=[];return this.G(e,((e,n)=>{t.push(n)})).next((()=>t))}{const e=this.store.getAll(n.range);return new re(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new re(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}H(e,t){p("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.J=!1;const r=this.cursor(n);return this.G(r,((e,t,n)=>n.delete()))}Y(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Z(e){const t=this.cursor({});return new re(((n,r)=>{t.onerror=e=>{const t=de(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}G(e,t){const n=[];return new re(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new oe(i),o=t(i.primaryKey,i.value,s);if(o instanceof re){const e=o.catch((e=>(s.done(),re.reject(e))));n.push(e)}s.isDone?r():null===s.$?i.continue():i.continue(s.$)}})).next((()=>re.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.J?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function le(e){return new re(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=de(e.target.error);n(t)}}))}let he=!1;function de(e){const t=se.S(o.getUA());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new E("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return he||(he=!0,setTimeout((()=>{throw e}),0)),e}}return e}class pe{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){p("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{p("IndexBackiller",`Documents written: ${await this.X.te()}`)}catch(e){ce(e)?p("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await ne(e)}await this.ee(6e4)}))}}class fe{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.ne(t,e)))}ne(e,t){const n=new Set;let r=t,i=!0;return re.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return p("IndexBackiller",`Processing collection: ${t}`),this.re(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}re(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.ie(r,n))).next((n=>(p("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}ie(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=X(t);Z(r,n)>0&&(n=r)})),new J(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class me{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.se(e),this.oe=e=>t.writeSequenceNumber(e))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}function ge(e){return null==e}function ye(e){return 0===e&&1/e==-1/0}function ve(e){return"number"==typeof e&&Number.isInteger(e)&&!ye(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function we(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ee(t)),t=be(e.get(n),t);return Ee(t)}function be(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function Ee(e){return e+""}function _e(e){const t=e.length;if(v(t>=2),2===t)return v(""===e.charAt(0)&&""===e.charAt(1)),V.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&y(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:y()}s=t+2}return new V(r)}me._e=-1;const Ce=["userId","batchId"];function Ie(e,t){return[e,we(t)]}function Se(e,t,n){return[e,we(t),n]}const De={},Te=["prefixPath","collectionGroup","readTime","documentId"],Ae=["prefixPath","collectionGroup","documentId"],xe=["collectionGroup","readTime","prefixPath","documentId"],ke=["canonicalId","targetId"],Pe=["targetId","path"],Le=["path","targetId"],Ne=["collectionId","parent"],Oe=["indexId","uid"],Me=["uid","sequenceNumber"],Re=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Fe=["indexId","uid","orderedDocumentKey"],je=["userId","collectionPath","documentId"],Ve=["userId","collectionPath","largestBatchId"],Be=["userId","collectionGroup","largestBatchId"],Ue=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],qe=[...Ue,"documentOverlays"],ze=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ge=ze,$e=[...Ge,"indexConfiguration","indexState","indexEntries"];class Ke extends te{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function He(e,t){const n=w(e);return se.M(n.ae,t)}function Qe(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function We(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ye(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Xe{constructor(e,t){this.comparator=e,this.root=t||Ze.EMPTY}insert(e,t){return new Xe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new Xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Je(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Je(this.root,e,this.comparator,!1)}getReverseIterator(){return new Je(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Je(this.root,e,this.comparator,!0)}}class Je{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ze{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Ze.RED,this.left=null!=r?r:Ze.EMPTY,this.right=null!=i?i:Ze.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Ze(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ze.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ze.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw y();if(this.right.isRed())throw y();const e=this.left.check();if(e!==this.right.check())throw y();return e+(this.isRed()?0:1)}}Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1,Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw y()}get value(){throw y()}get color(){throw y()}get left(){throw y()}get right(){throw y()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Ze(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class et{constructor(e){this.comparator=e,this.data=new Xe(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new tt(this.data.getIterator())}getIteratorFrom(e){return new tt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof et))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new et(this.comparator);return t.data=e,t}}class tt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function nt(e){return e.hasNext()?e.getNext():void 0}class rt{constructor(e){this.fields=e,e.sort(U.comparator)}static empty(){return new rt([])}unionWith(e){let t=new et(U.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new rt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return O(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class it extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class st{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new it("Invalid base64 string: "+e):e}}(e);return new st(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new st(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return N(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}st.EMPTY_BYTE_STRING=new st("");const ot=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function at(e){if(v(!!e),"string"==typeof e){let t=0;const n=ot.exec(e);if(v(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:ct(e.seconds),nanos:ct(e.nanos)}}function ct(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ut(e){return"string"==typeof e?st.fromBase64String(e):st.fromUint8Array(e)}function lt(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ht(e){const t=e.mapValue.fields.__previous_value__;return lt(t)?ht(t):t}function dt(e){const t=at(e.mapValue.fields.__local_write_time__.timestampValue);return new R(t.seconds,t.nanos)}class pt{constructor(e,t,n,r,i,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class ft{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ft("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ft&&e.projectId===this.projectId&&e.database===this.database}}const mt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},gt={nullValue:"NULL_VALUE"};function yt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?lt(e)?4:Lt(e)?9007199254740991:10:y()}function vt(e,t){if(e===t)return!0;const n=yt(e);if(n!==yt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return dt(e).isEqual(dt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=at(e.timestampValue),r=at(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ut(e.bytesValue).isEqual(ut(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return ct(e.geoPointValue.latitude)===ct(t.geoPointValue.latitude)&&ct(e.geoPointValue.longitude)===ct(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return ct(e.integerValue)===ct(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=ct(e.doubleValue),r=ct(t.doubleValue);return n===r?ye(n)===ye(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return O(e.arrayValue.values||[],t.arrayValue.values||[],vt);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Qe(n)!==Qe(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!vt(n[e],r[e])))return!1;return!0}(e,t);default:return y()}}function wt(e,t){return void 0!==(e.values||[]).find((e=>vt(e,t)))}function bt(e,t){if(e===t)return 0;const n=yt(e),r=yt(t);if(n!==r)return N(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return N(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=ct(e.integerValue||e.doubleValue),r=ct(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Et(e.timestampValue,t.timestampValue);case 4:return Et(dt(e),dt(t));case 5:return N(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ut(e),r=ut(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=N(n[e],r[e]);if(0!==t)return t}return N(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=N(ct(e.latitude),ct(t.latitude));return 0!==n?n:N(ct(e.longitude),ct(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=bt(n[e],r[e]);if(t)return t}return N(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===mt.mapValue&&t===mt.mapValue)return 0;if(e===mt.mapValue)return 1;if(t===mt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=N(r[e],s[e]);if(0!==t)return t;const o=bt(n[r[e]],i[s[e]]);if(0!==o)return o}return N(r.length,s.length)}(e.mapValue,t.mapValue);default:throw y()}}function Et(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return N(e,t);const n=at(e),r=at(t),i=N(n.seconds,r.seconds);return 0!==i?i:N(n.nanos,r.nanos)}function _t(e){return Ct(e)}function Ct(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=at(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ut(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return q.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ct(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Ct(e.fields[i])}`;return n+"}"}(e.mapValue):y()}function It(e){switch(yt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ht(e);return t?16+It(t):16;case 5:return 2*e.stringValue.length;case 6:return ut(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+It(t)),0)}(e.arrayValue);case 10:return function(e){let t=0;return We(e.fields,((e,n)=>{t+=e.length+It(n)})),t}(e.mapValue);default:throw y()}}function St(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Dt(e){return!!e&&"integerValue"in e}function Tt(e){return!!e&&"arrayValue"in e}function At(e){return!!e&&"nullValue"in e}function xt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function kt(e){return!!e&&"mapValue"in e}function Pt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return We(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Pt(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Pt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Lt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Nt(e){return"nullValue"in e?gt:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?St(ft.empty(),q.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:y()}function Ot(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?St(ft.empty(),q.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?mt:y()}function Mt(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Rt(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Ft{constructor(e){this.value=e}static empty(){return new Ft({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!kt(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pt(t)}setAll(e){let t=U.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Pt(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());kt(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return vt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];kt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){We(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Ft(Pt(this.value))}}function jt(e){const t=[];return We(e.fields,((e,n)=>{const r=new U([e]);if(kt(n)){const e=jt(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new rt(t)}class Vt{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Vt(e,0,F.min(),F.min(),F.min(),Ft.empty(),0)}static newFoundDocument(e,t,n,r){return new Vt(e,1,t,F.min(),n,r,0)}static newNoDocument(e,t){return new Vt(e,2,t,F.min(),F.min(),Ft.empty(),0)}static newUnknownDocument(e,t){return new Vt(e,3,t,F.min(),F.min(),Ft.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(F.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ft.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ft.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=F.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Bt{constructor(e,t){this.position=e,this.inclusive=t}}function Ut(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?q.comparator(q.fromName(o.referenceValue),n.key):bt(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function qt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!vt(e.position[n],t.position[n]))return!1;return!0}class zt{constructor(e,t="asc"){this.field=e,this.dir=t}}function Gt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class $t{}class Kt extends $t{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new nn(e,t,n):"array-contains"===t?new an(e,n):"in"===t?new cn(e,n):"not-in"===t?new un(e,n):"array-contains-any"===t?new ln(e,n):new Kt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new rn(e,n):new sn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(bt(t,this.value)):null!==t&&yt(this.value)===yt(t)&&this.matchesComparison(bt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return y()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ht extends $t{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Ht(e,t)}matches(e){return Qt(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Qt(e){return"and"===e.op}function Wt(e){return"or"===e.op}function Yt(e){return Xt(e)&&Qt(e)}function Xt(e){for(const t of e.filters)if(t instanceof Ht)return!1;return!0}function Jt(e){if(e instanceof Kt)return e.field.canonicalString()+e.op.toString()+_t(e.value);if(Yt(e))return e.filters.map((e=>Jt(e))).join(",");{const t=e.filters.map((e=>Jt(e))).join(",");return`${e.op}(${t})`}}function Zt(e,t){return e instanceof Kt?function(e,t){return t instanceof Kt&&e.op===t.op&&e.field.isEqual(t.field)&&vt(e.value,t.value)}(e,t):e instanceof Ht?function(e,t){return t instanceof Ht&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Zt(n,t.filters[r])),!0)}(e,t):void y()}function en(e,t){const n=e.filters.concat(t);return Ht.create(n,e.op)}function tn(e){return e instanceof Kt?function(e){return`${e.field.canonicalString()} ${e.op} ${_t(e.value)}`}(e):e instanceof Ht?function(e){return e.op.toString()+" {"+e.getFilters().map(tn).join(" ,")+"}"}(e):"Filter"}class nn extends Kt{constructor(e,t,n){super(e,t,n),this.key=q.fromName(n.referenceValue)}matches(e){const t=q.comparator(e.key,this.key);return this.matchesComparison(t)}}class rn extends Kt{constructor(e,t){super(e,"in",t),this.keys=on(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class sn extends Kt{constructor(e,t){super(e,"not-in",t),this.keys=on(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function on(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>q.fromName(e.referenceValue)))}class an extends Kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Tt(t)&&wt(t.arrayValue,this.value)}}class cn extends Kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&wt(this.value.arrayValue,t)}}class un extends Kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(wt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!wt(this.value.arrayValue,t)}}class ln extends Kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Tt(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>wt(this.value.arrayValue,e)))}}class hn{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ce=null}}function dn(e,t=null,n=[],r=[],i=null,s=null,o=null){return new hn(e,t,n,r,i,s,o)}function pn(e){const t=w(e);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Jt(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),ge(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>_t(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>_t(e))).join(",")),t.ce=e}return t.ce}function fn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Gt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Zt(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!qt(e.startAt,t.startAt)&&qt(e.endAt,t.endAt)}function mn(e){return q.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function gn(e,t){return e.filters.filter((e=>e instanceof Kt&&e.field.isEqual(t)))}function yn(e,t,n){let r=gt,i=!0;for(const n of gn(e,t)){let e=gt,t=!0;switch(n.op){case"<":case"<=":e=Nt(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=gt}Mt({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Mt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function vn(e,t,n){let r=mt,i=!0;for(const n of gn(e,t)){let e=mt,t=!0;switch(n.op){case">=":case">":e=Ot(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=mt}Rt({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Rt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class wn{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function bn(e,t,n,r,i,s,o,a){return new wn(e,t,n,r,i,s,o,a)}function En(e){return new wn(e)}function _n(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Cn(e){return null!==e.collectionGroup}function In(e){const t=w(e);if(null===t.le){t.le=[];const e=new Set;for(const n of t.explicitOrderBy)t.le.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new et(U.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.le.push(new zt(r,n))})),e.has(U.keyField().canonicalString())||t.le.push(new zt(U.keyField(),n))}return t.le}function Sn(e){const t=w(e);return t.he||(t.he=Dn(t,In(e))),t.he}function Dn(e,t){if("F"===e.limitType)return dn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new zt(e.field,t)}));const n=e.endAt?new Bt(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Bt(e.startAt.position,e.startAt.inclusive):null;return dn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Tn(e,t){const n=e.filters.concat([t]);return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function An(e,t,n){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function xn(e,t){return fn(Sn(e),Sn(t))&&e.limitType===t.limitType}function kn(e){return`${pn(Sn(e))}|lt:${e.limitType}`}function Pn(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>tn(e))).join(", ")}]`),ge(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>_t(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>_t(e))).join(",")),`Target(${t})`}(Sn(e))}; limitType=${e.limitType})`}function Ln(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):q.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of In(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ut(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,In(e),t)||e.endAt&&!function(e,t,n){const r=Ut(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,In(e),t))}(e,t)}function Nn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function On(e){return(t,n)=>{let r=!1;for(const i of In(e)){const e=Mn(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Mn(e,t,n){const r=e.field.isKeyField()?q.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?bt(r,i):y()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return y()}}class Rn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){We(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return Ye(this.inner)}size(){return this.innerSize}}const Fn=new Xe(q.comparator);function jn(){return Fn}const Vn=new Xe(q.comparator);function Bn(...e){let t=Vn;for(const n of e)t=t.insert(n.key,n);return t}function Un(e){let t=Vn;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function qn(){return Gn()}function zn(){return Gn()}function Gn(){return new Rn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const $n=new Xe(q.comparator),Kn=new et(q.comparator);function Hn(...e){let t=Kn;for(const n of e)t=t.add(n);return t}const Qn=new et(N);function Wn(){return Qn}function Yn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ye(t)?"-0":t}}function Xn(e){return{integerValue:""+e}}function Jn(e,t){return ve(t)?Xn(t):Yn(e,t)}class Zn{constructor(){this._=void 0}}function er(e,t,n){return e instanceof rr?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&lt(t)&&(t=ht(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof ir?sr(e,t):e instanceof or?ar(e,t):function(e,t){const n=nr(e,t),r=ur(n)+ur(e.Ie);return Dt(n)&&Dt(e.Ie)?Xn(r):Yn(e.serializer,r)}(e,t)}function tr(e,t,n){return e instanceof ir?sr(e,t):e instanceof or?ar(e,t):n}function nr(e,t){return e instanceof cr?function(e){return Dt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class rr extends Zn{}class ir extends Zn{constructor(e){super(),this.elements=e}}function sr(e,t){const n=lr(t);for(const t of e.elements)n.some((e=>vt(e,t)))||n.push(t);return{arrayValue:{values:n}}}class or extends Zn{constructor(e){super(),this.elements=e}}function ar(e,t){let n=lr(t);for(const t of e.elements)n=n.filter((e=>!vt(e,t)));return{arrayValue:{values:n}}}class cr extends Zn{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function ur(e){return ct(e.integerValue||e.doubleValue)}function lr(e){return Tt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class hr{constructor(e,t){this.field=e,this.transform=t}}class dr{constructor(e,t){this.version=e,this.transformResults=t}}class pr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new pr}static exists(e){return new pr(void 0,e)}static updateTime(e){return new pr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function fr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class mr{}function gr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Dr(e.key,pr.none()):new Er(e.key,e.data,pr.none());{const n=e.data,r=Ft.empty();let i=new et(U.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new _r(e.key,r,new rt(i.toArray()),pr.none())}}function yr(e,t,n){e instanceof Er?function(e,t,n){const r=e.value.clone(),i=Ir(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof _r?function(e,t,n){if(!fr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Ir(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Cr(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function vr(e,t,n,r){return e instanceof Er?function(e,t,n,r){if(!fr(e.precondition,t))return n;const i=e.value.clone(),s=Sr(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof _r?function(e,t,n,r){if(!fr(e.precondition,t))return n;const i=Sr(e.fieldTransforms,r,t),s=t.data;return s.setAll(Cr(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return fr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function wr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=nr(r.transform,e||null);null!=i&&(null===n&&(n=Ft.empty()),n.set(r.field,i))}return n||null}function br(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&O(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ir&&t instanceof ir||e instanceof or&&t instanceof or?O(e.elements,t.elements,vt):e instanceof cr&&t instanceof cr?vt(e.Ie,t.Ie):e instanceof rr&&t instanceof rr}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Er extends mr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _r extends mr{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Cr(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Ir(e,t,n){const r=new Map;v(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,tr(o,a,n[i]))}return r}function Sr(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,er(e,s,t))}return r}class Dr extends mr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Tr extends mr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ar{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&yr(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=vr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=vr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=zn();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=gr(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(F.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Hn())}isEqual(e){return this.batchId===e.batchId&&O(this.mutations,e.mutations,((e,t)=>br(e,t)))&&O(this.baseMutations,e.baseMutations,((e,t)=>br(e,t)))}}class xr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){v(e.mutations.length===n.length);let r=$n;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new xr(e,t,n,r)}}class kr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Pr{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}class Lr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Nr,Or;function Mr(e){switch(e){default:return y();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function Rr(e){if(void 0===e)return f("GRPC error has no .code"),b.UNKNOWN;switch(e){case Nr.OK:return b.OK;case Nr.CANCELLED:return b.CANCELLED;case Nr.UNKNOWN:return b.UNKNOWN;case Nr.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case Nr.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case Nr.INTERNAL:return b.INTERNAL;case Nr.UNAVAILABLE:return b.UNAVAILABLE;case Nr.UNAUTHENTICATED:return b.UNAUTHENTICATED;case Nr.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case Nr.NOT_FOUND:return b.NOT_FOUND;case Nr.ALREADY_EXISTS:return b.ALREADY_EXISTS;case Nr.PERMISSION_DENIED:return b.PERMISSION_DENIED;case Nr.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case Nr.ABORTED:return b.ABORTED;case Nr.OUT_OF_RANGE:return b.OUT_OF_RANGE;case Nr.UNIMPLEMENTED:return b.UNIMPLEMENTED;case Nr.DATA_LOSS:return b.DATA_LOSS;default:return y()}}(Or=Nr||(Nr={}))[Or.OK=0]="OK",Or[Or.CANCELLED=1]="CANCELLED",Or[Or.UNKNOWN=2]="UNKNOWN",Or[Or.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Or[Or.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Or[Or.NOT_FOUND=5]="NOT_FOUND",Or[Or.ALREADY_EXISTS=6]="ALREADY_EXISTS",Or[Or.PERMISSION_DENIED=7]="PERMISSION_DENIED",Or[Or.UNAUTHENTICATED=16]="UNAUTHENTICATED",Or[Or.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Or[Or.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Or[Or.ABORTED=10]="ABORTED",Or[Or.OUT_OF_RANGE=11]="OUT_OF_RANGE",Or[Or.UNIMPLEMENTED=12]="UNIMPLEMENTED",Or[Or.INTERNAL=13]="INTERNAL",Or[Or.UNAVAILABLE=14]="UNAVAILABLE",Or[Or.DATA_LOSS=15]="DATA_LOSS";let Fr=null;function jr(){return new TextEncoder}const Vr=new a.Integer([4294967295,4294967295],0);function Br(e){const t=jr().encode(e),n=new a.Md5;return n.update(t),new Uint8Array(n.digest())}function Ur(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new a.Integer([n,r],0),new a.Integer([i,s],0)]}class qr{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new zr(`Invalid padding: ${t}`);if(n<0)throw new zr(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new zr(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new zr(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=a.Integer.fromNumber(this.Te)}de(e,t,n){let r=e.add(t.multiply(a.Integer.fromNumber(n)));return 1===r.compare(Vr)&&(r=new a.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=Br(e),[n,r]=Ur(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);if(!this.Ae(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new qr(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Te)return;const t=Br(e),[n,r]=Ur(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);this.Re(t)}}Re(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class zr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Gr{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,$r.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Gr(F.min(),r,new Xe(N),jn(),Hn())}}class $r{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new $r(n,t,Hn(),Hn(),Hn())}}class Kr{constructor(e,t,n,r){this.Ve=e,this.removedTargetIds=t,this.key=n,this.me=r}}class Hr{constructor(e,t){this.targetId=e,this.fe=t}}class Qr{constructor(e,t,n=st.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Wr{constructor(){this.ge=0,this.pe=Jr(),this.ye=st.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Hn(),t=Hn(),n=Hn();return this.pe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:y()}})),new $r(this.ye,this.we,e,t,n)}Fe(){this.Se=!1,this.pe=Jr()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,v(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Yr{constructor(e){this.Le=e,this.ke=new Map,this.qe=jn(),this.Qe=Xr(),this.Ke=new Xe(N)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,(t=>{const n=this.ze(t);switch(e.state){case 0:this.je(t)&&n.Ce(e.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(e.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(t);break;case 3:this.je(t)&&(n.Be(),n.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),n.Ce(e.resumeToken));break;default:y()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach(((e,n)=>{this.je(n)&&t(n)}))}Je(e){const t=e.targetId,n=e.fe.count,r=this.Ye(t);if(r){const i=r.target;if(mn(i))if(0===n){const e=new q(i.path);this.We(t,e,Vt.newNoDocument(e,F.min()))}else v(1===n);else{const r=this.Ze(t);if(r!==n){const n=this.Xe(e),i=n?this.et(n,e,r):1;if(0!==i){this.He(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==Fr||Fr.tt(function(e,t,n,r,i){var s,o,a,c,u,l;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(c=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(l=null===(u=null==d?void 0:d.bits)||void 0===u?void 0:u.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.fe,this.Le.nt(),n,i))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=ut(n).toUint8Array()}catch(e){if(e instanceof it)return m("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new qr(s,r,i)}catch(e){return m(e instanceof zr?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Te?null:o}et(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}rt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.nt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.We(t,n,null),r++)})),r}it(e){const t=new Map;this.ke.forEach(((n,r)=>{const i=this.Ye(r);if(i){if(n.current&&mn(i.target)){const t=new q(i.target.path);null!==this.qe.get(t)||this.st(r,t)||this.We(r,t,Vt.newNoDocument(t,e))}n.De&&(t.set(r,n.ve()),n.Fe())}}));let n=Hn();this.Qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.qe.forEach(((t,n)=>n.setReadTime(e)));const r=new Gr(e,t,this.Ke,this.qe,n);return this.qe=jn(),this.Qe=Xr(),this.Ke=new Xe(N),r}Ue(e,t){if(!this.je(e))return;const n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,n){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Wr,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new et(N),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||p("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Wr),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.We(e,t,null)}))}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Xr(){return new Xe(q.comparator)}function Jr(){return new Xe(q.comparator)}const Zr={asc:"ASCENDING",desc:"DESCENDING"},ei={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ti={and:"AND",or:"OR"};class ni{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ri(e,t){return e.useProto3Json||ge(t)?t:{value:t}}function ii(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function si(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function oi(e,t){return ii(e,t.toTimestamp())}function ai(e){return v(!!e),F.fromTimestamp(function(e){const t=at(e);return new R(t.seconds,t.nanos)}(e))}function ci(e,t){return function(e){return new V(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function ui(e){const t=V.fromString(e);return v(Pi(t)),t}function li(e,t){return ci(e.databaseId,t.path)}function hi(e,t){const n=ui(t);if(n.get(1)!==e.databaseId.projectId)throw new E(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new E(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new q(mi(n))}function di(e,t){return ci(e.databaseId,t)}function pi(e){const t=ui(e);return 4===t.length?V.emptyPath():mi(t)}function fi(e){return new V(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function mi(e){return v(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function gi(e,t,n){return{name:li(e,t),fields:n.value.mapValue.fields}}function yi(e,t,n){const r=hi(e,t.name),i=ai(t.updateTime),s=t.createTime?ai(t.createTime):F.min(),o=new Ft({mapValue:{fields:t.fields}}),a=Vt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function vi(e,t){let n;if(t instanceof Er)n={update:gi(e,t.key,t.value)};else if(t instanceof Dr)n={delete:li(e,t.key)};else if(t instanceof _r)n={update:gi(e,t.key,t.data),updateMask:ki(t.fieldMask)};else{if(!(t instanceof Tr))return y();n={verify:li(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof rr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ir)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof or)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof cr)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw y()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:oi(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:y()}(e,t.precondition)),n}function wi(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?pr.updateTime(ai(e.updateTime)):void 0!==e.exists?pr.exists(e.exists):pr.none()}(t.currentDocument):pr.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)v("REQUEST_TIME"===t.setToServerValue),n=new rr;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new ir(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new or(e)}else"increment"in t?n=new cr(e,t.increment):y();const r=U.fromServerFormat(t.fieldPath);return new hr(r,n)}(e,t))):[];if(t.update){t.update.name;const i=hi(e,t.update.name),s=new Ft({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new rt(t.map((e=>U.fromServerFormat(e))))}(t.updateMask);return new _r(i,s,e,n,r)}return new Er(i,s,n,r)}if(t.delete){const r=hi(e,t.delete);return new Dr(r,n)}if(t.verify){const r=hi(e,t.verify);return new Tr(r,n)}return y()}function bi(e,t){return{documents:[di(e,t.path)]}}function Ei(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=di(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=di(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return xi(Ht.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ti(e.field),direction:Ii(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=ri(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function _i(e){let t=pi(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){v(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ci(e);return t instanceof Ht&&Yt(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new zt(Ai(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ge(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Bt(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Bt(n,t)}(n.endAt)),bn(t,i,o,s,a,"F",c,u)}function Ci(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ai(e.unaryFilter.field);return Kt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ai(e.unaryFilter.field);return Kt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ai(e.unaryFilter.field);return Kt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ai(e.unaryFilter.field);return Kt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return y()}}(e):void 0!==e.fieldFilter?function(e){return Kt.create(Ai(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return y()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ht.create(e.compositeFilter.filters.map((e=>Ci(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return y()}}(e.compositeFilter.op))}(e):y()}function Ii(e){return Zr[e]}function Si(e){return ei[e]}function Di(e){return ti[e]}function Ti(e){return{fieldPath:e.canonicalString()}}function Ai(e){return U.fromServerFormat(e.fieldPath)}function xi(e){return e instanceof Kt?function(e){if("=="===e.op){if(xt(e.value))return{unaryFilter:{field:Ti(e.field),op:"IS_NAN"}};if(At(e.value))return{unaryFilter:{field:Ti(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(xt(e.value))return{unaryFilter:{field:Ti(e.field),op:"IS_NOT_NAN"}};if(At(e.value))return{unaryFilter:{field:Ti(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ti(e.field),op:Si(e.op),value:e.value}}}(e):e instanceof Ht?function(e){const t=e.getFilters().map((e=>xi(e)));return 1===t.length?t[0]:{compositeFilter:{op:Di(e.op),filters:t}}}(e):y()}function ki(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Pi(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Li{constructor(e,t,n,r,i=F.min(),s=F.min(),o=st.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ni{constructor(e){this.ut=e}}function Oi(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Mi(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:li(e,t.key),fields:t.data.value.mapValue.fields,updateTime:ii(e,t.version.toTimestamp()),createTime:ii(e,t.createTime.toTimestamp())}}(e.ut,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ri(t.version)};else{if(!t.isUnknownDocument())return y();r.unknownDocument={path:n.path.toArray(),version:Ri(t.version)}}return r}function Mi(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Ri(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Fi(e){const t=new R(e.seconds,e.nanoseconds);return F.fromTimestamp(t)}function ji(e,t){const n=(t.baseMutations||[]).map((t=>wi(e.ut,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>wi(e.ut,t))),i=R.fromMillis(t.localWriteTimeMs);return new Ar(t.batchId,i,n,r)}function Vi(e){const t=Fi(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Fi(e.lastLimboFreeSnapshotVersion):F.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return v(1===e.documents.length),Sn(En(pi(e.documents[0])))}(e.query):function(e){return Sn(_i(e))}(e.query),new Li(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,st.fromBase64String(e.resumeToken))}function Bi(e,t){const n=Ri(t.snapshotVersion),r=Ri(t.lastLimboFreeSnapshotVersion);let i;i=mn(t.target)?bi(e.ut,t.target):Ei(e.ut,t.target);const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:pn(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Ui(e){const t=_i({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?An(t,t.limit,"L"):t}function qi(e,t){return new kr(t.largestBatchId,wi(e.ut,t.overlayMutation))}function zi(e,t){const n=t.path.lastSegment();return[e,we(t.path.popLast()),n]}function Gi(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:Ri(r.readTime),documentKey:we(r.documentKey.path),largestBatchId:r.largestBatchId}}class $i{getBundleMetadata(e,t){return Ki(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Fi(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return Ki(e).put(function(e){return{bundleId:e.id,createTime:Ri(ai(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Hi(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:Ui(e.bundledQuery),readTime:Fi(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Hi(e).put(function(e){return{name:e.name,readTime:Ri(ai(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Ki(e){return He(e,"bundles")}function Hi(e){return He(e,"namedQueries")}class Qi{constructor(e,t){this.serializer=e,this.userId=t}static ct(e,t){const n=t.uid||"";return new Qi(e,n)}getOverlay(e,t){return Wi(e).get(zi(this.userId,t)).next((e=>e?qi(this.serializer,e):null))}getOverlays(e,t){const n=qn();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new kr(t,i);r.push(this.lt(e,s))})),re.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(we(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(Wi(e).H("collectionPathOverlayIndex",r))})),re.waitFor(i)}getOverlaysForCollection(e,t,n){const r=qn(),i=we(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Wi(e).W("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=qi(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=qn();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Wi(e).Y({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=qi(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}lt(e,t){return Wi(e).put(function(e,t,n){const[r,i,s]=zi(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:vi(e.ut,n.mutation)}}(this.serializer,this.userId,t))}}function Wi(e){return He(e,"documentOverlays")}class Yi{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(ct(e.integerValue));else if("doubleValue"in e){const n=ct(e.doubleValue);isNaN(n)?this.Tt(t,13):(this.Tt(t,15),ye(n)?t.Et(0):t.Et(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Tt(t,20),"string"==typeof n?t.dt(n):(t.dt(`${n.seconds||""}`),t.Et(n.nanos||0))}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(ut(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Tt(t,45),t.Et(n.latitude||0),t.Et(n.longitude||0)}else"mapValue"in e?Lt(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):y()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const n=e.fields||{};this.Tt(t,55);for(const e of Object.keys(n))this.At(e,t),this.Pt(n[e],t)}yt(e,t){const n=e.values||[];this.Tt(t,50);for(const e of n)this.Pt(e,t)}ft(e,t){this.Tt(t,37),q.fromName(e).path.forEach((e=>{this.Tt(t,60),this.wt(e,t)}))}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}function Xi(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function Ji(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Xi(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Yi.St=new Yi;class Zi{constructor(){this.buffer=new Uint8Array(1024),this.position=0}bt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Dt(n.value),n=t.next();this.Ct()}vt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Dt(e);else if(e<2048)this.Dt(960|e>>>6),this.Dt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Dt(480|e>>>12),this.Dt(128|63&e>>>6),this.Dt(128|63&e);else{const e=t.codePointAt(0);this.Dt(240|e>>>18),this.Dt(128|63&e>>>12),this.Dt(128|63&e>>>6),this.Dt(128|63&e)}}this.Ct()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ft(e);else if(e<2048)this.Ft(960|e>>>6),this.Ft(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e);else{const e=t.codePointAt(0);this.Ft(240|e>>>18),this.Ft(128|63&e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e)}}this.Mt()}Nt(e){const t=this.Bt(e),n=Ji(t);this.Lt(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}kt(e){const t=this.Bt(e),n=Ji(t);this.Lt(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}qt(){this.Qt(255),this.Qt(255)}Kt(){this.$t(255),this.$t(255)}reset(){this.position=0}seed(e){this.Lt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ut(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}Dt(e){const t=255&e;0===t?(this.Qt(0),this.Qt(255)):255===t?(this.Qt(255),this.Qt(0)):this.Qt(t)}Ft(e){const t=255&e;0===t?(this.$t(0),this.$t(255)):255===t?(this.$t(255),this.$t(0)):this.$t(e)}Ct(){this.Qt(0),this.Qt(1)}Mt(){this.$t(0),this.$t(1)}Qt(e){this.Lt(1),this.buffer[this.position++]=e}$t(e){this.Lt(1),this.buffer[this.position++]=~e}Lt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class es{constructor(e){this.Wt=e}Vt(e){this.Wt.bt(e)}dt(e){this.Wt.xt(e)}Et(e){this.Wt.Nt(e)}It(){this.Wt.qt()}}class ts{constructor(e){this.Wt=e}Vt(e){this.Wt.vt(e)}dt(e){this.Wt.Ot(e)}Et(e){this.Wt.kt(e)}It(){this.Wt.Kt()}}class ns{constructor(){this.Wt=new Zi,this.Gt=new es(this.Wt),this.zt=new ts(this.Wt)}seed(e){this.Wt.seed(e)}jt(e){return 0===e?this.Gt:this.zt}Ut(){return this.Wt.Ut()}reset(){this.Wt.reset()}}class rs{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Ht(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new rs(this.indexId,this.documentKey,this.arrayValue,n)}}function is(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=ss(e.arrayValue,t.arrayValue),0!==n?n:(n=ss(e.directionalValue,t.directionalValue),0!==n?n:q.comparator(e.documentKey,t.documentKey)))}function ss(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class os{constructor(e){this.Jt=new et(((e,t)=>U.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Jt=this.Jt.add(e):this.Zt.push(e)}}get Xt(){return this.Jt.size>1}en(e){if(v(e.collectionGroup===this.collectionId),this.Xt)return!1;const t=G(e);if(void 0!==t&&!this.tn(t))return!1;const n=$(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.tn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Jt.size>0){const e=this.Jt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.nn(e,t)||!this.rn(this.Yt[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.Yt.length||!this.rn(this.Yt[s++],e))return!1}return!0}sn(){if(this.Xt)return null;let e=new et(U.comparator);const t=[];for(const n of this.Zt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new H(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new H(n.field,0))}for(const n of this.Yt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new H(n.field,"asc"===n.dir?0:1)));return new z(z.UNKNOWN_ID,this.collectionId,t,W.empty())}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function as(e){var t,n;if(v(e instanceof Kt||e instanceof Ht),e instanceof Kt){if(e instanceof cn){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Kt.create(e.field,"==",t))))||[];return Ht.create(r,"or")}return e}const r=e.filters.map((e=>as(e)));return Ht.create(r,e.op)}function cs(e){if(0===e.getFilters().length)return[];const t=ds(as(e));return v(hs(t)),us(t)||ls(t)?[t]:t.getFilters()}function us(e){return e instanceof Kt}function ls(e){return e instanceof Ht&&Yt(e)}function hs(e){return us(e)||ls(e)||function(e){if(e instanceof Ht&&Wt(e)){for(const t of e.getFilters())if(!us(t)&&!ls(t))return!1;return!0}return!1}(e)}function ds(e){if(v(e instanceof Kt||e instanceof Ht),e instanceof Kt)return e;if(1===e.filters.length)return ds(e.filters[0]);const t=e.filters.map((e=>ds(e)));let n=Ht.create(t,e.op);return n=ms(n),hs(n)?n:(v(n instanceof Ht),v(Qt(n)),v(n.filters.length>1),n.filters.reduce(((e,t)=>ps(e,t))))}function ps(e,t){let n;return v(e instanceof Kt||e instanceof Ht),v(t instanceof Kt||t instanceof Ht),n=e instanceof Kt?t instanceof Kt?function(e,t){return Ht.create([e,t],"and")}(e,t):fs(e,t):t instanceof Kt?fs(t,e):function(e,t){if(v(e.filters.length>0&&t.filters.length>0),Qt(e)&&Qt(t))return en(e,t.getFilters());const n=Wt(e)?e:t,r=Wt(e)?t:e,i=n.filters.map((e=>ps(e,r)));return Ht.create(i,"or")}(e,t),ms(n)}function fs(e,t){if(Qt(t))return en(t,e.getFilters());{const n=t.filters.map((t=>ps(e,t)));return Ht.create(n,"or")}}function ms(e){if(v(e instanceof Kt||e instanceof Ht),e instanceof Kt)return e;const t=e.getFilters();if(1===t.length)return ms(t[0]);if(Xt(e))return e;const n=t.map((e=>ms(e))),r=[];return n.forEach((t=>{t instanceof Kt?r.push(t):t instanceof Ht&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:Ht.create(r,e.op)}class gs{constructor(){this.on=new ys}addToCollectionParentIndex(e,t){return this.on.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(J.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(J.min())}updateCollectionGroup(e,t,n){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class ys{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new et(V.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new et(V.comparator)).toArray()}}const vs=new Uint8Array(0);class ws{constructor(e,t){this.user=e,this.databaseId=t,this._n=new ys,this.an=new Rn((e=>pn(e)),((e,t)=>fn(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this._n.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this._n.add(t)}));const i={collectionId:n,parent:we(r)};return bs(e).put(i)}return re.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[M(t),""],!1,!0);return bs(e).W(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(_e(r.parent))}return n}))}addFieldIndex(e,t){const n=_s(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Cs(e);return i.next((e=>{n.put(Gi(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=_s(e),r=Cs(e),i=Es(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=_s(e),n=Es(e),r=Cs(e);return t.H().next((()=>n.H())).next((()=>r.H()))}createTargetIndexes(e,t){return re.forEach(this.un(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new os(t).sn();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Es(e);let r=!0;const i=new Map;return re.forEach(this.un(t),(t=>this.cn(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=Hn();const r=[];return re.forEach(i,((i,s)=>{p("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${pn(t)}`);const o=function(e,t){const n=G(t);if(void 0===n)return null;for(const t of gn(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of $(t))for(const t of gn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of $(t)){const t=0===i.kind?yn(e,i.fieldPath,e.startAt):vn(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new Bt(n,r)}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of $(t)){const t=0===i.kind?vn(e,i.fieldPath,e.endAt):yn(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new Bt(n,r)}(s,i),l=this.ln(i,s,c),h=this.ln(i,s,u),d=this.hn(i,s,a),f=this.Pn(i.indexId,o,l,c.inclusive,h,u.inclusive,d);return re.forEach(f,(i=>n.j(i,t.limit).next((t=>{t.forEach((t=>{const n=q.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return re.resolve(null)}))}un(e){let t=this.an.get(e);return t||(t=0===e.filters.length?[e]:cs(Ht.create(e.filters,"and")).map((t=>dn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.an.set(e,t),t)}Pn(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),u=[];for(let l=0;l<a;++l){const a=t?this.In(t[l/c]):vs,h=this.Tn(e,a,n[l%c],r),d=this.En(e,a,i[l%c],s),p=o.map((t=>this.Tn(e,a,t,!0)));u.push(...this.createRange(h,d,p))}return u}Tn(e,t,n,r){const i=new rs(e,q.empty(),t,n);return r?i:i.Ht()}En(e,t,n,r){const i=new rs(e,q.empty(),t,n);return r?i.Ht():i}cn(e,t){const n=new os(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.en(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.un(t);return re.forEach(r,(t=>this.cn(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new et(U.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}dn(e,t){const n=new ns;for(const r of $(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.jt(r.kind);Yi.St.ht(e,i)}return n.Ut()}In(e){const t=new ns;return Yi.St.ht(e,t.jt(0)),t.Ut()}An(e,t){const n=new ns;return Yi.St.ht(St(this.databaseId,t),n.jt(function(e){const t=$(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Ut()}hn(e,t,n){if(null===n)return[];let r=[];r.push(new ns);let i=0;for(const s of $(e)){const e=n[i++];for(const n of r)if(this.Rn(t,s.fieldPath)&&Tt(e))r=this.Vn(r,s,e);else{const t=n.jt(s.kind);Yi.St.ht(e,t)}}return this.mn(r)}ln(e,t,n){return this.hn(e,t,n.position)}mn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Ut();return t}Vn(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new ns;r.seed(n.Ut()),Yi.St.ht(e,r.jt(t.kind)),i.push(r)}return i}Rn(e,t){return!!e.filters.find((e=>e instanceof Kt&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=_s(e),r=Cs(e);return(t?n.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.W()).next((e=>{const t=[];return re.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new W(t.sequenceNumber,new J(Fi(t.readTime),new q(_e(t.documentKey)),t.largestBatchId)):W.empty(),r=e.fields.map((([e,t])=>new H(U.fromServerFormat(e),t)));return new z(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:N(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=_s(e),i=Cs(e);return this.fn(e).next((e=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>re.forEach(t,(t=>i.put(Gi(t.indexId,this.user,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return re.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?re.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),re.forEach(i,(n=>this.gn(e,t,n).next((t=>{const i=this.pn(r,n);return t.isEqual(i)?re.resolve():this.yn(e,r,n,t,i)})))))))}))}wn(e,t,n,r){return Es(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.An(n,t.key),documentKey:t.key.path.toArray()})}Sn(e,t,n,r){return Es(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.An(n,t.key),t.key.path.toArray()])}gn(e,t,n){const r=Es(e);let i=new et(is);return r.Y({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.An(n,t)])},((e,r)=>{i=i.add(new rs(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}pn(e,t){let n=new et(is);const r=this.dn(t,e);if(null==r)return n;const i=G(t);if(null!=i){const s=e.data.field(i.fieldPath);if(Tt(s))for(const i of s.arrayValue.values||[])n=n.add(new rs(t.indexId,e.key,this.In(i),r))}else n=n.add(new rs(t.indexId,e.key,vs,r));return n}yn(e,t,n,r,i){p("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=nt(s),c=nt(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=nt(o)):t?(i(a),a=nt(s)):(a=nt(s),c=nt(o))}}(r,i,is,(r=>{s.push(this.wn(e,t,n,r))}),(r=>{s.push(this.Sn(e,t,n,r))})),re.waitFor(s)}fn(e){let t=1;return Cs(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>is(e,t))).filter(((e,t,n)=>!t||0!==is(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=is(i,e),s=is(i,t);if(0===n)r[0]=e.Ht();else if(n>0&&s<0)r.push(i),r.push(i.Ht());else if(s>0)break}r.push(t);const i=[];for(let e=0;e<r.length;e+=2){if(this.bn(r[e],r[e+1]))return[];const t=[r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,vs,[]],n=[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,vs,[]];i.push(IDBKeyRange.bound(t,n))}return i}bn(e,t){return is(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Is)}getMinOffset(e,t){return re.mapArray(this.un(t),(t=>this.cn(e,t).next((e=>e||y())))).next(Is)}}function bs(e){return He(e,"collectionParents")}function Es(e){return He(e,"indexEntries")}function _s(e){return He(e,"indexConfiguration")}function Cs(e){return He(e,"indexState")}function Is(e){v(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Z(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new J(t.readTime,t.documentKey,n)}const Ss={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ds{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Ds(e,Ds.DEFAULT_COLLECTION_PERCENTILE,Ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Ts(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Y({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{v(1===a)})));const u=[];for(const e of n.mutations){const r=Se(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return re.waitFor(s).next((()=>u))}function As(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw y();t=e.noDocument}return JSON.stringify(t).length}Ds.DEFAULT_COLLECTION_PERCENTILE=10,Ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ds.DEFAULT=new Ds(41943040,Ds.DEFAULT_COLLECTION_PERCENTILE,Ds.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ds.DISABLED=new Ds(-1,0,0);class xs{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Dn={}}static ct(e,t,n,r){v(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new xs(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ps(e).Y({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=Ls(e),s=Ps(e);return s.add({}).next((o=>{v("number"==typeof o);const a=new Ar(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>vi(e.ut,t))),i=n.mutations.map((t=>vi(e.ut,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[];let l=new et(((e,t)=>N(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Se(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,De))}return l.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Dn[o]=a.keys()})),re.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return Ps(e).get(t).next((e=>e?(v(e.userId===this.userId),ji(this.serializer,e)):null))}Cn(e,t){return this.Dn[t]?re.resolve(this.Dn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Dn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Ps(e).Y({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(v(t.batchId>=n),i=ji(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Ps(e).Y({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ps(e).W("userMutationsIndex",t).next((e=>e.map((e=>ji(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Ie(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Ls(e).Y({range:r},((n,r,s)=>{const[o,a,c]=n,u=_e(a);if(o===this.userId&&t.path.isEqual(u))return Ps(e).get(c).next((e=>{if(!e)throw y();v(e.userId===this.userId),i.push(ji(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new et(N);const r=[];return t.forEach((t=>{const i=Ie(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Ls(e).Y({range:s},((e,r,i)=>{const[s,o,a]=e,c=_e(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),re.waitFor(r).next((()=>this.vn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Ie(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new et(N);return Ls(e).Y({range:s},((e,t,i)=>{const[s,a,c]=e,u=_e(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.vn(e,o)))}vn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Ps(e).get(t).next((e=>{if(null===e)throw y();v(e.userId===this.userId),n.push(ji(this.serializer,e))})))})),re.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return Ts(e.ae,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Fn(t.batchId)})),re.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Fn(e){delete this.Dn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return re.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Ls(e).Y({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=_e(e[1]);r.push(t)}else n.done()})).next((()=>{v(0===r.length)}))}))}containsKey(e,t){return ks(e,this.userId,t)}Mn(e){return Ns(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function ks(e,t,n){const r=Ie(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ls(e).Y({range:s,J:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function Ps(e){return He(e,"mutations")}function Ls(e){return He(e,"documentMutations")}function Ns(e){return He(e,"mutationQueues")}class Os{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Os(0)}static Nn(){return new Os(-1)}}class Ms{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next((t=>{const n=new Os(t.highestTargetId);return t.highestTargetId=n.next(),this.Ln(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Bn(e).next((e=>F.fromTimestamp(new R(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Bn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Bn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Ln(e,r))))}addTargetData(e,t){return this.kn(e,t).next((()=>this.Bn(e).next((n=>(n.targetCount+=1,this.qn(t,n),this.Ln(e,n))))))}updateTargetData(e,t){return this.kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Rs(e).delete(t.targetId))).next((()=>this.Bn(e))).next((t=>(v(t.targetCount>0),t.targetCount-=1,this.Ln(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return Rs(e).Y(((s,o)=>{const a=Vi(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>re.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Rs(e).Y(((e,n)=>{const r=Vi(n);t(r)}))}Bn(e){return Fs(e).get("targetGlobalKey").next((e=>(v(null!==e),e)))}Ln(e,t){return Fs(e).put("targetGlobalKey",t)}kn(e,t){return Rs(e).put(Bi(this.serializer,t))}qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=pn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Rs(e).Y({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=Vi(n);fn(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=js(e);return t.forEach((t=>{const s=we(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),re.waitFor(r)}removeMatchingKeys(e,t,n){const r=js(e);return re.forEach(t,(t=>{const i=we(t.path);return re.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=js(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=js(e);let i=Hn();return r.Y({range:n,J:!0},((e,t,n)=>{const r=_e(e[1]),s=new q(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=we(t.path),r=IDBKeyRange.bound([n],[M(n)],!1,!0);let i=0;return js(e).Y({index:"documentTargetsIndex",J:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}_t(e,t){return Rs(e).get(t).next((e=>e?Vi(e):null))}}function Rs(e){return He(e,"targets")}function Fs(e){return He(e,"targetGlobal")}function js(e){return He(e,"targetDocuments")}function Vs([e,t],[n,r]){const i=N(e,n);return 0===i?N(t,r):i}class Bs{constructor(e){this.Qn=e,this.buffer=new et(Vs),this.Kn=0}$n(){return++this.Kn}Un(e){const t=[e,this.$n()];if(this.buffer.size<this.Qn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Vs(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Us{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Wn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Wn&&(this.Wn.cancel(),this.Wn=null)}get started(){return null!==this.Wn}Gn(e){p("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Wn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Wn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ce(e)?p("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await ne(e)}await this.Gn(3e5)}))}}class qs{constructor(e,t){this.zn=e,this.params=t}calculateTargetCount(e,t){return this.zn.jn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return re.resolve(me._e);const n=new Bs(t);return this.zn.forEachTarget(e,(e=>n.Un(e.sequenceNumber))).next((()=>this.zn.Hn(e,(e=>n.Un(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.zn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.zn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(Ss)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ss):this.Jn(e,t)))}getCacheSize(e){return this.zn.getCacheSize(e)}Jn(e,t){let n,r,i,o,a,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(p("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(u=Date.now(),d()<=s.LogLevel.DEBUG&&p("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-l}ms\n\tDetermined least recently used ${r} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function zs(e,t){return new qs(e,t)}class Gs{constructor(e,t){this.db=e,this.garbageCollector=zs(this,t)}jn(e){const t=this.Yn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Yn(e){let t=0;return this.Hn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Hn(e,t){return this.Zn(e,((e,n)=>t(n)))}addReference(e,t,n){return $s(e,n)}removeReference(e,t,n){return $s(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return $s(e,t)}Xn(e,t){return function(e,t){let n=!1;return Ns(e).Z((r=>ks(e,r,t).next((e=>(e&&(n=!0),re.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Zn(e,((s,o)=>{if(o<=t){const t=this.Xn(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,F.min()),js(e).delete(function(e){return[0,we(e.path)]}(s)))))}));r.push(t)}})).next((()=>re.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return $s(e,t)}Zn(e,t){const n=js(e);let r,i=me._e;return n.Y({index:"documentTargetsIndex"},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==me._e&&t(new q(_e(r)),i),i=o,r=s):i=me._e})).next((()=>{i!==me._e&&t(new q(_e(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $s(e,t){return js(e).put(function(e,t){return{targetId:0,path:we(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Ks{constructor(){this.changes=new Rn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?re.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Hs{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Xs(e).put(n)}removeEntry(e,t,n){return Xs(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Mi(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.er(e,n))))}getEntry(e,t){let n=Vt.newInvalidDocument(t);return Xs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Js(t))},((e,r)=>{n=this.tr(t,r)})).next((()=>n))}nr(e,t){let n={size:0,document:Vt.newInvalidDocument(t)};return Xs(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Js(t))},((e,r)=>{n={document:this.tr(t,r),size:As(r)}})).next((()=>n))}getEntries(e,t){let n=jn();return this.rr(e,t,((e,t)=>{const r=this.tr(e,t);n=n.insert(e,r)})).next((()=>n))}ir(e,t){let n=jn(),r=new Xe(q.comparator);return this.rr(e,t,((e,t)=>{const i=this.tr(e,t);n=n.insert(e,i),r=r.insert(e,As(t))})).next((()=>({documents:n,sr:r})))}rr(e,t,n){if(t.isEmpty())return re.resolve();let r=new et(eo);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(Js(r.first()),Js(r.last())),s=r.getIterator();let o=s.getNext();return Xs(e).Y({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=q.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&eo(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.U(Js(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),Mi(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xs(e).W(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=jn();for(const i of e){const e=this.tr(q.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Ln(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=jn();const s=Zs(t,n),o=Zs(t,J.max());return Xs(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.tr(q.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Ws(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Ys(e).get("remoteDocumentGlobalKey").next((e=>(v(!!e),e)))}er(e,t){return Ys(e).put("remoteDocumentGlobalKey",t)}tr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=yi(e.ut,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=q.fromSegments(t.noDocument.path),r=Fi(t.noDocument.readTime);n=Vt.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return y();{const e=q.fromSegments(t.unknownDocument.path),r=Fi(t.unknownDocument.version);n=Vt.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new R(e[0],e[1]);return F.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(F.min()))return e}return Vt.newInvalidDocument(e)}}function Qs(e){return new Hs(e)}class Ws extends Ks{constructor(e,t){super(),this._r=e,this.trackRemovals=t,this.ar=new Rn((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new et(((e,t)=>N(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.ar.get(i);if(t.push(this._r.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=Oi(this._r.serializer,s);r=r.add(i.path.popLast());const c=As(a);n+=c-o.size,t.push(this._r.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=Oi(this._r.serializer,s.convertToNoDocument(F.min()));t.push(this._r.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this._r.indexManager.addToCollectionParentIndex(e,n))})),t.push(this._r.updateMetadata(e,n)),re.waitFor(t)}getFromCache(e,t){return this._r.nr(e,t).next((e=>(this.ar.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this._r.ir(e,t).next((({documents:e,sr:t})=>(t.forEach(((t,n)=>{this.ar.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function Ys(e){return He(e,"remoteDocumentGlobal")}function Xs(e){return He(e,"remoteDocumentsV14")}function Js(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Zs(e,t){const n=t.documentKey.path.toArray();return[e,Mi(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function eo(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=N(n[e],r[e]),i)return i;return i=N(n.length,r.length),i||(i=N(n[n.length-2],r[r.length-2]),i||N(n[n.length-1],r[r.length-1]))}class to{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class no{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&vr(n.mutation,e,rt.empty(),R.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Hn()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Hn()){const r=qn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Bn();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=qn();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Hn())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=jn();const s=Gn(),o=Gn();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof _r)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),vr(o.mutation,t,o.mutation.getFieldMask(),R.now())):s.set(t.key,rt.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new to(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Gn();let r=new Xe(((e,t)=>e-t)),i=Hn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||rt.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Hn()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=zn();c.forEach((e=>{if(!i.has(e)){const r=gr(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return re.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return q.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Cn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):re.resolve(qn());let o=-1,a=i;return s.next((t=>re.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?re.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Hn()))).next((e=>({batchId:o,changes:Un(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new q(t)).next((e=>{let t=Bn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Bn();return this.indexManager.getCollectionParents(e,i).next((o=>re.forEach(o,(o=>{const a=function(e,t){return new wn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Vt.newInvalidDocument(r)))}));let n=Bn();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&vr(s.mutation,r,rt.empty(),R.now()),Ln(t,r)&&(n=n.insert(e,r))})),n}))}}class ro{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return re.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ai(e.createTime)}}(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(e){return{name:e.name,query:Ui(e.bundledQuery),readTime:ai(e.readTime)}}(t)),re.resolve()}}class io{constructor(){this.overlays=new Xe(q.comparator),this.lr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const n=qn();return re.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.lt(e,t,r)})),re.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.lr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.lr.delete(n)),re.resolve()}getOverlaysForCollection(e,t,n){const r=qn(),i=t.length+1,s=new q(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Xe(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=qn(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=qn(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return re.resolve(o)}lt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.lr.get(r.largestBatchId).delete(n.key);this.lr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new kr(t,n));let i=this.lr.get(t);void 0===i&&(i=Hn(),this.lr.set(t,i)),this.lr.set(t,i.add(n.key))}}class so{constructor(){this.hr=new et(oo.Pr),this.Ir=new et(oo.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const n=new oo(e,t);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.dr(new oo(e,t))}Ar(e,t){e.forEach((e=>this.removeReference(e,t)))}Rr(e){const t=new q(new V([])),n=new oo(t,e),r=new oo(t,e+1),i=[];return this.Ir.forEachInRange([n,r],(e=>{this.dr(e),i.push(e.key)})),i}Vr(){this.hr.forEach((e=>this.dr(e)))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new q(new V([])),n=new oo(t,e),r=new oo(t,e+1);let i=Hn();return this.Ir.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new oo(e,0),n=this.hr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class oo{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return q.comparator(e.key,t.key)||N(e.gr,t.gr)}static Tr(e,t){return N(e.gr,t.gr)||q.comparator(e.key,t.key)}}class ao{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new et(oo.Pr)}checkEmpty(e){return re.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Ar(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.yr=this.yr.add(new oo(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return re.resolve(s)}lookupMutationBatch(e,t){return re.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Sr(n),i=r<0?0:r;return re.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new oo(t,0),r=new oo(t,Number.POSITIVE_INFINITY),i=[];return this.yr.forEachInRange([n,r],(e=>{const t=this.wr(e.gr);i.push(t)})),re.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new et(N);return t.forEach((e=>{const t=new oo(e,0),r=new oo(e,Number.POSITIVE_INFINITY);this.yr.forEachInRange([t,r],(e=>{n=n.add(e.gr)}))})),re.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;q.isDocumentKey(i)||(i=i.child(""));const s=new oo(new q(i),0);let o=new et(N);return this.yr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.gr)),!0)}),s),re.resolve(this.br(o))}br(e){const t=[];return e.forEach((e=>{const n=this.wr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){v(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.yr;return re.forEach(t.mutations,(r=>{const i=new oo(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.yr=n}))}Fn(e){}containsKey(e,t){const n=new oo(t,0),r=this.yr.firstAfterOrEqual(n);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class co{constructor(e){this.Cr=e,this.docs=new Xe(q.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Cr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return re.resolve(n?n.document.mutableCopy():Vt.newInvalidDocument(t))}getEntries(e,t){let n=jn();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Vt.newInvalidDocument(e))})),re.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=jn();const s=t.path,o=new q(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Z(X(o),n)<=0||(r.has(o.key)||Ln(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return re.resolve(i)}getAllFromCollectionGroup(e,t,n,r){y()}vr(e,t){return re.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new uo(this)}getSize(e){return re.resolve(this.size)}}class uo extends Ks{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this._r.addEntry(e,r)):this._r.removeEntry(n)})),re.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class lo{constructor(e){this.persistence=e,this.Fr=new Rn((e=>pn(e)),fn),this.lastRemoteSnapshotVersion=F.min(),this.highestTargetId=0,this.Mr=0,this.Or=new so,this.targetCount=0,this.Nr=Os.On()}forEachTarget(e,t){return this.Fr.forEach(((e,n)=>t(n))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Mr&&(this.Mr=t),re.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Os(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.kn(t),re.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Fr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Fr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),re.waitFor(i).next((()=>r))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const n=this.Fr.get(t)||null;return re.resolve(n)}addMatchingKeys(e,t,n){return this.Or.Er(t,n),re.resolve()}removeMatchingKeys(e,t,n){this.Or.Ar(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),re.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Or.mr(t);return re.resolve(n)}containsKey(e,t){return re.resolve(this.Or.containsKey(t))}}class ho{constructor(e,t){this.Br={},this.overlays={},this.Lr=new me(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new lo(this),this.indexManager=new gs,this.remoteDocumentCache=function(e){return new co(e)}((e=>this.referenceDelegate.Qr(e))),this.serializer=new Ni(t),this.Kr=new ro(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new io,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new ao(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,n){p("MemoryPersistence","Starting transaction:",e);const r=new po(this.Lr.next());return this.referenceDelegate.$r(),n(r).next((e=>this.referenceDelegate.Ur(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Wr(e,t){return re.or(Object.values(this.Br).map((n=>()=>n.containsKey(e,t))))}}class po extends te{constructor(e){super(),this.currentSequenceNumber=e}}class fo{constructor(e){this.persistence=e,this.Gr=new so,this.zr=null}static jr(e){return new fo(e)}get Hr(){if(this.zr)return this.zr;throw y()}addReference(e,t,n){return this.Gr.addReference(n,t),this.Hr.delete(n.toString()),re.resolve()}removeReference(e,t,n){return this.Gr.removeReference(n,t),this.Hr.add(n.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),re.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach((e=>this.Hr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Hr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.Hr,(n=>{const r=q.fromPath(n);return this.Jr(e,r).next((e=>{e||t.removeEntry(r,F.min())}))})).next((()=>(this.zr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Jr(e,t).next((e=>{e?this.Hr.delete(t.toString()):this.Hr.add(t.toString())}))}Qr(e){return 0}Jr(e,t){return re.or([()=>re.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class mo{constructor(e,t){this.persistence=e,this.Yr=new Rn((e=>we(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=zs(this,t)}static jr(e,t){return new mo(e,t)}$r(){}Ur(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}jn(e){const t=this.Yn(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Yn(e){let t=0;return this.Hn(e,(e=>{t++})).next((()=>t))}Hn(e,t){return re.forEach(this.Yr,((n,r)=>this.Xn(e,n,r).next((e=>e?re.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.vr(e,(r=>this.Xn(e,r,t).next((e=>{e||(n++,i.removeEntry(r,F.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.Yr.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.Yr.set(n,e.currentSequenceNumber),re.resolve()}removeReference(e,t,n){return this.Yr.set(n,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.Yr.set(t,e.currentSequenceNumber),re.resolve()}Qr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=It(e.data.value)),t}Xn(e,t,n){return re.or([()=>this.persistence.Wr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.Yr.get(t);return re.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class go{constructor(e){this.serializer=e}N(e,t,n,r){const i=new ie("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ce,{unique:!0}),e.createObjectStore("documentMutations")}(e),yo(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=re.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),yo(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:F.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").W().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ce,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return re.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Zr(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.Xr(i))))),n<7&&r>=7&&(s=s.next((()=>this.ei(i)))),n<8&&r>=8&&(s=s.next((()=>this.ti(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.ni(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:je});t.createIndex("collectionPathOverlayIndex",Ve,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Be,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:Te});t.createIndex("documentKeyIndex",Ae),t.createIndex("collectionGroupIndex",xe)}(e))).next((()=>this.ri(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.ii(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Oe}).createIndex("sequenceNumberIndex",Me,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Re}).createIndex("documentKeyIndex",Fe,{unique:!1})}(e)))),s}Xr(e){let t=0;return e.store("remoteDocuments").Y(((e,n)=>{t+=As(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Zr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.W().next((t=>re.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.W("userMutationsIndex",r).next((n=>re.forEach(n,(n=>{v(n.userId===t.userId);const r=ji(this.serializer,n);return Ts(e,t.userId,r).next((()=>{}))}))))}))))}ei(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.Y(((n,i)=>{const s=new V(n),o=function(e){return[0,we(e)]}(s);r.push(t.get(o).next((n=>n?re.resolve():(n=>t.put({targetId:0,path:we(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>re.waitFor(r)))}))}ti(e,t){e.createObjectStore("collectionParents",{keyPath:Ne});const n=t.store("collectionParents"),r=new ys,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:we(r)})}};return t.store("remoteDocuments").Y({J:!0},((e,t)=>{const n=new V(e);return i(n.popLast())})).next((()=>t.store("documentMutations").Y({J:!0},(([e,t,n],r)=>{const s=_e(t);return i(s.popLast())}))))}ni(e){const t=e.store("targets");return t.Y(((e,n)=>{const r=Vi(n),i=Bi(this.serializer,r);return t.put(i)}))}ri(e,t){const n=t.store("remoteDocuments"),r=[];return n.Y(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new q(V.fromString(e.document.name).popFirst(5)):e.noDocument?q.fromSegments(e.noDocument.path):e.unknownDocument?q.fromSegments(e.unknownDocument.path):y()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>re.waitFor(r)))}ii(e,t){const n=t.store("mutations"),r=Qs(this.serializer),i=new ho(fo.jr,this.serializer.ut);return n.W().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Hn();ji(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),re.forEach(n,((e,n)=>{const s=new u(n),o=Qi.ct(this.serializer,s),a=i.getIndexManager(s),c=xs.ct(s,this.serializer,a,i.referenceDelegate);return new no(r,c,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Ke(t,me._e),e).next()}))}))}}function yo(e){e.createObjectStore("targetDocuments",{keyPath:Pe}).createIndex("documentTargetsIndex",Le,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ke,{unique:!0}),e.createObjectStore("targetGlobal")}const vo="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class wo{constructor(e,t,n,r,i,s,o,a,c,u,l=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.si=i,this.window=s,this.document=o,this.oi=c,this._i=u,this.ai=l,this.Lr=null,this.kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.li=null,this.hi=Number.NEGATIVE_INFINITY,this.Pi=e=>Promise.resolve(),!wo.D())throw new E(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Gs(this,r),this.Ii=t+"main",this.serializer=new Ni(a),this.Ti=new se(this.Ii,this.ai,new go(this.serializer)),this.qr=new Ms(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Qs(this.serializer),this.Kr=new $i,this.window&&this.window.localStorage?this.Ei=this.window.localStorage:(this.Ei=null,!1===u&&f("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.di().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new E(b.FAILED_PRECONDITION,vo);return this.Ai(),this.Ri(),this.Vi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.qr.getHighestSequenceNumber(e)))})).then((e=>{this.Lr=new me(e,this.oi)})).then((()=>{this.kr=!0})).catch((e=>(this.Ti&&this.Ti.close(),Promise.reject(e))))}mi(e){return this.Pi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ti.L((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget((async()=>{this.started&&await this.di()})))}di(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Eo(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.fi(e).next((e=>{e||(this.isPrimary=!1,this.si.enqueueRetryable((()=>this.Pi(!1))))}))})).next((()=>this.gi(e))).next((t=>this.isPrimary&&!t?this.pi(e).next((()=>!1)):!!t&&this.yi(e).next((()=>!0)))))).catch((e=>{if(ce(e))return p("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return p("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.si.enqueueRetryable((()=>this.Pi(e))),this.isPrimary=e}))}fi(e){return bo(e).get("owner").next((e=>re.resolve(this.wi(e))))}Si(e){return Eo(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Di(this.hi,18e5)){this.hi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=He(e,"clientMetadata");return t.W().next((e=>{const n=this.Ci(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return re.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Ei)for(const t of e)this.Ei.removeItem(this.vi(t.clientId))}}Vi(){this.li=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.di().then((()=>this.bi())).then((()=>this.Vi()))))}wi(e){return!!e&&e.ownerId===this.clientId}gi(e){return this._i?re.resolve(!0):bo(e).get("owner").next((t=>{if(null!==t&&this.Di(t.leaseTimestampMs,5e3)&&!this.Fi(t.ownerId)){if(this.wi(t)&&this.networkEnabled)return!0;if(!this.wi(t)){if(!t.allowTabSynchronization)throw new E(b.FAILED_PRECONDITION,vo);return!1}}return!(!this.networkEnabled||!this.inForeground)||Eo(e).W().next((e=>void 0===this.Ci(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&p("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.kr=!1,this.Mi(),this.li&&(this.li.cancel(),this.li=null),this.xi(),this.Oi(),await this.Ti.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Ke(e,me._e);return this.pi(t).next((()=>this.Si(t)))})),this.Ti.close(),this.Ni()}Ci(e,t){return e.filter((e=>this.Di(e.updateTimeMs,t)&&!this.Fi(e.clientId)))}Bi(){return this.runTransaction("getActiveClients","readonly",(e=>Eo(e).W().next((e=>this.Ci(e,18e5).map((e=>e.clientId))))))}get started(){return this.kr}getMutationQueue(e,t){return xs.ct(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new ws(e,this.serializer.ut.databaseId)}getDocumentOverlayCache(e){return Qi.ct(this.serializer,e)}getBundleCache(){return this.Kr}runTransaction(e,t,n){p("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 15===e?$e:14===e?Ge:13===e?ze:12===e?qe:11===e?Ue:void y()}(this.ai);let s;return this.Ti.runTransaction(e,r,i,(r=>(s=new Ke(r,this.Lr?this.Lr.next():me._e),"readwrite-primary"===t?this.fi(s).next((e=>!!e||this.gi(s))).next((t=>{if(!t)throw f(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable((()=>this.Pi(!1))),new E(b.FAILED_PRECONDITION,ee);return n(s)})).next((e=>this.yi(s).next((()=>e)))):this.Li(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}Li(e){return bo(e).get("owner").next((e=>{if(null!==e&&this.Di(e.leaseTimestampMs,5e3)&&!this.Fi(e.ownerId)&&!this.wi(e)&&!(this._i||this.allowTabSynchronization&&e.allowTabSynchronization))throw new E(b.FAILED_PRECONDITION,vo)}))}yi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bo(e).put("owner",t)}static D(){return se.D()}pi(e){const t=bo(e);return t.get("owner").next((e=>this.wi(e)?(p("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):re.resolve()))}Di(e,t){const n=Date.now();return!(e<n-t||e>n&&(f(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ai(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.di())))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}Ri(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Mi();const e=/(?:Version|Mobile)\/1[456]/;o.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ui))}Oi(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Fi(e){var t;try{const n=null!==(null===(t=this.Ei)||void 0===t?void 0:t.getItem(this.vi(e)));return p("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return f("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Mi(){if(this.Ei)try{this.Ei.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){f("Failed to set zombie client id.",e)}}Ni(){if(this.Ei)try{this.Ei.removeItem(this.vi(this.clientId))}catch(e){}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function bo(e){return He(e,"owner")}function Eo(e){return He(e,"clientMetadata")}function _o(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Co{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.ki=n,this.qi=r}static Qi(e,t){let n=Hn(),r=Hn();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new Co(e,t.fromCache,n,r)}}class Io{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class So{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=8}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.zi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ji(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Io;return this.Hi(e,t,n).next((r=>{if(i.result=r,this.$i)return this.Ji(e,t,n,r.size)}))})).next((()=>i.result))}Ji(e,t,n,r){return n.documentReadCount<this.Ui?(d()<=s.LogLevel.DEBUG&&p("QueryEngine","SDK will not create cache indexes for query:",Pn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),re.resolve()):(d()<=s.LogLevel.DEBUG&&p("QueryEngine","Query:",Pn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Wi*r?(d()<=s.LogLevel.DEBUG&&p("QueryEngine","The SDK decides to create cache indexes for query:",Pn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Sn(t))):re.resolve())}zi(e,t){if(_n(t))return re.resolve(null);let n=Sn(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=An(t,null,"F"),n=Sn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Hn(...r);return this.Gi.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Yi(t,r);return this.Zi(t,s,i,n.readTime)?this.zi(e,An(t,null,"F")):this.Xi(e,s,t,n)}))))})))))}ji(e,t,n,r){return _n(t)||r.isEqual(F.min())?re.resolve(null):this.Gi.getDocuments(e,n).next((i=>{const o=this.Yi(t,i);return this.Zi(t,o,n,r)?re.resolve(null):(d()<=s.LogLevel.DEBUG&&p("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Pn(t)),this.Xi(e,o,t,Y(r,-1)).next((e=>e)))}))}Yi(e,t){let n=new et(On(e));return t.forEach(((t,r)=>{Ln(e,r)&&(n=n.add(r))})),n}Zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Hi(e,t,n){return d()<=s.LogLevel.DEBUG&&p("QueryEngine","Using full collection scan to execute query:",Pn(t)),this.Gi.getDocumentsMatchingQuery(e,t,J.min(),n)}Xi(e,t,n,r){return this.Gi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Do{constructor(e,t,n,r){this.persistence=e,this.es=t,this.serializer=r,this.ts=new Xe(N),this.ns=new Rn((e=>pn(e)),fn),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(n)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new no(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ts)))}}function To(e,t,n,r){return new Do(e,t,n,r)}async function Ao(e,t){const n=w(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.os(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Hn();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({_s:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function xo(e){const t=w(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.qr.getLastRemoteSnapshotVersion(e)))}function ko(e,t,n){let r=Hn(),i=Hn();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=jn();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(F.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):p("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{us:r,cs:i}}))}function Po(e,t){const n=w(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Lo(e,t){const n=w(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.qr.getTargetData(e,t).next((i=>i?(r=i,re.resolve(r)):n.qr.allocateTargetId(e).next((i=>(r=new Li(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ts=n.ts.insert(e.targetId,e),n.ns.set(t,e.targetId)),e}))}async function No(e,t,n){const r=w(e),i=r.ts.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!ce(e))throw e;p("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.ts=r.ts.remove(t),r.ns.delete(i.target)}function Oo(e,t,n){const r=w(e);let i=F.min(),s=Hn();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=w(e),i=r.ns.get(n);return void 0!==i?re.resolve(r.ts.get(i)):r.qr.getTargetData(t,n)}(r,e,Sn(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.es.getDocumentsMatchingQuery(e,t,n?i:F.min(),n?s:Hn()))).next((e=>(Fo(r,Nn(t),e),{documents:e,ls:s})))))}function Mo(e,t){const n=w(e),r=w(n.qr),i=n.ts.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r._t(e,t).next((e=>e?e.target:null))))}function Ro(e,t){const n=w(e),r=n.rs.get(t)||F.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.ss.getAllFromCollectionGroup(e,t,Y(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(Fo(n,t,e),e)))}function Fo(e,t,n){let r=e.rs.get(t)||F.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.rs.set(t,r)}async function jo(e,t,n=Hn()){const r=await Lo(e,Sn(Ui(t.bundledQuery))),i=w(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=ai(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Kr.saveNamedQuery(e,t);const o=r.withResumeToken(st.EMPTY_BYTE_STRING,s);return i.ts=i.ts.insert(o.targetId,o),i.qr.updateTargetData(e,o).next((()=>i.qr.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.qr.addMatchingKeys(e,n,r.targetId))).next((()=>i.Kr.saveNamedQuery(e,t)))}))}function Vo(e,t){return`firestore_clients_${e}_${t}`}function Bo(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function Uo(e,t){return`firestore_targets_${e}_${t}`}class qo{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Ts(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new E(r.error.code,r.error.message))),s?new qo(e,t,r.state,i):(f("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zo{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ts(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new E(n.error.code,n.error.message))),i?new zo(e,n.state,r):(f("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Es(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Go{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ts(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Wn();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=ve(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new Go(e,i):(f("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class $o{constructor(e,t){this.clientId=e,this.onlineState=t}static Ts(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new $o(t.clientId,t.onlineState):(f("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Ko{constructor(){this.activeTargetIds=Wn()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ho{constructor(e,t,n,r,i){this.window=e,this.si=t,this.persistenceKey=n,this.Rs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Vs=this.fs.bind(this),this.gs=new Xe(N),this.started=!1,this.ps=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ys=Vo(this.persistenceKey,this.Rs),this.ws=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.gs=this.gs.insert(this.Rs,new Ko),this.Ss=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.bs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ds=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Cs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.vs=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Vs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const t of e){if(t===this.Rs)continue;const e=this.getItem(Vo(this.persistenceKey,t));if(e){const n=Go.Ts(t,e);n&&(this.gs=this.gs.insert(n.clientId,n))}}this.Fs();const t=this.storage.getItem(this.Cs);if(t){const e=this.Ms(t);e&&this.xs(e)}for(const e of this.ps)this.fs(e);this.ps=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.ws,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Os(this.gs)}isActiveQueryTarget(e){let t=!1;return this.gs.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Ns(e,"pending")}updateMutationState(e,t,n){this.Ns(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(Uo(this.persistenceKey,e));if(n){const r=zo.Ts(e,n);r&&(t=r.state)}}return this.Ls.ds(e),this.Fs(),t}removeLocalQueryTarget(e){this.Ls.As(e),this.Fs()}isLocalQueryTarget(e){return this.Ls.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Uo(this.persistenceKey,e))}updateQueryState(e,t,n){this.ks(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Bs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.qs(e)}notifyBundleLoaded(e){this.Qs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Vs),this.removeItem(this.ys),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return p("SharedClientState","READ",e,t),t}setItem(e,t){p("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){p("SharedClientState","REMOVE",e),this.storage.removeItem(e)}fs(e){const t=e;if(t.storageArea===this.storage){if(p("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ys)return void f("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Ss.test(t.key)){if(null==t.newValue){const e=this.Ks(t.key);return this.$s(e,null)}{const e=this.Us(t.key,t.newValue);if(e)return this.$s(e.clientId,e)}}else if(this.bs.test(t.key)){if(null!==t.newValue){const e=this.Ws(t.key,t.newValue);if(e)return this.Gs(e)}}else if(this.Ds.test(t.key)){if(null!==t.newValue){const e=this.zs(t.key,t.newValue);if(e)return this.js(e)}}else if(t.key===this.Cs){if(null!==t.newValue){const e=this.Ms(t.newValue);if(e)return this.xs(e)}}else if(t.key===this.ws){const e=function(e){let t=me._e;if(null!=e)try{const n=JSON.parse(e);v("number"==typeof n),t=n}catch(e){f("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==me._e&&this.sequenceNumberHandler(e)}else if(t.key===this.vs){const e=this.Hs(t.newValue);await Promise.all(e.map((e=>this.syncEngine.Js(e))))}}else this.ps.push(t)}))}}get Ls(){return this.gs.get(this.Rs)}Fs(){this.setItem(this.ys,this.Ls.Es())}Ns(e,t,n){const r=new qo(this.currentUser,e,t,n),i=Bo(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Es())}Bs(e){const t=Bo(this.persistenceKey,this.currentUser,e);this.removeItem(t)}qs(e){const t={clientId:this.Rs,onlineState:e};this.storage.setItem(this.Cs,JSON.stringify(t))}ks(e,t,n){const r=Uo(this.persistenceKey,e),i=new zo(e,t,n);this.setItem(r,i.Es())}Qs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.vs,t)}Ks(e){const t=this.Ss.exec(e);return t?t[1]:null}Us(e,t){const n=this.Ks(e);return Go.Ts(n,t)}Ws(e,t){const n=this.bs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return qo.Ts(new u(i),r,t)}zs(e,t){const n=this.Ds.exec(e),r=Number(n[1]);return zo.Ts(r,t)}Ms(e){return $o.Ts(e)}Hs(e){return JSON.parse(e)}async Gs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Ys(e.batchId,e.state,e.error);p("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}js(e){return this.syncEngine.Zs(e.targetId,e.state,e.error)}$s(e,t){const n=t?this.gs.insert(e,t):this.gs.remove(e),r=this.Os(this.gs),i=this.Os(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.Xs(s,o).then((()=>{this.gs=n}))}xs(e){this.gs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Os(e){let t=Wn();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Qo{constructor(){this.eo=new Ko,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,n){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new Ko,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Wo{ro(e){}shutdown(){}}class Yo{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){p("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){p("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Xo=null;function Jo(){return null===Xo?Xo=268435456+Math.round(2147483648*Math.random()):Xo++,"0x"+Xo.toString(16)}const Zo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ea{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}onMessage(e){this.Eo=e}close(){this.lo()}send(e){this.co(e)}Ao(){this.Po()}Ro(e){this.To(e)}Vo(e){this.Eo(e)}}const ta="WebChannelConnection";class na extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.mo=t+"://"+e.host,this.fo=`projects/${n}/databases/${r}`,this.po="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get yo(){return!1}wo(e,t,n,r,i){const s=Jo(),o=this.So(e,t);p("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.fo,"x-goog-request-params":this.po};return this.bo(a,r,i),this.Do(e,o,a,n).then((t=>(p("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw m("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Co(e,t,n,r,i,s){return this.wo(e,t,n,r,i)}bo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+l,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}So(e,t){const n=Zo[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Do(e,t,n,r){const i=Jo();return new Promise(((s,o)=>{const c=new a.XhrIo;c.setWithCredentials(!0),c.listenOnce(a.EventType.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case a.ErrorCode.NO_ERROR:const t=c.getResponseJson();p(ta,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case a.ErrorCode.TIMEOUT:p(ta,`RPC '${e}' ${i} timed out`),o(new E(b.DEADLINE_EXCEEDED,"Request time out"));break;case a.ErrorCode.HTTP_ERROR:const n=c.getStatus();if(p(ta,`RPC '${e}' ${i} failed with status:`,n,"response text:",c.getResponseText()),n>0){let e=c.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(t)>=0?t:b.UNKNOWN}(t.status);o(new E(e,t.message))}else o(new E(b.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new E(b.UNAVAILABLE,"Connection failed."));break;default:y()}}finally{p(ta,`RPC '${e}' ${i} completed.`)}}));const u=JSON.stringify(r);p(ta,`RPC '${e}' ${i} sending request:`,r),c.send(t,"POST",u,n,15)}))}vo(e,t,n){const r=Jo(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=a.createWebChannelTransport(),o=a.getStatEventTarget(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.bo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const l=i.join("");p(ta,`Creating RPC '${e}' stream ${r}: ${l}`,c);const h=s.createWebChannel(l,c);let d=!1,f=!1;const g=new ea({co:t=>{f?p(ta,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(p(ta,`Opening RPC '${e}' stream ${r} transport.`),h.open(),d=!0),p(ta,`RPC '${e}' stream ${r} sending:`,t),h.send(t))},lo:()=>h.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(h,a.WebChannel.EventType.OPEN,(()=>{f||p(ta,`RPC '${e}' stream ${r} transport opened.`)})),y(h,a.WebChannel.EventType.CLOSE,(()=>{f||(f=!0,p(ta,`RPC '${e}' stream ${r} transport closed`),g.Ro())})),y(h,a.WebChannel.EventType.ERROR,(t=>{f||(f=!0,m(ta,`RPC '${e}' stream ${r} transport errored:`,t),g.Ro(new E(b.UNAVAILABLE,"The operation could not be completed")))})),y(h,a.WebChannel.EventType.MESSAGE,(t=>{var n;if(!f){const i=t.data[0];v(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){p(ta,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=Nr[e];if(void 0!==t)return Rr(t)}(t),i=o.message;void 0===n&&(n=b.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),f=!0,g.Ro(new E(n,i)),h.close()}else p(ta,`RPC '${e}' stream ${r} received:`,i),g.Vo(i)}})),y(o,a.Event.STAT_EVENT,(t=>{t.stat===a.Stat.PROXY?p(ta,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===a.Stat.NOPROXY&&p(ta,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{g.Ao()}),0),g}}function ra(){return"undefined"!=typeof window?window:null}function ia(){return"undefined"!=typeof document?document:null}function sa(e){return new ni(e,!0)}class oa{constructor(e,t,n=1e3,r=1.5,i=6e4){this.si=e,this.timerId=t,this.Fo=n,this.Mo=r,this.xo=i,this.Oo=0,this.No=null,this.Bo=Date.now(),this.reset()}reset(){this.Oo=0}Lo(){this.Oo=this.xo}ko(e){this.cancel();const t=Math.floor(this.Oo+this.qo()),n=Math.max(0,Date.now()-this.Bo),r=Math.max(0,t-n);r>0&&p("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Oo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.No=this.si.enqueueAfterDelay(this.timerId,r,(()=>(this.Bo=Date.now(),e()))),this.Oo*=this.Mo,this.Oo<this.Fo&&(this.Oo=this.Fo),this.Oo>this.xo&&(this.Oo=this.xo)}Qo(){null!==this.No&&(this.No.skipDelay(),this.No=null)}cancel(){null!==this.No&&(this.No.cancel(),this.No=null)}qo(){return(Math.random()-.5)*this.Oo}}class aa{constructor(e,t,n,r,i,s,o,a){this.si=e,this.Ko=n,this.$o=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Uo=0,this.Wo=null,this.Go=null,this.stream=null,this.zo=new oa(e,t)}jo(){return 1===this.state||5===this.state||this.Ho()}Ho(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Jo()}async stop(){this.jo()&&await this.close(0)}Yo(){this.state=0,this.zo.reset()}Zo(){this.Ho()&&null===this.Wo&&(this.Wo=this.si.enqueueAfterDelay(this.Ko,6e4,(()=>this.Xo())))}e_(e){this.t_(),this.stream.send(e)}async Xo(){if(this.Ho())return this.close(0)}t_(){this.Wo&&(this.Wo.cancel(),this.Wo=null)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}async close(e,t){this.t_(),this.n_(),this.zo.cancel(),this.Uo++,4!==e?this.zo.reset():t&&t.code===b.RESOURCE_EXHAUSTED?(f(t.toString()),f("Using maximum backoff delay to prevent overloading the backend."),this.zo.Lo()):t&&t.code===b.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.r_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Io(t)}r_(){}auth(){this.state=1;const e=this.i_(this.Uo),t=this.Uo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Uo===t&&this.s_(e,n)}),(t=>{e((()=>{const e=new E(b.UNKNOWN,"Fetching auth token failed: "+t.message);return this.o_(e)}))}))}s_(e,t){const n=this.i_(this.Uo);this.stream=this.__(e,t),this.stream.ho((()=>{n((()=>(this.state=2,this.Go=this.si.enqueueAfterDelay(this.$o,1e4,(()=>(this.Ho()&&(this.state=3),Promise.resolve()))),this.listener.ho())))})),this.stream.Io((e=>{n((()=>this.o_(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Jo(){this.state=5,this.zo.ko((async()=>{this.state=0,this.start()}))}o_(e){return p("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}i_(e){return t=>{this.si.enqueueAndForget((()=>this.Uo===e?t():(p("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ca extends aa{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}__(e,t){return this.connection.vo("Listen",e,t)}onMessage(e){this.zo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:y()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(v(void 0===t||"string"==typeof t),st.fromBase64String(t||"")):(v(void 0===t||t instanceof Uint8Array),st.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?b.UNKNOWN:Rr(e.code);return new E(t,e.message||"")}(o);n=new Qr(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=hi(e,r.document.name),s=ai(r.document.updateTime),o=r.document.createTime?ai(r.document.createTime):F.min(),a=new Ft({mapValue:{fields:r.document.fields}}),c=Vt.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Kr(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=hi(e,r.document),s=r.readTime?ai(r.readTime):F.min(),o=Vt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Kr([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=hi(e,r.document),s=r.removedTargetIds||[];n=new Kr([],s,i,null)}else{if(!("filter"in t))return y();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Lr(r,i),o=e.targetId;n=new Hr(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return F.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?F.min():t.readTime?ai(t.readTime):F.min()}(e);return this.listener.a_(t,n)}u_(e){const t={};t.database=fi(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=mn(r)?{documents:bi(e,r)}:{query:Ei(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=si(e,t.resumeToken);const r=ri(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(F.min())>0){n.readTime=ii(e,t.snapshotVersion.toTimestamp());const r=ri(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return y()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.e_(t)}c_(e){const t={};t.database=fi(this.serializer),t.removeTarget=e,this.e_(t)}}class ua extends aa{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.l_=!1}get h_(){return this.l_}start(){this.l_=!1,this.lastStreamToken=void 0,super.start()}r_(){this.l_&&this.P_([])}__(e,t){return this.connection.vo("Write",e,t)}onMessage(e){if(v(!!e.streamToken),this.lastStreamToken=e.streamToken,this.l_){this.zo.reset();const t=function(e,t){return e&&e.length>0?(v(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?ai(e.updateTime):ai(t);return n.isEqual(F.min())&&(n=ai(t)),new dr(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=ai(e.commitTime);return this.listener.I_(n,t)}return v(!e.writeResults||0===e.writeResults.length),this.l_=!0,this.listener.T_()}E_(){const e={};e.database=fi(this.serializer),this.e_(e)}P_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>vi(this.serializer,e)))};this.e_(t)}}class la extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.d_=!1}A_(){if(this.d_)throw new E(b.FAILED_PRECONDITION,"The client has already been terminated.")}wo(e,t,n){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.connection.wo(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new E(b.UNKNOWN,e.toString())}))}Co(e,t,n,r){return this.A_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Co(e,t,n,i,s,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new E(b.UNKNOWN,e.toString())}))}terminate(){this.d_=!0}}class ha{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.V_=0,this.m_=null,this.f_=!0}g_(){0===this.V_&&(this.p_("Unknown"),this.m_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.m_=null,this.y_("Backend didn't respond within 10 seconds."),this.p_("Offline"),Promise.resolve()))))}w_(e){"Online"===this.state?this.p_("Unknown"):(this.V_++,this.V_>=1&&(this.S_(),this.y_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.p_("Offline")))}set(e){this.S_(),this.V_=0,"Online"===e&&(this.f_=!1),this.p_(e)}p_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}y_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.f_?(f(t),this.f_=!1):p("OnlineStateTracker",t)}S_(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}}class da{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.b_=[],this.D_=new Map,this.C_=new Set,this.v_=[],this.F_=i,this.F_.ro((e=>{n.enqueueAndForget((async()=>{Ea(this)&&(p("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=w(e);t.C_.add(4),await fa(t),t.M_.set("Unknown"),t.C_.delete(4),await pa(t)}(this))}))})),this.M_=new ha(n,r)}}async function pa(e){if(Ea(e))for(const t of e.v_)await t(!0)}async function fa(e){for(const t of e.v_)await t(!1)}function ma(e,t){const n=w(e);n.D_.has(t.targetId)||(n.D_.set(t.targetId,t),ba(n)?wa(n):Va(n).Ho()&&ya(n,t))}function ga(e,t){const n=w(e),r=Va(n);n.D_.delete(t),r.Ho()&&va(n,t),0===n.D_.size&&(r.Ho()?r.Zo():Ea(n)&&n.M_.set("Unknown"))}function ya(e,t){if(e.x_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(F.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Va(e).u_(t)}function va(e,t){e.x_.Oe(t),Va(e).c_(t)}function wa(e){e.x_=new Yr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.D_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Va(e).start(),e.M_.g_()}function ba(e){return Ea(e)&&!Va(e).jo()&&e.D_.size>0}function Ea(e){return 0===w(e).C_.size}function _a(e){e.x_=void 0}async function Ca(e){e.D_.forEach(((t,n)=>{ya(e,t)}))}async function Ia(e,t){_a(e),ba(e)?(e.M_.w_(t),wa(e)):e.M_.set("Unknown")}async function Sa(e,t,n){if(e.M_.set("Online"),t instanceof Qr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.D_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.D_.delete(r),e.x_.removeTarget(r))}(e,t)}catch(n){p("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Da(e,n)}else if(t instanceof Kr?e.x_.$e(t):t instanceof Hr?e.x_.Je(t):e.x_.Ge(t),!n.isEqual(F.min()))try{const t=await xo(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.x_.it(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.D_.get(r);i&&e.D_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.D_.get(t);if(!r)return;e.D_.set(t,r.withResumeToken(st.EMPTY_BYTE_STRING,r.snapshotVersion)),va(e,t);const i=new Li(r.target,t,n,r.sequenceNumber);ya(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){p("RemoteStore","Failed to raise snapshot:",t),await Da(e,t)}}async function Da(e,t,n){if(!ce(t))throw t;e.C_.add(1),await fa(e),e.M_.set("Offline"),n||(n=()=>xo(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{p("RemoteStore","Retrying IndexedDB access"),await n(),e.C_.delete(1),await pa(e)}))}function Ta(e,t){return t().catch((n=>Da(e,n,t)))}async function Aa(e){const t=w(e),n=Ba(t);let r=t.b_.length>0?t.b_[t.b_.length-1].batchId:-1;for(;xa(t);)try{const e=await Po(t.localStore,r);if(null===e){0===t.b_.length&&n.Zo();break}r=e.batchId,ka(t,e)}catch(e){await Da(t,e)}Pa(t)&&La(t)}function xa(e){return Ea(e)&&e.b_.length<10}function ka(e,t){e.b_.push(t);const n=Ba(e);n.Ho()&&n.h_&&n.P_(t.mutations)}function Pa(e){return Ea(e)&&!Ba(e).jo()&&e.b_.length>0}function La(e){Ba(e).start()}async function Na(e){Ba(e).E_()}async function Oa(e){const t=Ba(e);for(const n of e.b_)t.P_(n.mutations)}async function Ma(e,t,n){const r=e.b_.shift(),i=xr.from(r,t,n);await Ta(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Aa(e)}async function Ra(e,t){t&&Ba(e).h_&&await async function(e,t){if(function(e){return Mr(e)&&e!==b.ABORTED}(t.code)){const n=e.b_.shift();Ba(e).Yo(),await Ta(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Aa(e)}}(e,t),Pa(e)&&La(e)}async function Fa(e,t){const n=w(e);n.asyncQueue.verifyOperationInProgress(),p("RemoteStore","RemoteStore received new credentials");const r=Ea(n);n.C_.add(3),await fa(n),r&&n.M_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.C_.delete(3),await pa(n)}async function ja(e,t){const n=w(e);t?(n.C_.delete(2),await pa(n)):t||(n.C_.add(2),await fa(n),n.M_.set("Unknown"))}function Va(e){return e.O_||(e.O_=function(e,t,n){const r=w(e);return r.A_(),new ca(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{ho:Ca.bind(null,e),Io:Ia.bind(null,e),a_:Sa.bind(null,e)}),e.v_.push((async t=>{t?(e.O_.Yo(),ba(e)?wa(e):e.M_.set("Unknown")):(await e.O_.stop(),_a(e))}))),e.O_}function Ba(e){return e.N_||(e.N_=function(e,t,n){const r=w(e);return r.A_(),new ua(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{ho:Na.bind(null,e),Io:Ra.bind(null,e),T_:Oa.bind(null,e),I_:Ma.bind(null,e)}),e.v_.push((async t=>{t?(e.N_.Yo(),await Aa(e)):(await e.N_.stop(),e.b_.length>0&&(p("RemoteStore",`Stopping write stream with ${e.b_.length} pending writes`),e.b_=[]))}))),e.N_}class Ua{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new _,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Ua(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new E(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qa(e,t){if(f("AsyncQueue",`${t}: ${e}`),ce(e))return new E(b.UNAVAILABLE,`${t}: ${e}`);throw e}class za{constructor(e){this.comparator=e?(t,n)=>e(t,n)||q.comparator(t.key,n.key):(e,t)=>q.comparator(e.key,t.key),this.keyedMap=Bn(),this.sortedSet=new Xe(this.comparator)}static emptySet(e){return new za(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof za))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new za;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ga{constructor(){this.B_=new Xe(q.comparator)}track(e){const t=e.doc.key,n=this.B_.get(t);n?0!==e.type&&3===n.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==n.type?this.B_=this.B_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.B_=this.B_.remove(t):1===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):y():this.B_=this.B_.insert(t,e)}L_(){const e=[];return this.B_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class $a{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new $a(e,t,za.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Ka{constructor(){this.k_=void 0,this.listeners=[]}}class Ha{constructor(){this.queries=new Rn((e=>kn(e)),xn),this.onlineState="Unknown",this.q_=new Set}}async function Qa(e,t){const n=w(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Ka),i)try{s.k_=await n.onListen(r)}catch(e){const n=qa(e,`Initialization of query '${Pn(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.Q_(n.onlineState),s.k_&&t.K_(s.k_)&&Ja(n)}async function Wa(e,t){const n=w(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function Ya(e,t){const n=w(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.K_(e)&&(r=!0);i.k_=e}}r&&Ja(n)}function Xa(e,t,n){const r=w(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function Ja(e){e.q_.forEach((e=>{e.next()}))}class Za{constructor(e,t,n){this.query=e,this.U_=t,this.W_=!1,this.G_=null,this.onlineState="Unknown",this.options=n||{}}K_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new $a(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.W_?this.z_(e)&&(this.U_.next(e),t=!0):this.j_(e,this.onlineState)&&(this.H_(e),t=!0),this.G_=e,t}onError(e){this.U_.error(e)}Q_(e){this.onlineState=e;let t=!1;return this.G_&&!this.W_&&this.j_(this.G_,e)&&(this.H_(this.G_),t=!0),t}j_(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.J_||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}z_(e){if(e.docChanges.length>0)return!0;const t=this.G_&&this.G_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}H_(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.W_=!0,this.U_.next(e)}}class ec{constructor(e,t){this.Y_=e,this.byteLength=t}Z_(){return"metadata"in this.Y_}}class tc{constructor(e){this.serializer=e}hs(e){return hi(this.serializer,e)}Ps(e){return e.metadata.exists?yi(this.serializer,e.document,!1):Vt.newNoDocument(this.hs(e.metadata.name),this.Is(e.metadata.readTime))}Is(e){return ai(e)}}class nc{constructor(e,t,n){this.X_=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=rc(e)}ea(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Y_.namedQuery)this.queries.push(e.Y_.namedQuery);else if(e.Y_.documentMetadata){this.documents.push({metadata:e.Y_.documentMetadata}),e.Y_.documentMetadata.exists||++t;const n=V.fromString(e.Y_.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Y_.document&&(this.documents[this.documents.length-1].document=e.Y_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ta(e){const t=new Map,n=new tc(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.hs(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Hn()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=w(e);let s=Hn(),o=jn();for(const e of n){const n=t.hs(e.metadata.name);e.document&&(s=s.add(n));const r=t.Ps(e);r.setReadTime(t.Is(e.metadata.readTime)),o=o.insert(n,r)}const a=i.ss.newChangeBuffer({trackRemovals:!0}),c=await Lo(i,function(e){return Sn(En(V.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>ko(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.qr.removeMatchingKeysForTargetId(e,c.targetId).next((()=>i.qr.addMatchingKeys(e,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.us,t.cs))).next((()=>t.us))))))}(this.localStore,new tc(this.serializer),this.documents,this.X_.id),t=this.ta(this.documents);for(const e of this.queries)await jo(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,na:this.collectionGroups,ra:e}}}function rc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class ic{constructor(e){this.key=e}}class sc{constructor(e){this.key=e}}class oc{constructor(e,t){this.query=e,this.ia=t,this.sa=null,this.hasCachedResults=!1,this.current=!1,this.oa=Hn(),this.mutatedKeys=Hn(),this._a=On(e),this.aa=new za(this._a)}get ua(){return this.ia}ca(e,t){const n=t?t.la:new Ga,r=t?t.aa:this.aa;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=Ln(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let p=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),p=!0):this.ha(u,l)||(n.track({type:2,doc:l}),p=!0,(a&&this._a(l,a)>0||c&&this._a(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),p=!0):u&&!l&&(n.track({type:1,doc:u}),p=!0,(a||c)&&(o=!0)),p&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{aa:s,la:n,Zi:o,mutatedKeys:i}}ha(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.aa;this.aa=e.aa,this.mutatedKeys=e.mutatedKeys;const s=e.la.L_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(e)-n(t)}(e.type,t.type)||this._a(e.doc,t.doc))),this.Pa(n),r=null!=r&&r;const o=t&&!r?this.Ia():[],a=0===this.oa.size&&this.current&&!r?1:0,c=a!==this.sa;return this.sa=a,0!==s.length||c?{snapshot:new $a(this.query,e.aa,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ta:o}:{Ta:o}}Q_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({aa:this.aa,la:new Ga,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{Ta:[]}}Ea(e){return!this.ia.has(e)&&!!this.aa.has(e)&&!this.aa.get(e).hasLocalMutations}Pa(e){e&&(e.addedDocuments.forEach((e=>this.ia=this.ia.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ia=this.ia.delete(e))),this.current=e.current)}Ia(){if(!this.current)return[];const e=this.oa;this.oa=Hn(),this.aa.forEach((e=>{this.Ea(e.key)&&(this.oa=this.oa.add(e.key))}));const t=[];return e.forEach((e=>{this.oa.has(e)||t.push(new sc(e))})),this.oa.forEach((n=>{e.has(n)||t.push(new ic(n))})),t}da(e){this.ia=e.ls,this.oa=Hn();const t=this.ca(e.documents);return this.applyChanges(t,!0)}Aa(){return $a.fromInitialDocuments(this.query,this.aa,this.mutatedKeys,0===this.sa,this.hasCachedResults)}}class ac{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class cc{constructor(e){this.key=e,this.Ra=!1}}class uc{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Va={},this.ma=new Rn((e=>kn(e)),xn),this.fa=new Map,this.ga=new Set,this.pa=new Xe(q.comparator),this.ya=new Map,this.wa=new so,this.Sa={},this.ba=new Map,this.Da=Os.Nn(),this.onlineState="Unknown",this.Ca=void 0}get isPrimaryClient(){return!0===this.Ca}}async function lc(e,t){const n=Rc(e);let r,i;const s=n.ma.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Aa();else{const e=await Lo(n.localStore,Sn(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await hc(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&ma(n.remoteStore,e)}return i}async function hc(e,t,n,r,i){e.va=(t,n,r)=>async function(e,t,n,r){let i=t.view.ca(n);i.Zi&&(i=await Oo(e.localStore,t.query,!1).then((({documents:e})=>t.view.ca(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return _c(e,t.targetId,a.Ta),a.snapshot}(e,t,n,r);const s=await Oo(e.localStore,t,!0),o=new oc(t,s.ls),a=o.ca(s.documents),c=$r.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);_c(e,n,u.Ta);const l=new ac(t,n,o);return e.ma.set(t,l),e.fa.has(n)?e.fa.get(n).push(t):e.fa.set(n,[t]),u.snapshot}async function dc(e,t){const n=w(e),r=n.ma.get(t),i=n.fa.get(r.targetId);if(i.length>1)return n.fa.set(r.targetId,i.filter((e=>!xn(e,t)))),void n.ma.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await No(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),ga(n.remoteStore,r.targetId),bc(n,r.targetId)})).catch(ne)):(bc(n,r.targetId),await No(n.localStore,r.targetId,!0))}async function pc(e,t){const n=w(e);try{const e=await function(e,t){const n=w(e),r=t.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.qr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.qr.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(st.EMPTY_BYTE_STRING,F.min()).withLastLimboFreeSnapshotVersion(F.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.qr.updateTargetData(e,u))}));let a=jn(),c=Hn();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(ko(e,s,t.documentUpdates).next((e=>{a=e.us,c=e.cs}))),!r.isEqual(F.min())){const t=n.qr.getLastRemoteSnapshotVersion(e).next((t=>n.qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return re.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.ts=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.ya.get(t);r&&(v(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Ra=!0:e.modifiedDocuments.size>0?v(r.Ra):e.removedDocuments.size>0&&(v(r.Ra),r.Ra=!1))})),await Sc(n,e,t)}catch(e){await ne(e)}}function fc(e,t,n){const r=w(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ma.forEach(((n,r)=>{const i=r.view.Q_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=w(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.Q_(t)&&(r=!0)})),r&&Ja(n)}(r.eventManager,t),e.length&&r.Va.a_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function mc(e,t,n){const r=w(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.ya.get(t),s=i&&i.key;if(s){let e=new Xe(q.comparator);e=e.insert(s,Vt.newNoDocument(s,F.min()));const n=Hn().add(s),i=new Gr(F.min(),new Map,new Xe(N),e,n);await pc(r,i),r.pa=r.pa.remove(s),r.ya.delete(t),Ic(r)}else await No(r.localStore,t,!1).then((()=>bc(r,t,n))).catch(ne)}async function gc(e,t){const n=w(e),r=t.batch.batchId;try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.ss.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=re.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);v(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Hn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);wc(n,r,null),vc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Sc(n,e)}catch(e){await ne(e)}}async function yc(e,t,n){const r=w(e);try{const e=await function(e,t){const n=w(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(v(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);wc(r,t,n),vc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Sc(r,e)}catch(n){await ne(n)}}function vc(e,t){(e.ba.get(t)||[]).forEach((e=>{e.resolve()})),e.ba.delete(t)}function wc(e,t,n){const r=w(e);let i=r.Sa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Sa[r.currentUser.toKey()]=i}}function bc(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.fa.get(t))e.ma.delete(r),n&&e.Va.Fa(r,n);e.fa.delete(t),e.isPrimaryClient&&e.wa.Rr(t).forEach((t=>{e.wa.containsKey(t)||Ec(e,t)}))}function Ec(e,t){e.ga.delete(t.path.canonicalString());const n=e.pa.get(t);null!==n&&(ga(e.remoteStore,n),e.pa=e.pa.remove(t),e.ya.delete(n),Ic(e))}function _c(e,t,n){for(const r of n)r instanceof ic?(e.wa.addReference(r.key,t),Cc(e,r)):r instanceof sc?(p("SyncEngine","Document no longer in limbo: "+r.key),e.wa.removeReference(r.key,t),e.wa.containsKey(r.key)||Ec(e,r.key)):y()}function Cc(e,t){const n=t.key,r=n.path.canonicalString();e.pa.get(n)||e.ga.has(r)||(p("SyncEngine","New document in limbo: "+n),e.ga.add(r),Ic(e))}function Ic(e){for(;e.ga.size>0&&e.pa.size<e.maxConcurrentLimboResolutions;){const t=e.ga.values().next().value;e.ga.delete(t);const n=new q(V.fromString(t)),r=e.Da.next();e.ya.set(r,new cc(n)),e.pa=e.pa.insert(n,r),ma(e.remoteStore,new Li(Sn(En(n.path)),r,"TargetPurposeLimboResolution",me._e))}}async function Sc(e,t,n){const r=w(e),i=[],s=[],o=[];r.ma.isEmpty()||(r.ma.forEach(((e,a)=>{o.push(r.va(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=Co.Qi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Va.a_(i),await async function(e,t){const n=w(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>re.forEach(t,(t=>re.forEach(t.ki,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>re.forEach(t.qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!ce(e))throw e;p("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.ts.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.ts=n.ts.insert(t,i)}}}(r.localStore,s))}async function Dc(e,t){const n=w(e);if(!n.currentUser.isEqual(t)){p("SyncEngine","User change. New user:",t.toKey());const e=await Ao(n.localStore,t);n.currentUser=t,function(e,t){e.ba.forEach((e=>{e.forEach((e=>{e.reject(new E(b.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.ba.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Sc(n,e._s)}}function Tc(e,t){const n=w(e),r=n.ya.get(t);if(r&&r.Ra)return Hn().add(r.key);{let e=Hn();const r=n.fa.get(t);if(!r)return e;for(const t of r){const r=n.ma.get(t);e=e.unionWith(r.view.ua)}return e}}async function Ac(e,t){const n=w(e),r=await Oo(n.localStore,t.query,!0),i=t.view.da(r);return n.isPrimaryClient&&_c(n,t.targetId,i.Ta),i}async function xc(e,t){const n=w(e);return Ro(n.localStore,t).then((e=>Sc(n,e)))}async function kc(e,t,n,r){const i=w(e),s=await function(e,t){const n=w(e),r=w(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Cn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):re.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await Aa(i.remoteStore):"acknowledged"===n||"rejected"===n?(wc(i,t,r||null),vc(i,t),function(e,t){w(w(e).mutationQueue).Fn(t)}(i.localStore,t)):y(),await Sc(i,s)):p("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Pc(e,t,n){const r=w(e),i=[],s=[];for(const e of t){let t;const n=r.fa.get(e);if(n&&0!==n.length){t=await Lo(r.localStore,Sn(n[0]));for(const e of n){const t=r.ma.get(e),n=await Ac(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await Mo(r.localStore,e);t=await Lo(r.localStore,n),await hc(r,Lc(n),e,!1,t.resumeToken)}i.push(t)}return r.Va.a_(s),i}function Lc(e){return bn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Nc(e){return function(e){return w(w(e).persistence).Bi()}(w(e).localStore)}async function Oc(e,t,n,r){const i=w(e);if(i.Ca)return void p("SyncEngine","Ignoring unexpected query state notification.");const s=i.fa.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await Ro(i.localStore,Nn(s[0])),r=Gr.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,st.EMPTY_BYTE_STRING);await Sc(i,e,r);break}case"rejected":await No(i.localStore,t,!0),bc(i,t,r);break;default:y()}}async function Mc(e,t,n){const r=Rc(e);if(r.Ca){for(const e of t){if(r.fa.has(e)){p("SyncEngine","Adding an already active target "+e);continue}const t=await Mo(r.localStore,e),n=await Lo(r.localStore,t);await hc(r,Lc(t),n.targetId,!1,n.resumeToken),ma(r.remoteStore,n)}for(const e of n)r.fa.has(e)&&await No(r.localStore,e,!1).then((()=>{ga(r.remoteStore,e),bc(r,e)})).catch(ne)}}function Rc(e){const t=w(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=pc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Tc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=mc.bind(null,t),t.Va.a_=Ya.bind(null,t.eventManager),t.Va.Fa=Xa.bind(null,t.eventManager),t}function Fc(e){const t=w(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=yc.bind(null,t),t}class jc{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=sa(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return To(this.persistence,new So,e.initialUser,this.serializer)}createPersistence(e){return new ho(fo.jr,this.serializer)}createSharedClientState(e){return new Qo}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Vc extends jc{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){v(this.persistence.referenceDelegate instanceof mo);const n=this.persistence.referenceDelegate.garbageCollector;return new Us(n,e.asyncQueue,t)}createPersistence(e){const t=void 0!==this.cacheSizeBytes?Ds.withCacheSize(this.cacheSizeBytes):Ds.DEFAULT;return new ho((e=>mo.jr(e,t)),this.serializer)}}class Bc extends jc{constructor(e,t,n){super(),this.xa=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xa.initialize(this,e),await Fc(this.xa.syncEngine),await Aa(this.xa.remoteStore),await this.persistence.mi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}createLocalStore(e){return To(this.persistence,new So,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Us(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new fe(t,this.persistence);return new pe(e.asyncQueue,n)}createPersistence(e){const t=_o(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ds.withCacheSize(this.cacheSizeBytes):Ds.DEFAULT;return new wo(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,ra(),ia(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Qo}}class Uc extends Bc{constructor(e,t){super(e,t,!1),this.xa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xa.syncEngine;this.sharedClientState instanceof Ho&&(this.sharedClientState.syncEngine={Ys:kc.bind(null,t),Zs:Oc.bind(null,t),Xs:Mc.bind(null,t),Bi:Nc.bind(null,t),Js:xc.bind(null,t)},await this.sharedClientState.start()),await this.persistence.mi((async e=>{await async function(e,t){const n=w(e);if(Rc(n),Fc(n),!0===t&&!0!==n.Ca){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Pc(n,e.toArray());n.Ca=!0,await ja(n.remoteStore,!0);for(const e of t)ma(n.remoteStore,e)}else if(!1===t&&!1!==n.Ca){const e=[];let t=Promise.resolve();n.fa.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(bc(n,i),No(n.localStore,i,!0)))),ga(n.remoteStore,i)})),await t,await Pc(n,e),function(e){const t=w(e);t.ya.forEach(((e,n)=>{ga(t.remoteStore,n)})),t.wa.Vr(),t.ya=new Map,t.pa=new Xe(q.comparator)}(n),n.Ca=!1,await ja(n.remoteStore,!1)}}(this.xa.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}createSharedClientState(e){const t=ra();if(!Ho.D(t))throw new E(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=_o(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ho(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class qc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>fc(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dc.bind(null,this.syncEngine),await ja(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ha}createDatastore(e){const t=sa(e.databaseInfo.databaseId),n=function(e){return new na(e)}(e.databaseInfo);return function(e,t,n,r){return new la(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new da(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>fc(this.syncEngine,e,0)),Yo.D()?new Yo:new Wo)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new uc(e,t,n,r,i,s);return o&&(a.Ca=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=w(e);p("RemoteStore","RemoteStore shutting down."),t.C_.add(5),await fa(t),t.F_.shutdown(),t.M_.set("Unknown")}(this.remoteStore)}}function zc(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Gc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Oa(this.observer.next,e)}error(e){this.observer.error?this.Oa(this.observer.error,e):f("Uncaught Error in snapshot listener:",e.toString())}Na(){this.muted=!0}Oa(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class $c{constructor(e,t){this.Ba=e,this.serializer=t,this.metadata=new _,this.buffer=new Uint8Array,this.La=new TextDecoder("utf-8"),this.ka().then((e=>{e&&e.Z_()?this.metadata.resolve(e.Y_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.Y_)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Ba.cancel()}async getMetadata(){return this.metadata.promise}async Ma(){return await this.getMetadata(),this.ka()}async ka(){const e=await this.qa();if(null===e)return null;const t=this.La.decode(e),n=Number(t);isNaN(n)&&this.Qa(`length string (${t}) is not valid number`);const r=await this.Ka(n);return new ec(JSON.parse(r),e.length+n)}$a(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async qa(){for(;this.$a()<0&&!await this.Ua(););if(0===this.buffer.length)return null;const e=this.$a();e<0&&this.Qa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ka(e){for(;this.buffer.length<e;)await this.Ua()&&this.Qa("Reached the end of bundle when more is expected.");const t=this.La.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qa(e){throw this.Ba.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ua(){const e=await this.Ba.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Kc{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new E(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=w(e),r=fi(n.serializer)+"/documents",i={documents:t.map((e=>li(n.serializer,e)))},s=await n.Co("BatchGetDocuments",r,i,t.length),o=new Map;s.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){v(!!t.found),t.found.name,t.found.updateTime;const n=hi(e,t.found.name),r=ai(t.found.updateTime),i=t.found.createTime?ai(t.found.createTime):F.min(),s=new Ft({mapValue:{fields:t.found.fields}});return Vt.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){v(!!t.missing),v(!!t.readTime);const n=hi(e,t.missing),r=ai(t.readTime);return Vt.newNoDocument(n,r)}(e,t):y()}(n.serializer,e);o.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=o.get(e.toString());v(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Dr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=q.fromPath(t);this.mutations.push(new Tr(n,this.precondition(n)))})),await async function(e,t){const n=w(e),r=fi(n.serializer)+"/documents",i={writes:t.map((e=>vi(n.serializer,e)))};await n.wo("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw y();t=F.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new E(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(F.min())?pr.exists(!1):pr.updateTime(t):pr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(F.min()))throw new E(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return pr.updateTime(t)}return pr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Hc{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Wa=n.maxAttempts,this.zo=new oa(this.asyncQueue,"transaction_retry")}run(){this.Wa-=1,this.Ga()}Ga(){this.zo.ko((async()=>{const e=new Kc(this.datastore),t=this.za(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.ja(e)}))))})).catch((e=>{this.ja(e)}))}))}za(e){try{const t=this.updateFunction(e);return!ge(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ja(e){this.Wa>0&&this.Ha(e)?(this.Wa-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ga(),Promise.resolve())))):this.deferred.reject(e)}Ha(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Mr(t)}return!1}}class Qc{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=u.UNAUTHENTICATED,this.clientId=L.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{p("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(p("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new E(b.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=qa(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Wc(e,t){e.asyncQueue.verifyOperationInProgress(),p("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Ao(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Yc(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Jc(e);p("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>Fa(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Fa(t.remoteStore,n))),e._onlineComponents=t}function Xc(e){return"FirebaseError"===e.name?e.code===b.FAILED_PRECONDITION||e.code===b.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function Jc(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){p("FirestoreClient","Using user provided OfflineComponentProvider");try{await Wc(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!Xc(n))throw n;m("Error using user provided cache. Falling back to memory cache: "+n),await Wc(e,new jc)}}else p("FirestoreClient","Using default OfflineComponentProvider"),await Wc(e,new jc);return e._offlineComponents}async function Zc(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(p("FirestoreClient","Using user provided OnlineComponentProvider"),await Yc(e,e._uninitializedComponentsProvider._online)):(p("FirestoreClient","Using default OnlineComponentProvider"),await Yc(e,new qc))),e._onlineComponents}function eu(e){return Jc(e).then((e=>e.persistence))}function tu(e){return Jc(e).then((e=>e.localStore))}function nu(e){return Zc(e).then((e=>e.remoteStore))}function ru(e){return Zc(e).then((e=>e.syncEngine))}function iu(e){return Zc(e).then((e=>e.datastore))}async function su(e){const t=await Zc(e),n=t.eventManager;return n.onListen=lc.bind(null,t.syncEngine),n.onUnlisten=dc.bind(null,t.syncEngine),n}function ou(e,t,n={}){const r=new _;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Gc({next:s=>{t.enqueueAndForget((()=>Wa(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new E(b.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new E(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new Za(En(n.path),s,{includeMetadataChanges:!0,J_:!0});return Qa(e,o)}(await su(e),e.asyncQueue,t,n,r))),r.promise}function au(e,t,n={}){const r=new _;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Gc({next:n=>{t.enqueueAndForget((()=>Wa(e,o))),n.fromCache&&"server"===r.source?i.reject(new E(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Za(n,s,{includeMetadataChanges:!0,J_:!0});return Qa(e,o)}(await su(e),e.asyncQueue,t,n,r))),r.promise}function cu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const uu=new Map;function lu(e,t,n){if(!n)throw new E(b.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function hu(e,t,n,r){if(!0===t&&!0===r)throw new E(b.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function du(e){if(!q.isDocumentKey(e))throw new E(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function pu(e){if(q.isDocumentKey(e))throw new E(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function fu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":y()}function mu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new E(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=fu(e);throw new E(b.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function gu(e,t){if(t<=0)throw new E(b.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class yu{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new E(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new E(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hu("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cu(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new E(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new E(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new E(b.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vu{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new E(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new E(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yu(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new I;switch(e.type){case"firstParty":return new A(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new E(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=uu.get(e);t&&(p("ComponentProvider","Removing Datastore"),uu.delete(e),t.terminate())}(this),Promise.resolve()}}function wu(e,t,n,r={}){var i;const s=(e=mu(e,vu))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&m("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=u.MOCK_USER;else{t=o.createMockUserToken(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new E(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new u(s)}e._authCredentials=new S(new C(t,n))}}class bu{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new bu(this.firestore,e,this._query)}}class Eu{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _u(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Eu(this.firestore,e,this._key)}}class _u extends bu{constructor(e,t,n){super(e,t,En(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Eu(this.firestore,null,new q(e))}withConverter(e){return new _u(this.firestore,e,this._path)}}function Cu(e,t,...n){if(e=o.getModularInstance(e),1===arguments.length&&(t=L.newId()),lu("doc","path",t),e instanceof vu){const r=V.fromString(t,...n);return du(r),new Eu(e,null,new q(r))}{if(!(e instanceof Eu||e instanceof _u))throw new E(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(V.fromString(t,...n));return du(r),new Eu(e.firestore,e instanceof _u?e.converter:null,new q(r))}}function Iu(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),e instanceof bu&&t instanceof bu&&e.firestore===t.firestore&&xn(e._query,t._query)&&e.converter===t.converter}class Su{constructor(){this.Ja=Promise.resolve(),this.Ya=[],this.Za=!1,this.Xa=[],this.eu=null,this.tu=!1,this.nu=!1,this.ru=[],this.zo=new oa(this,"async_queue_retry"),this.iu=()=>{const e=ia();e&&p("AsyncQueue","Visibility state changed to "+e.visibilityState),this.zo.Qo()};const e=ia();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.iu)}get isShuttingDown(){return this.Za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.su(),this.ou(e)}enterRestrictedMode(e){if(!this.Za){this.Za=!0,this.nu=e||!1;const t=ia();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.iu)}}enqueue(e){if(this.su(),this.Za)return new Promise((()=>{}));const t=new _;return this.ou((()=>this.Za&&this.nu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Ya.push(e),this._u())))}async _u(){if(0!==this.Ya.length){try{await this.Ya[0](),this.Ya.shift(),this.zo.reset()}catch(e){if(!ce(e))throw e;p("AsyncQueue","Operation failed with retryable error: "+e)}this.Ya.length>0&&this.zo.ko((()=>this._u()))}}ou(e){const t=this.Ja.then((()=>(this.tu=!0,e().catch((e=>{this.eu=e,this.tu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw f("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.tu=!1,e))))));return this.Ja=t,t}enqueueAfterDelay(e,t,n){this.su(),this.ru.indexOf(e)>-1&&(t=0);const r=Ua.createAndSchedule(this,e,t,n,(e=>this.au(e)));return this.Xa.push(r),r}su(){this.eu&&y()}verifyOperationInProgress(){}async uu(){let e;do{e=this.Ja,await e}while(e!==this.Ja)}cu(e){for(const t of this.Xa)if(t.timerId===e)return!0;return!1}lu(e){return this.uu().then((()=>{this.Xa.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Xa)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.uu()}))}hu(e){this.ru.push(e)}au(e){const t=this.Xa.indexOf(e);this.Xa.splice(t,1)}}function Du(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class Tu{constructor(){this._progressObserver={},this._taskCompletionResolver=new _,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Au extends vu{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Su,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ku(this),this._firestoreClient.terminate()}}function xu(e){return e._firestoreClient||ku(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ku(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new pt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,cu(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Qc(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Pu(e,t,n){const r=new _;return e.asyncQueue.enqueue((async()=>{try{await Wc(e,n),await Yc(e,t),r.resolve()}catch(e){const t=e;if(!Xc(t))throw t;m("Error enabling indexeddb cache. Falling back to memory cache: "+t),r.reject(t)}})).then((()=>r.promise))}function Lu(e){if(e._initialized||e._terminated)throw new E(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Nu{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class Ou{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class Mu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mu(st.fromBase64String(e))}catch(e){throw new E(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Mu(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ru{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new E(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new U(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fu{constructor(e){this._methodName=e}}class ju{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new E(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new E(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return N(this._lat,e._lat)||N(this._long,e._long)}}const Vu=/^__.*__$/;class Bu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new _r(e,this.data,this.fieldMask,t,this.fieldTransforms):new Er(e,this.data,t,this.fieldTransforms)}}class Uu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new _r(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function qu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}class zu{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Pu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Iu(){return this.settings.Iu}Tu(e){return new zu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Eu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Tu({path:n,du:!1});return r.Au(e),r}Ru(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Tu({path:n,du:!1});return r.Pu(),r}Vu(e){return this.Tu({path:void 0,du:!0})}mu(e){return ul(e,this.settings.methodName,this.settings.fu||!1,this.path,this.settings.gu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Au(this.path.get(e))}Au(e){if(0===e.length)throw this.mu("Document fields must not be empty");if(qu(this.Iu)&&Vu.test(e))throw this.mu('Document fields cannot begin and end with "__"')}}class Gu{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||sa(e)}pu(e,t,n,r=!1){return new zu({Iu:e,methodName:t,gu:n,path:U.emptyPath(),du:!1,fu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $u(e){const t=e._freezeSettings(),n=sa(e._databaseId);return new Gu(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ku(e,t,n,r,i,s={}){const o=e.pu(s.merge||s.mergeFields?2:0,t,n,i);sl("Data must be an object, but it was:",o,r);const a=rl(r,o);let c,u;if(s.merge)c=new rt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=ol(t,r,n);if(!o.contains(i))throw new E(b.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);ll(e,i)||e.push(i)}c=new rt(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Bu(new Ft(a),c,u)}class Hu extends Fu{_toFieldTransform(e){if(2!==e.Iu)throw 1===e.Iu?e.mu(`${this._methodName}() can only appear at the top level of your update data`):e.mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Hu}}function Qu(e,t,n){return new zu({Iu:3,gu:t.settings.gu,methodName:e._methodName,du:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Wu extends Fu{_toFieldTransform(e){return new hr(e.path,new rr)}isEqual(e){return e instanceof Wu}}class Yu extends Fu{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=Qu(this,e,!0),n=this.yu.map((e=>nl(e,t))),r=new ir(n);return new hr(e.path,r)}isEqual(e){return this===e}}class Xu extends Fu{constructor(e,t){super(e),this.yu=t}_toFieldTransform(e){const t=Qu(this,e,!0),n=this.yu.map((e=>nl(e,t))),r=new or(n);return new hr(e.path,r)}isEqual(e){return this===e}}class Ju extends Fu{constructor(e,t){super(e),this.wu=t}_toFieldTransform(e){const t=new cr(e.serializer,Jn(e.serializer,this.wu));return new hr(e.path,t)}isEqual(e){return this===e}}function Zu(e,t,n,r){const i=e.pu(1,t,n);sl("Data must be an object, but it was:",i,r);const s=[],a=Ft.empty();We(r,((e,r)=>{const c=cl(t,e,n);r=o.getModularInstance(r);const u=i.Ru(c);if(r instanceof Hu)s.push(c);else{const e=nl(r,u);null!=e&&(s.push(c),a.set(c,e))}}));const c=new rt(s);return new Uu(a,c,i.fieldTransforms)}function el(e,t,n,r,i,s){const a=e.pu(1,t,n),c=[ol(t,r,n)],u=[i];if(s.length%2!=0)throw new E(b.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)c.push(ol(t,s[e])),u.push(s[e+1]);const l=[],h=Ft.empty();for(let e=c.length-1;e>=0;--e)if(!ll(l,c[e])){const t=c[e];let n=u[e];n=o.getModularInstance(n);const r=a.Ru(t);if(n instanceof Hu)l.push(t);else{const e=nl(n,r);null!=e&&(l.push(t),h.set(t,e))}}const d=new rt(l);return new Uu(h,d,a.fieldTransforms)}function tl(e,t,n,r=!1){return nl(n,e.pu(r?4:3,t))}function nl(e,t){if(il(e=o.getModularInstance(e)))return sl("Unsupported field value:",t,e),rl(e,t);if(e instanceof Fu)return function(e,t){if(!qu(t.Iu))throw t.mu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.mu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.du&&4!==t.Iu)throw t.mu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=nl(i,t.Vu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=o.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Jn(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=R.fromDate(e);return{timestampValue:ii(t.serializer,n)}}if(e instanceof R){const n=new R(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ii(t.serializer,n)}}if(e instanceof ju)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Mu)return{bytesValue:si(t.serializer,e._byteString)};if(e instanceof Eu){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.mu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ci(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.mu(`Unsupported field value: ${fu(e)}`)}(e,t)}function rl(e,t){const n={};return Ye(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):We(e,((e,r)=>{const i=nl(r,t.Eu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function il(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof R||e instanceof ju||e instanceof Mu||e instanceof Eu||e instanceof Fu)}function sl(e,t,n){if(!il(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=fu(n);throw"an object"===r?t.mu(e+" a custom object"):t.mu(e+" "+r)}}function ol(e,t,n){if((t=o.getModularInstance(t))instanceof Ru)return t._internalPath;if("string"==typeof t)return cl(e,t);throw ul("Field path arguments must be of type string or ",e,!1,void 0,n)}const al=new RegExp("[~\\*/\\[\\]]");function cl(e,t,n){if(t.search(al)>=0)throw ul(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ru(...t.split("."))._internalPath}catch(r){throw ul(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ul(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new E(b.INVALID_ARGUMENT,a+e+c)}function ll(e,t){return e.some((e=>e.isEqual(t)))}class hl{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Eu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new dl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(pl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class dl extends hl{data(){return super.data()}}function pl(e,t){return"string"==typeof t?cl(e,t):t instanceof Ru?t._internalPath:t._delegate._internalPath}function fl(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new E(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ml{}class gl extends ml{}class yl extends gl{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new yl(e,t,n)}_apply(e){const t=this._parse(e);return Dl(e._query,t),new bu(e.firestore,e.converter,Tn(e._query,t))}_parse(e){const t=$u(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new E(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Sl(o,s);const t=[];for(const n of o)t.push(Il(r,e,n));a={arrayValue:{values:t}}}else a=Il(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Sl(o,s),a=tl(n,"where",o,"in"===s||"not-in"===s);return Kt.create(i,s,a)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class vl extends ml{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vl(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)Dl(n,e),n=Tn(n,e)}(e._query,t),new bu(e.firestore,e.converter,Tn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class wl extends gl{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wl(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new E(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new E(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new zt(t,n)}(e._query,this._field,this._direction);return new bu(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new wn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class bl extends gl{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new bl(e,t,n)}_apply(e){return new bu(e.firestore,e.converter,An(e._query,this._limit,this._limitType))}}class El extends gl{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new El(e,t,n)}_apply(e){const t=Cl(e,this.type,this._docOrFields,this._inclusive);return new bu(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class _l extends gl{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new _l(e,t,n)}_apply(e){const t=Cl(e,this.type,this._docOrFields,this._inclusive);return new bu(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Cl(e,t,n,r){if(n[0]=o.getModularInstance(n[0]),n[0]instanceof hl)return function(e,t,n,r,i){if(!r)throw new E(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of In(e))if(n.field.isKeyField())s.push(St(t,r.key));else{const e=r.data.field(n.field);if(lt(e))throw new E(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new E(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new Bt(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=$u(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new E(b.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new E(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!Cn(e)&&-1!==c.indexOf("/"))throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(V.fromString(c));if(!q.isDocumentKey(n))throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new q(n);a.push(St(t,i))}else{const e=tl(n,r,c);a.push(e)}}return new Bt(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Il(e,t,n){if("string"==typeof(n=o.getModularInstance(n))){if(""===n)throw new E(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Cn(t)&&-1!==n.indexOf("/"))throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(V.fromString(n));if(!q.isDocumentKey(r))throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return St(e,new q(r))}if(n instanceof Eu)return St(e,n._key);throw new E(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fu(n)}.`)}function Sl(e,t){if(!Array.isArray(e)||0===e.length)throw new E(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Dl(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new E(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new E(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Tl(e,t){if(!(t instanceof yl||t instanceof vl))throw new E(b.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class Al{convertValue(e,t="none"){switch(yt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ut(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw y()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return We(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new ju(ct(e.latitude),ct(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ht(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(dt(e));default:return null}}convertTimestamp(e){const t=at(e);return new R(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=V.fromString(e);v(Pi(n));const r=new ft(n.get(1),n.get(3)),i=new q(n.popFirst(5));return r.isEqual(t)||f(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function xl(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class kl extends Al{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Eu(this.firestore,null,t)}}function Pl(){return new Nu("count")}class Ll{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Nl extends hl{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ol(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(pl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Ol extends Nl{data(e={}){return super.data(e)}}class Ml{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ll(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Ol(this._firestore,this._userDataWriter,n.key,n,new Ll(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new E(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Ol(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ll(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Ol(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ll(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Rl(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Rl(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return y()}}class Fl extends Al{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Eu(this.firestore,null,t)}}function jl(e,t){return function(e,t){const n=new _;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Fc(e);try{const e=await function(e,t){const n=w(e),r=R.now(),i=t.reduce(((e,t)=>e.add(t.key)),Hn());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=jn(),c=Hn();return n.ss.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=wr(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new _r(e.key,t,jt(t.value.mapValue),pr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Un(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Sa[e.currentUser.toKey()];r||(r=new Xe(N)),r=r.insert(t,n),e.Sa[e.currentUser.toKey()]=r}(r,e.batchId,n),await Sc(r,e.changes),await Aa(r.remoteStore)}catch(e){const t=qa(e,"Failed to persist write");n.reject(t)}}(await ru(e),t,n))),n.promise}(xu(e),t)}function Vl(e,t,n){const r=n.docs.get(t._key),i=new Fl(e);return new Nl(e,i,t._key,r,new Ll(n.hasPendingWrites,n.fromCache),t.converter)}function Bl(e,t){const n=mu(e.firestore,Au),r=xu(n),i=function(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r));return n}(t,((e,t)=>new Pr(t,e.aggregateType,e._internalFieldPath)));return function(e,t,n){const r=new _;return e.asyncQueue.enqueueAndForget((async()=>{try{const i=await iu(e);r.resolve(async function(e,t,n){var r;const i=w(e),{request:s,R_:o}=function(e,t,n){const r=Ei(e,t),i={},s=[];let o=0;return n.forEach((e=>{const t="aggregate_"+o++;i[t]=e.alias,"count"===e.aggregateType?s.push({alias:t,count:{}}):"avg"===e.aggregateType?s.push({alias:t,avg:{field:Ti(e.fieldPath)}}):"sum"===e.aggregateType&&s.push({alias:t,sum:{field:Ti(e.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:s,structuredQuery:r.structuredQuery},parent:r.parent},R_:i}}(i.serializer,function(e){const t=w(e);return t.Pe||(t.Pe=Dn(t,e.explicitOrderBy)),t.Pe}(t),n),a=s.parent;i.connection.yo||delete s.parent;const c=(await i.Co("RunAggregationQuery",a,s,1)).filter((e=>!!e.result));v(1===c.length);const u=null===(r=c[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(u).reduce(((e,t)=>(e[o[t]]=u[t],e)),{})}(i,t,n))}catch(e){r.reject(e)}})),r.promise}(r,e._query,i).then((t=>function(e,t,n){const r=new Fl(e);return new Ou(t,r,n)}(n,e,t)))}class Ul{constructor(e){this.kind="memory",this._onlineComponentProvider=new qc,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new jc}toJSON(){return{kind:this.kind}}}class ql{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=Hl(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class zl{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new jc}toJSON(){return{kind:this.kind}}}class Gl{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new Vc(e)}toJSON(){return{kind:this.kind}}}class $l{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new qc,this._offlineComponentProvider=new Bc(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}class Kl{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new qc,this._offlineComponentProvider=new Uc(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes)}}function Hl(e){return new $l(null==e?void 0:e.forceOwnership)}const Ql={maxAttempts:5};class Wl{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=$u(e)}set(e,t,n){this._verifyNotCommitted();const r=Yl(e,this._firestore),i=xl(r.converter,t,n),s=Ku(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,pr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=Yl(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Ru?el(this._dataReader,"WriteBatch.update",i._key,t,n,r):Zu(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,pr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Yl(e,this._firestore);return this._mutations=this._mutations.concat(new Dr(t._key,pr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new E(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Yl(e,t){if((e=o.getModularInstance(e)).firestore!==t)throw new E(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Xl extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=$u(e)}get(e){const t=Yl(e,this._firestore),n=new kl(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return y();const r=e[0];if(r.isFoundDocument())return new hl(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new hl(this._firestore,n,t._key,null,t.converter);throw y()}))}set(e,t,n){const r=Yl(e,this._firestore),i=xl(r.converter,t,n),s=Ku(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=Yl(e,this._firestore);let s;return s="string"==typeof(t=o.getModularInstance(t))||t instanceof Ru?el(this._dataReader,"Transaction.update",i._key,t,n,r):Zu(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=Yl(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Yl(e,this._firestore),n=new Fl(this._firestore);return super.get(e).then((e=>new Nl(this._firestore,n,t._key,e._document,new Ll(!1,!1),t.converter)))}}function Jl(e,t){if("string"!=typeof e[t])throw new E(b.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class Zl{constructor(e){this._client=e,this.type="PersistentCacheIndexManager"}}function eh(e,t){e._client.verifyNotTerminated(),function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){w(e).es.$i=t}(await tu(e),t)))}(e._client,t).then((e=>p(`setting persistent cache index auto creation isEnabled=${t} succeeded`))).catch((e=>m(`setting persistent cache index auto creation isEnabled=${t} failed`,e)))}const th=new WeakMap;class nh{constructor(){this.Su=new Map}static get instance(){return rh||(rh=new nh,function(e){if(Fr)throw new Error("a TestingHooksSpi instance is already set");Fr=e}(rh)),rh}tt(e){this.Su.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.Su;return n.set(t,e),()=>n.delete(t)}}let rh=null;!function(e,t=!0){!function(e){l=e}(r.SDK_VERSION),r._registerComponent(new i.Component("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new Au(new D(e.getProvider("auth-internal")),new k(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new E(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ft(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),r.registerVersion(c,"4.4.0",e),r.registerVersion(c,"4.4.0","cjs2017")}(),t.AbstractUserDataWriter=Al,t.AggregateField=Nu,t.AggregateQuerySnapshot=Ou,t.Bytes=Mu,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=_u,t.DocumentReference=Eu,t.DocumentSnapshot=Nl,t.FieldPath=Ru,t.FieldValue=Fu,t.Firestore=Au,t.FirestoreError=E,t.GeoPoint=ju,t.LoadBundleTask=Tu,t.PersistentCacheIndexManager=Zl,t.Query=bu,t.QueryCompositeFilterConstraint=vl,t.QueryConstraint=gl,t.QueryDocumentSnapshot=Ol,t.QueryEndAtConstraint=_l,t.QueryFieldFilterConstraint=yl,t.QueryLimitConstraint=bl,t.QueryOrderByConstraint=wl,t.QuerySnapshot=Ml,t.QueryStartAtConstraint=El,t.SnapshotMetadata=Ll,t.Timestamp=R,t.Transaction=Xl,t.WriteBatch=Wl,t._AutoId=L,t._ByteString=st,t._DatabaseId=ft,t._DocumentKey=q,t._EmptyAppCheckTokenProvider=class{getToken(){return Promise.resolve(new x(""))}invalidateToken(){}start(e,t){}shutdown(){}},t._EmptyAuthCredentialsProvider=I,t._FieldPath=U,t._TestingHooks=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return nh.instance.onExistenceFilterMismatch(e)}},t._cast=mu,t._debugAssert=function(e,t){e||y()},t._isBase64Available=function(){return"undefined"!=typeof atob},t._logWarn=m,t._validateIsNotUsedTogether=hu,t.addDoc=function(e,t){const n=mu(e.firestore,Au),r=Cu(e),i=xl(e.converter,t);return jl(n,[Ku($u(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,pr.exists(!1))]).then((()=>r))},t.aggregateFieldEqual=function(e,t){var n,r;return e instanceof Nu&&t instanceof Nu&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())},t.aggregateQuerySnapshotEqual=function(e,t){return Iu(e.query,t.query)&&o.deepEqual(e.data(),t.data())},t.and=function(...e){return e.forEach((e=>Tl("and",e))),vl._create("and",e)},t.arrayRemove=function(...e){return new Xu("arrayRemove",e)},t.arrayUnion=function(...e){return new Yu("arrayUnion",e)},t.average=function(e){return new Nu("avg",ol("average",e))},t.clearIndexedDbPersistence=function(e){if(e._initialized&&!e._terminated)throw new E(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new _;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!se.D())return Promise.resolve();const t=e+"main";await se.delete(t)}(_o(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise},t.collection=function(e,t,...n){if(e=o.getModularInstance(e),lu("collection","path",t),e instanceof vu){const r=V.fromString(t,...n);return pu(r),new _u(e,null,r)}{if(!(e instanceof Eu||e instanceof _u))throw new E(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(V.fromString(t,...n));return pu(r),new _u(e.firestore,null,r)}},t.collectionGroup=function(e,t){if(e=mu(e,vu),lu("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new E(b.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new bu(e,null,function(e){return new wn(V.emptyPath(),e)}(t))},t.connectFirestoreEmulator=wu,t.count=Pl,t.deleteAllPersistentCacheIndexes=function(e){e._client.verifyNotTerminated(),function(e){return e.asyncQueue.enqueue((async()=>function(e){const t=w(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",(e=>n.deleteAllFieldIndexes(e)))}(await tu(e))))}(e._client).then((e=>p("deleting all persistent cache indexes succeeded"))).catch((e=>m("deleting all persistent cache indexes failed",e)))},t.deleteDoc=function(e){return jl(mu(e.firestore,Au),[new Dr(e._key,pr.none())])},t.deleteField=function(){return new Hu("deleteField")},t.disableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await eu(e),n=await nu(e);return t.setNetworkEnabled(!1),async function(e){const t=w(e);t.C_.add(0),await fa(t),t.M_.set("Offline")}(n)}))}(xu(e=mu(e,Au)))},t.disablePersistentCacheIndexAutoCreation=function(e){eh(e,!1)},t.doc=Cu,t.documentId=function(){return new Ru("__name__")},t.enableIndexedDbPersistence=function(e,t){Lu(e=mu(e,Au));const n=xu(e);if(n._uninitializedComponentsProvider)throw new E(b.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new qc;return Pu(n,i,new Bc(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))},t.enableMultiTabIndexedDbPersistence=function(e){Lu(e=mu(e,Au));const t=xu(e);if(t._uninitializedComponentsProvider)throw new E(b.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new qc;return Pu(t,r,new Uc(r,n.cacheSizeBytes))},t.enableNetwork=function(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await eu(e),n=await nu(e);return t.setNetworkEnabled(!0),function(e){const t=w(e);return t.C_.delete(0),pa(t)}(n)}))}(xu(e=mu(e,Au)))},t.enablePersistentCacheIndexAutoCreation=function(e){eh(e,!0)},t.endAt=function(...e){return _l._create("endAt",e,!0)},t.endBefore=function(...e){return _l._create("endBefore",e,!1)},t.ensureFirestoreConfigured=xu,t.executeWrite=jl,t.getAggregateFromServer=Bl,t.getCountFromServer=function(e){return Bl(e,{count:Pl()})},t.getDoc=function(e){e=mu(e,Eu);const t=mu(e.firestore,Au);return ou(xu(t),e._key).then((n=>Vl(t,e,n)))},t.getDocFromCache=function(e){e=mu(e,Eu);const t=mu(e.firestore,Au),n=xu(t),r=new Fl(t);return function(e,t){const n=new _;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=w(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new E(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=qa(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await tu(e),t,n))),n.promise}(n,e._key).then((n=>new Nl(t,r,e._key,n,new Ll(null!==n&&n.hasLocalMutations,!0),e.converter)))},t.getDocFromServer=function(e){e=mu(e,Eu);const t=mu(e.firestore,Au);return ou(xu(t),e._key,{source:"server"}).then((n=>Vl(t,e,n)))},t.getDocs=function(e){e=mu(e,bu);const t=mu(e.firestore,Au),n=xu(t),r=new Fl(t);return fl(e._query),au(n,e._query).then((n=>new Ml(t,r,e,n)))},t.getDocsFromCache=function(e){e=mu(e,bu);const t=mu(e.firestore,Au),n=xu(t),r=new Fl(t);return function(e,t){const n=new _;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Oo(e,t,!0),i=new oc(t,r.ls),s=i.ca(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=qa(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await tu(e),t,n))),n.promise}(n,e._query).then((n=>new Ml(t,r,e,n)))},t.getDocsFromServer=function(e){e=mu(e,bu);const t=mu(e.firestore,Au),n=xu(t),r=new Fl(t);return au(n,e._query,{source:"server"}).then((n=>new Ml(t,r,e,n)))},t.getFirestore=function(e,t){const n="object"==typeof e?e:r.getApp(),i="string"==typeof e?e:t||"(default)",s=r._getProvider(n,"firestore").getImmediate({identifier:i});if(!s._initialized){const e=o.getDefaultEmulatorHostnameAndPort("firestore");e&&wu(s,...e)}return s},t.getPersistentCacheIndexManager=function(e){var t;e=mu(e,Au);const n=th.get(e);if(n)return n;const r=xu(e);if("persistent"!==(null===(t=r._uninitializedComponentsProvider)||void 0===t?void 0:t._offlineKind))return null;const i=new Zl(r);return th.set(e,i),i},t.increment=function(e){return new Ju("increment",e)},t.initializeFirestore=function(e,t,n){n||(n="(default)");const i=r._getProvider(e,"firestore");if(i.isInitialized(n)){const e=i.getImmediate({identifier:n}),r=i.getOptions(n);if(o.deepEqual(r,t))return e;throw new E(b.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new E(b.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new E(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return i.initialize({options:t,instanceIdentifier:n})},t.limit=function(e){return gu("limit",e),bl._create("limit",e,"F")},t.limitToLast=function(e){return gu("limitToLast",e),bl._create("limitToLast",e,"L")},t.loadBundle=function(e,t){const n=xu(e=mu(e,Au)),r=new Tu;return function(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?jr().encode(e):e,function(e,t){return new $c(e,t)}(function(e,t){if(e instanceof Uint8Array)return zc(e,t);if(e instanceof ArrayBuffer)return zc(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,sa(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=w(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=w(e),r=ai(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Kr.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(rc(r));const i=new nc(r,e.localStore,t.serializer);let s=await t.Ma();for(;s;){const e=await i.ea(s);e&&n._updateProgress(e),s=await t.Ma()}const o=await i.complete();return await Sc(e,o.ra,void 0),await function(e,t){const n=w(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Kr.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.na)}catch(e){return m("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await ru(e),i,r)}))}(n,e._databaseId,t,r),r},t.memoryEagerGarbageCollector=function(){return new zl},t.memoryLocalCache=function(e){return new Ul(e)},t.memoryLruGarbageCollector=function(e){return new Gl(null==e?void 0:e.cacheSizeBytes)},t.namedQuery=function(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=w(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Kr.getNamedQuery(e,t)))}(await tu(e),t)))}(xu(e=mu(e,Au)),t).then((t=>t?new bu(e,null,t.query):null))},t.onSnapshot=function(e,...t){var n,r,i;e=o.getModularInstance(e);let s={includeMetadataChanges:!1},a=0;"object"!=typeof t[a]||Du(t[a])||(s=t[a],a++);const c={includeMetadataChanges:s.includeMetadataChanges};if(Du(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,l,h;if(e instanceof Eu)l=mu(e.firestore,Au),h=En(e._key.path),u={next:n=>{t[a]&&t[a](Vl(l,e,n))},error:t[a+1],complete:t[a+2]};else{const n=mu(e,bu);l=mu(n.firestore,Au),h=n._query;const r=new Fl(l);u={next:e=>{t[a]&&t[a](new Ml(l,r,n,e))},error:t[a+1],complete:t[a+2]},fl(e._query)}return function(e,t,n,r){const i=new Gc(r),s=new Za(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Qa(await su(e),s))),()=>{i.Na(),e.asyncQueue.enqueueAndForget((async()=>Wa(await su(e),s)))}}(xu(l),h,c,u)},t.onSnapshotsInSync=function(e,t){return function(e,t){const n=new Gc(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).q_.add(t),t.next()}(await su(e),n))),()=>{n.Na(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){w(e).q_.delete(t)}(await su(e),n)))}}(xu(e=mu(e,Au)),Du(t)?t:{next:t})},t.or=function(...e){return e.forEach((e=>Tl("or",e))),vl._create("or",e)},t.orderBy=function(e,t="asc"){const n=t,r=pl("orderBy",e);return wl._create(r,n)},t.persistentLocalCache=function(e){return new ql(e)},t.persistentMultipleTabManager=function(){return new Kl},t.persistentSingleTabManager=Hl,t.query=function(e,t,...n){let r=[];t instanceof ml&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof vl)).length,n=e.filter((e=>e instanceof yl)).length;if(t>1||t>0&&n>0)throw new E(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e},t.queryEqual=Iu,t.refEqual=function(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),(e instanceof Eu||e instanceof _u)&&(t instanceof Eu||t instanceof _u)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},t.runTransaction=function(e,t,n){e=mu(e,Au);const r=Object.assign(Object.assign({},Ql),n);return function(e){if(e.maxAttempts<1)throw new E(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new _;return e.asyncQueue.enqueueAndForget((async()=>{const i=await iu(e);new Hc(e.asyncQueue,i,n,t,r).run()})),r.promise}(xu(e),(n=>t(new Xl(e,n))),r)},t.serverTimestamp=function(){return new Wu("serverTimestamp")},t.setDoc=function(e,t,n){e=mu(e,Eu);const r=mu(e.firestore,Au),i=xl(e.converter,t,n);return jl(r,[Ku($u(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,pr.none())])},t.setIndexConfiguration=function(e,t){var n;const r=xu(e=mu(e,Au));if(!r._uninitializedComponentsProvider||"memory"===(null===(n=r._uninitializedComponentsProvider)||void 0===n?void 0:n._offlineKind))return m("Cannot enable indexes when persistence is disabled"),Promise.resolve();const i=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new E(b.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const e of t.indexes){const t=Jl(e,"collectionGroup"),r=[];if(Array.isArray(e.fields))for(const t of e.fields){const e=cl("setIndexConfiguration",Jl(t,"fieldPath"));"CONTAINS"===t.arrayConfig?r.push(new H(e,2)):"ASCENDING"===t.order?r.push(new H(e,0)):"DESCENDING"===t.order&&r.push(new H(e,1))}n.push(new z(z.UNKNOWN_ID,t,r,W.empty()))}return n}(t);return function(e,t){return e.asyncQueue.enqueue((async()=>async function(e,t){const n=w(e),r=n.indexManager,i=[];return n.persistence.runTransaction("Configure indexes","readwrite",(e=>r.getFieldIndexes(e).next((n=>function(e,t,n,r,i){e=[...e],t=[...t],e.sort(n),t.sort(n);const s=e.length,o=t.length;let a=0,c=0;for(;a<o&&c<s;){const s=n(e[c],t[a]);s<0?i(e[c++]):s>0?r(t[a++]):(a++,c++)}for(;a<o;)r(t[a++]);for(;c<s;)i(e[c++])}(n,t,K,(t=>{i.push(r.addFieldIndex(e,t))}),(t=>{i.push(r.deleteFieldIndex(e,t))})))).next((()=>re.waitFor(i)))))}(await tu(e),t)))}(r,i)},t.setLogLevel=function(e){h.setLogLevel(e)},t.snapshotEqual=function(e,t){return e instanceof Nl&&t instanceof Nl?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Ml&&t instanceof Ml&&e._firestore===t._firestore&&Iu(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},t.startAfter=function(...e){return El._create("startAfter",e,!1)},t.startAt=function(...e){return El._create("startAt",e,!0)},t.sum=function(e){return new Nu("sum",ol("sum",e))},t.terminate=function(e){return r._removeServiceInstance(e.app,"firestore",e._databaseId.database),e._delete()},t.updateDoc=function(e,t,n,...r){e=mu(e,Eu);const i=mu(e.firestore,Au),s=$u(i);let a;return a="string"==typeof(t=o.getModularInstance(t))||t instanceof Ru?el(s,"updateDoc",e._key,t,n,r):Zu(s,"updateDoc",e._key,t),jl(i,[a.toMutation(e._key,pr.exists(!0))])},t.waitForPendingWrites=function(e){return function(e){const t=new _;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=w(e);Ea(n.remoteStore)||p("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=w(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.ba.get(e)||[];r.push(t),n.ba.set(e,r)}catch(e){const n=qa(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await ru(e),t))),t.promise}(xu(e=mu(e,Au)))},t.where=function(e,t,n){const r=t,i=pl("where",e);return yl._create(i,r,n)},t.writeBatch=function(e){return xu(e=mu(e,Au)),new Wl(e,(t=>jl(e,t)))}},19:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,s=n(582),o=[];t.LogLevel=void 0,(i=t.LogLevel||(t.LogLevel={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var a={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},c=t.LogLevel.INFO,u=((r={})[t.LogLevel.DEBUG]="log",r[t.LogLevel.VERBOSE]="log",r[t.LogLevel.INFO]="info",r[t.LogLevel.WARN]="warn",r[t.LogLevel.ERROR]="error",r),l=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),o=u[t];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));console[o].apply(console,s.__spreadArray(["[".concat(i,"]  ").concat(e.name,":")],n,!1))}},h=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?a[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.DEBUG],e,!1))},e.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.VERBOSE],e,!1))},e.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.INFO],e,!1))},e.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.WARN],e,!1))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1)),this._logHandler.apply(this,s.__spreadArray([this,t.LogLevel.ERROR],e,!1))},e}();t.Logger=h,t.setLogLevel=function(e){o.forEach((function(t){t.setLogLevel(e)}))},t.setUserLogHandler=function(e,n){for(var r=function(r){var i=null;n&&n.level&&(i=a[n.level]),r.userLogHandler=null===e?null:function(n,r){for(var s=[],o=2;o<arguments.length;o++)s[o-2]=arguments[o];var a=s.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");r>=(null!=i?i:n.logLevel)&&e({level:t.LogLevel[r].toLowerCase(),message:a,args:s,type:n.name})}},i=0,s=o;i<s.length;i++)r(s[i])}},313:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new c;const u=i<<2|s>>4;if(r.push(u),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(e){const t=o(e);return a.encodeByteArray(t,!0)},l=function(e){return u(e).replace(/\./g,"")},h=function(e){try{return a.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function d(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=d(e[n],t[n]));return e}function p(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}const f=()=>{try{return p().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&h(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},m=e=>{var t,n;return null===(n=null===(t=f())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){var e;const t=null===(e=f())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}class w extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b.prototype.create)}}class b{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(E,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new w(r,o,n)}}const E=/\{\$([^}]+)}/g;function _(e){return JSON.parse(e)}const C=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=_(h(s[0])||""),n=_(h(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function I(e){return null!==e&&"object"==typeof e}class S{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=D),void 0===r.error&&(r.error=D),void 0===r.complete&&(r.complete=D);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function D(){}function T(e,t){return`${e} failed: ${t} argument `}const A=144e5;t.CONSTANTS=r,t.DecodeBase64StringError=c,t.Deferred=g,t.ErrorFactory=b,t.FirebaseError=w,t.MAX_VALUE_MILLIS=A,t.RANDOM_FACTOR=.5,t.Sha1=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+u+i+n[e]&4294967295;u=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}},t.areCookiesEnabled=function(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)},t.assert=i,t.assertionError=s,t.async=function(e,t){return(...n)=>{Promise.resolve(!0).then((()=>{e(...n)})).catch((e=>{t&&t(e)}))}},t.base64=a,t.base64Decode=h,t.base64Encode=u,t.base64urlEncodeWithoutPadding=l,t.calculateBackoffMillis=function(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(A,r+i)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createMockUserToken=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(s)),""].join(".")},t.createSubscribe=function(e,t){const n=new S(e,t);return n.subscribe.bind(n)},t.decode=C,t.deepCopy=function(e){return d(void 0,e)},t.deepEqual=function e(t,n){if(t===n)return!0;const r=Object.keys(t),i=Object.keys(n);for(const s of r){if(!i.includes(s))return!1;const r=t[s],o=n[s];if(I(r)&&I(o)){if(!e(r,o))return!1}else if(r!==o)return!1}for(const e of i)if(!r.includes(e))return!1;return!0},t.deepExtend=d,t.errorPrefix=T,t.extractQuerystring=function(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)},t.getDefaultAppConfig=()=>{var e;return null===(e=f())||void 0===e?void 0:e.config},t.getDefaultEmulatorHost=m,t.getDefaultEmulatorHostnameAndPort=e=>{const t=m(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},t.getDefaults=f,t.getExperimentalSetting=e=>{var t;return null===(t=f())||void 0===t?void 0:t[`_${e}`]},t.getGlobal=p,t.getModularInstance=function(e){return e&&e._delegate?e._delegate:e},t.getUA=y,t.isAdmin=function(e){const t=C(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isBrowserExtension=function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id},t.isElectron=function(){return y().indexOf("Electron/")>=0},t.isEmpty=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){const e=y();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isIndexedDBAvailable=function(){try{return"object"==typeof indexedDB}catch(e){return!1}},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())},t.isNode=v,t.isNodeSdk=function(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isSafari=function(){return!v()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},t.isUWP=function(){return y().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){const t=C(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){const t=C(e).claims,n=Math.floor((new Date).getTime()/1e3);let r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){const t=C(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=_,t.map=function(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.ordinal=function(e){return Number.isFinite(e)?e+function(e){const t=(e=Math.abs(e))%100;if(t>=10&&t<=20)return"th";const n=e%10;return 1===n?"st":2===n?"nd":3===n?"rd":"th"}(e):`${e}`},t.promiseWithTimeout=function(e,t=2e3){const n=new g;return setTimeout((()=>n.reject("timeout!")),t),e.then(n.resolve,n.reject),n.promise},t.querystring=function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);if(s>=55296&&s<=56319){const t=s-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate."),s=65536+(t<<10)+(e.charCodeAt(r)-56320)}s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):s<65536?(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.validateArgCount=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(T(e,t)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(T(e,t)+"must be a valid context object.")},t.validateIndexedDBOpenable=function(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))},t.validateNamespace=function(e,t,n){if((!n||t)&&"string"!=typeof t)throw new Error(T(e,"namespace")+"must be a valid firebase namespace.")}},816:(e,t,n)=>{(function(){var t;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function i(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:r(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}var s,o="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},c=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function u(e,t){if(t)e:{var n=c;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))break e;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&a(n,e,{configurable:!0,writable:!0,value:t})}}if("function"==typeof Object.setPrototypeOf)s=Object.setPrototypeOf;else{var l;e:{var h={};try{h.__proto__={a:!0},l=h.a;break e}catch(U){}l=!1}s=l?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=s;function p(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function f(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}function m(e,t){return Object.prototype.hasOwnProperty.call(e,t)}u("Symbol",(function(e){function t(e,t){this.g=e,a(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}})),u("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=c[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&a(i.prototype,e,{configurable:!0,writable:!0,value:function(){return p(r(this))}})}return e})),u("Promise",(function(e){function t(e){this.g=0,this.i=void 0,this.h=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var s=c.setTimeout;n.prototype.i=function(e){s(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.B),reject:e(this.l)}},t.prototype.B=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.D(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.g)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.g);this.g=e,this.i=t,2===this.g&&this.C(),this.u()},t.prototype.C=function(){var e=this;s((function(){if(e.v()){var t=c.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.v=function(){if(this.o)return!1;var e=c.CustomEvent,t=c.Event,n=c.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=c.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.u=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)o.h(this.h[e]);this.h=null}};var o=new n;return t.prototype.D=function(e){var t=this.j();e.la(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){s(e)}}:t}var i,s,o=new t((function(e,t){i=e,s=t}));return this.la(r(e,i),r(n,s)),o},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.la=function(e,t){function n(){switch(r.g){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.g)}}var r=this;null==this.h?o.h(n):this.h.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var s=i(e),o=s.next();!o.done;o=s.next())r(o.value).la(t,n)}))},t.all=function(e){var n=i(e),s=n.next();return s.done?r([]):new t((function(e,t){function i(t){return function(n){o[t]=n,0==--a&&e(o)}}var o=[],a=0;do{o.push(void 0),a++,r(s.value).la(i(o.length-1),t),s=n.next()}while(!s.done)}))},t})),u("Array.prototype.values",(function(e){return e||function(){return f(this,(function(e,t){return t}))}})),u("Array.prototype.keys",(function(e){return e||function(){return f(this,(function(e){return e}))}})),u("WeakMap",(function(e){function t(e){if(this.g=(u+=Math.random()+1).toString(),e){e=i(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function s(e){if(!m(e,c)){var t=new n;a(e,c,{value:t})}}function o(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&s(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var c="$jscomp_hidden_"+Math.random();o("freeze"),o("preventExtensions"),o("seal");var u=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(s(e),!m(e,c))throw Error("WeakMap key fail: "+e);return e[c][this.g]=t,this},t.prototype.get=function(e){return r(e)&&m(e,c)?e[c][this.g]:void 0},t.prototype.has=function(e){return r(e)&&m(e,c)&&m(e[c],this.g)},t.prototype.delete=function(e){return!!(r(e)&&m(e,c)&&m(e[c],this.g))&&delete e[c][this.g]},t})),u("Map",(function(e){function t(){var e={};return e.V=e.next=e.head=e}function n(e,t){var n=e.g;return p((function(){if(n){for(;n.head!=e.g;)n=n.V;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?o.has(t)?n=o.get(t):(n=""+ ++a,o.set(t,n)):n="p_"+t;var r=e.h[n];if(r&&m(e.h,n))for(e=0;e<r.length;e++){var i=r[e];if(t!=t&&i.key!=i.key||t===i.key)return{id:n,list:r,index:e,K:i}}return{id:n,list:r,index:-1,K:void 0}}function s(e){if(this.h={},this.g=t(),this.size=0,e){e=i(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&"s"==s.value[1]&&!((s=r.next()).done||4!=s.value[0].x||"t"!=s.value[1]||!r.next().done)}catch(e){return!1}}())return e;var o=new WeakMap;s.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this.h[n.id]=[]),n.K?n.K.value=t:(n.K={next:this.g,V:this.g.V,head:this.g,key:e,value:t},n.list.push(n.K),this.g.V.next=n.K,this.g.V=n.K,this.size++),this},s.prototype.delete=function(e){return!(!(e=r(this,e)).K||!e.list||(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.K.V.next=e.K.next,e.K.next.V=e.K.V,e.K.head=null,this.size--,0))},s.prototype.clear=function(){this.h={},this.g=this.g.V=t(),this.size=0},s.prototype.has=function(e){return!!r(this,e).K},s.prototype.get=function(e){return(e=r(this,e).K)&&e.value},s.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},s.prototype.keys=function(){return n(this,(function(e){return e.key}))},s.prototype.values=function(){return n(this,(function(e){return e.value}))},s.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},s.prototype[Symbol.iterator]=s.prototype.entries;var a=0;return s})),u("Array.prototype.find",(function(e){return e||function(e,t){e:{var n=this;n instanceof String&&(n=String(n));for(var r=n.length,i=0;i<r;i++){var s=n[i];if(e.call(t,s,i,n)){e=s;break e}}e=void 0}return e}})),u("Array.prototype.entries",(function(e){return e||function(){return f(this,(function(e,t){return[e,t]}))}})),u("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var s=0;!(i=e.next()).done;)r.push(t.call(n,i.value,s++))}else for(i=e.length,s=0;s<i;s++)r.push(t.call(n,e[s],s));return r}})),u("Set",(function(e){function t(e){if(this.g=new Map,e){e=i(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),s=r.next();return!s.done&&s.value[0]==t&&s.value[1]==t&&!(s=r.next()).done&&s.value[0]!=t&&4==s.value[0].x&&s.value[1]==s.value[0]&&r.next().done}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(r){return e.call(t,r,r,n)}))},t)}));var g=g||{},y=this||self;function v(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function w(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function b(e){return Object.prototype.hasOwnProperty.call(e,E)&&e[E]||(e[E]=++_)}var E="closure_uid_"+(1e9*Math.random()>>>0),_=0;function C(e,t,n){return e.call.apply(e.bind,arguments)}function I(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function S(e,t,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:I).apply(null,arguments)}function D(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function T(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.dc=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function A(){0!=x&&(k[b(this)]=this),this.s=this.s,this.o=this.o}var x=0,k={};A.prototype.s=!1,A.prototype.va=function(){if(!this.s&&(this.s=!0,this.O(),0!=x)){var e=b(this);if(0!=x&&this.o&&0<this.o.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete k[e]}},A.prototype.O=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var P=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function L(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function N(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(v(r)){var i=e.length||0,s=r.length||0;e.length=i+s;for(var o=0;o<s;o++)e[i+o]=r[o]}else e.push(r)}}function O(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!y.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{var n=function(){};y.addEventListener("test",n,t),y.removeEventListener("test",n,t)}catch(e){}return e}();function R(e){return/^[\s\xa0]*$/.test(e)}function F(){var e=y.navigator;return e&&(e=e.userAgent)?e:""}function j(e){return-1!=F().indexOf(e)}function V(e){return V[" "](e),e}V[" "]=function(){};var B,U,q,z=j("Opera"),G=j("Trident")||j("MSIE"),$=j("Edge"),K=$||G,H=j("Gecko")&&!(-1!=F().toLowerCase().indexOf("webkit")&&!j("Edge"))&&!(j("Trident")||j("MSIE"))&&!j("Edge"),Q=-1!=F().toLowerCase().indexOf("webkit")&&!j("Edge");function W(){var e=y.document;return e?e.documentMode:void 0}e:{var Y="",X=(U=F(),H?/rv:([^\);]+)(\)|;)/.exec(U):$?/Edge\/([\d\.]+)/.exec(U):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(U):Q?/WebKit\/(\S+)/.exec(U):z?/(?:Version)[ \/]?(\S+)/.exec(U):void 0);if(X&&(Y=X?X[1]:""),G){var J=W();if(null!=J&&J>parseFloat(Y)){B=String(J);break e}}B=Y}y.document&&G?q=W()||parseInt(B,10)||void 0:q=void 0;var Z=q;function ee(e,t){if(O.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(H){e:{try{V(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:te[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ee.Z.h.call(this)}}T(ee,O);var te={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),re=0;function ie(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.oa=i,this.key=++re,this.ha=this.ka=!1}function se(e){e.ha=!0,e.listener=null,e.proxy=null,e.src=null,e.oa=null}function oe(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ae(e){var t,n={};for(t in e)n[t]=e[t];return n}var ce="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var s=0;s<ce.length;s++)n=ce[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function le(e){this.src=e,this.g={},this.h=0}function he(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=P(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(se(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function de(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ha&&s.listener==t&&s.capture==!!n&&s.oa==r)return i}return-1}le.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=de(e,t,r,i);return-1<o?(t=e[o],n||(t.ka=!1)):((t=new ie(t,this.src,s,!!r,i)).ka=n,e.push(t)),t};var pe="closure_lm_"+(1e6*Math.random()|0),fe={};function me(e,t,n,r,i){if(r&&r.once)return ye(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)me(e,t[s],n,r,i);return null}return n=Ie(n),e&&e[ne]?e.P(t,n,w(r)?!!r.capture:!!r,i):ge(e,t,n,!1,r,i)}function ge(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=w(i)?!!i.capture:!!i,a=_e(e);if(a||(e[pe]=a=new le(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){var e=Ee;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)M||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(be(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ye(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ye(e,t[s],n,r,i);return null}return n=Ie(n),e&&e[ne]?e.R(t,n,w(r)?!!r.capture:!!r,i):ge(e,t,n,!0,r,i)}function ve(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)ve(e,t[s],n,r,i);else r=w(r)?!!r.capture:!!r,n=Ie(n),e&&e[ne]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=de(s=e.g[t],n,r,i))&&(se(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=_e(e))&&(t=e.g[t.toString()],e=-1,t&&(e=de(t,n,r,i)),(n=-1<e?t[e]:null)&&we(n))}function we(e){if("number"!=typeof e&&e&&!e.ha){var t=e.src;if(t&&t[ne])he(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(be(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=_e(t))?(he(n,e),0==n.h&&(n.src=null,t[pe]=null)):se(e)}}}function be(e){return e in fe?fe[e]:fe[e]="on"+e}function Ee(e,t){if(e.ha)e=!0;else{t=new ee(t,this);var n=e.listener,r=e.oa||e.src;e.ka&&we(e),e=n.call(r,t)}return e}function _e(e){return(e=e[pe])instanceof le?e:null}var Ce="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ie(e){return"function"==typeof e?e:(e[Ce]||(e[Ce]=function(t){return e.handleEvent(t)}),e[Ce])}function Se(){A.call(this),this.i=new le(this),this.T=this,this.J=null}function De(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.T,r=t.type||t,"string"==typeof t)t=new O(t,e);else if(t instanceof O)t.target=t.target||e;else{var i=t;ue(t=new O(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Te(o,r,!0,t)&&i}if(i=Te(o=t.g=e,r,!0,t)&&i,i=Te(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Te(o=t.g=n[s],r,!1,t)&&i}function Te(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ha&&o.capture==n){var a=o.listener,c=o.oa||o.src;o.ka&&he(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}T(Se,A),Se.prototype[ne]=!0,Se.prototype.removeEventListener=function(e,t,n,r){ve(this,e,t,n,r)},Se.prototype.O=function(){if(Se.Z.O.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)se(n[r]);delete t.g[e],t.h--}}this.J=null},Se.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Se.prototype.R=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ae=y.JSON.stringify;function xe(e,t){this.i=e,this.j=t,this.h=0,this.g=null}function ke(){this.h=this.g=null}function Pe(){var e=je,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}xe.prototype.get=function(){if(0<this.h){this.h--;var e=this.g;this.g=e.next,e.next=null}else e=this.i();return e},ke.prototype.add=function(e,t){var n=Le.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n};var Le=new xe((function(){return new Ne}),(function(e){return e.reset()}));function Ne(){this.next=this.g=this.h=null}function Oe(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Me(e){y.setTimeout((function(){throw e}),0)}Ne.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},Ne.prototype.reset=function(){this.next=this.g=this.h=null};var Re,Fe=!1,je=new ke;function Ve(e,t){Re||function(){var e=y.Promise.resolve(void 0);Re=function(){e.then(Be)}}(),Fe||(Re(),Fe=!0),je.add(e,t)}function Be(){for(var e;e=Pe();){try{e.h.call(e.g)}catch(e){Me(e)}var t=Le;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Fe=!1}function Ue(e,t){Se.call(this),this.h=e||1,this.g=t||y,this.j=S(this.tb,this),this.l=Date.now()}function qe(e){e.ia=!1,e.U&&(e.g.clearTimeout(e.U),e.U=null)}function ze(e,t,n){if("function"==typeof e)n&&(e=S(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=S(e.handleEvent,e)}return 2147483647<Number(t)?-1:y.setTimeout(e,t||0)}function Ge(e,t,n){A.call(this),this.m=null!=n?e.bind(n):e,this.j=t,this.h=null,this.i=!1,this.g=null}if(T(Ue,Se),(t=Ue.prototype).ia=!1,t.U=null,t.tb=function(){if(this.ia){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.U=this.g.setTimeout(this.j,this.h-e):(this.U&&(this.g.clearTimeout(this.U),this.U=null),De(this,"tick"),this.ia&&(qe(this),this.start()))}},t.start=function(){this.ia=!0,this.U||(this.U=this.g.setTimeout(this.j,this.h),this.l=Date.now())},t.O=function(){Ue.Z.O.call(this),qe(this),delete this.g},Ge.prototype=o(A.prototype),Ge.prototype.constructor=Ge,d)d(Ge,A);else for(var $e in A)if("prototype"!=$e)if(Object.defineProperties){var Ke=Object.getOwnPropertyDescriptor(A,$e);Ke&&Object.defineProperty(Ge,$e,Ke)}else Ge[$e]=A[$e];function He(e){e.g=ze((function(){e.g=null,e.i&&(e.i=!1,He(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}function Qe(e){A.call(this),this.h=e,this.g={}}Ge.Z=A.prototype,Ge.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:He(this)},Ge.prototype.O=function(){A.prototype.O.call(this),this.g&&(y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},T(Qe,A);var We=[];function Ye(e,t,n,r){Array.isArray(n)||(n&&(We[0]=n.toString()),n=We);for(var i=0;i<n.length;i++){var s=me(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Xe(e){oe(e.g,(function(e,t){this.g.hasOwnProperty(t)&&we(e)}),e),e.g={}}function Je(){this.g=!0}function Ze(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Ae(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Qe.prototype.O=function(){Qe.Z.O.call(this),Xe(this)},Qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Je.prototype.Ha=function(){this.g=!1},Je.prototype.info=function(){};var et={},tt=null;function nt(){return tt=tt||new Se}function rt(e){O.call(this,et.Wa,e)}function it(e){var t=nt();De(t,new rt(t,e))}function st(e,t){O.call(this,et.STAT_EVENT,e),this.stat=t}function ot(e){var t=nt();De(t,new st(t,e))}function at(e,t){O.call(this,et.Xa,e),this.size=t}function ct(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return y.setTimeout((function(){e()}),t)}et.Wa="serverreachability",T(rt,O),et.STAT_EVENT="statevent",T(st,O),et.Xa="timingevent",T(at,O);var ut={NO_ERROR:0,ub:1,Hb:2,Gb:3,Bb:4,Fb:5,Ib:6,Ta:7,TIMEOUT:8,Lb:9},lt={zb:"complete",Vb:"success",Ua:"error",Ta:"abort",Nb:"ready",Ob:"readystatechange",TIMEOUT:"timeout",Jb:"incrementaldata",Mb:"progress",Cb:"downloadprogress",cc:"uploadprogress"};function ht(){}function dt(e){return e.h||(e.h=e.i())}function pt(){}ht.prototype.h=null;var ft,mt={OPEN:"a",yb:"b",Ua:"c",Kb:"d"};function gt(){O.call(this,"d")}function yt(){O.call(this,"c")}function vt(){}function wt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.Y=r||1,this.W=new Qe(this),this.R=Et,e=K?125:void 0,this.X=new Ue(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.M=this.G=this.aa=this.C=null,this.D=[],this.g=null,this.o=0,this.s=this.v=null,this.ea=-1,this.J=!1,this.P=0,this.N=null,this.da=this.L=this.ca=this.T=!1,this.h=new bt}function bt(){this.i=null,this.g="",this.h=!1}T(gt,O),T(yt,O),T(vt,ht),vt.prototype.g=function(){return new XMLHttpRequest},vt.prototype.i=function(){return{}},ft=new vt;var Et=45e3,_t={},Ct={};function It(e,t,n){e.M=1,e.A=zt(jt(t)),e.u=n,e.T=!0,St(e,null)}function St(e,t){e.G=Date.now(),xt(e),e.B=jt(e.A);var n=e.B,r=e.Y;Array.isArray(r)||(r=[String(r)]),nn(n.i,"t",r),e.o=0,n=e.l.J,e.h=new bt,e.g=ir(e.l,n?t:null,!e.u),0<e.P&&(e.N=new Ge(S(e.Sa,e,e.g),e.P)),Ye(e.W,e.g,"readystatechange",e.qb),t=e.I?ae(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ja(e.B,e.v,e.u,t)):(e.v="GET",e.g.ja(e.B,e.v,null,t)),it(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.v,e.B,e.m,e.Y,e.u)}function Dt(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.l.Ka}function Tt(e,t,n){for(var r,i=!0;!e.J&&e.o<n.length;){if((r=At(e,n))==Ct){4==t&&(e.s=4,ot(14),i=!1),Ze(e.j,e.m,null,"[Incomplete Response]");break}if(r==_t){e.s=4,ot(15),Ze(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ze(e.j,e.m,r,null),Ot(e,r)}Dt(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,ot(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.da&&(e.da=!0,(t=e.l).g==e&&t.ea&&!t.N&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yn(t),t.N=!0,ot(11))):(Ze(e.j,e.m,n,"[Invalid Chunked Response]"),Nt(e),Lt(e))}function At(e,t){var n=e.o,r=t.indexOf("\n",n);return-1==r?Ct:(n=Number(t.substring(n,r)),isNaN(n)?_t:(r+=1)+n>t.length?Ct:(t=t.slice(r,r+n),e.o=r+n,t))}function xt(e){e.aa=Date.now()+e.R,kt(e,e.R)}function kt(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=ct(S(e.ob,e),t)}function Pt(e){e.C&&(y.clearTimeout(e.C),e.C=null)}function Lt(e){0==e.l.H||e.J||Zn(e.l,e)}function Nt(e){Pt(e);var t=e.N;t&&"function"==typeof t.va&&t.va(),e.N=null,qe(e.X),Xe(e.W),e.g&&(t=e.g,e.g=null,t.abort(),t.va())}function Ot(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||hn(n.i,e)))if(!e.L&&hn(n.i,e)&&3==n.H){try{var r=n.Ma.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Jn(n),qn(n)}Wn(n),ot(18)}}else n.Ia=i[1],0<n.Ia-n.X&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=ct(S(n.lb,n),6e3));if(1>=ln(n.i)&&n.ra){try{n.ra()}catch(e){}n.ra=void 0}}else tr(n,11)}else if((e.L||n.g==e)&&Jn(n),!R(t))for(i=n.Ma.g.parse(t),t=0;t<i.length;t++){var s=i[t];if(n.X=s[0],s=s[1],2==n.H)if("c"==s[0]){n.L=s[1],n.sa=s[2];var o=s[3];null!=o&&(n.ua=o,n.l.info("VER="+n.ua));var a=s[4];null!=a&&(n.Ja=a,n.l.info("SVER="+n.Ja));var c=s[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.M=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var u=e.g;if(u){var l=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(dn(h,h.h),h.h=null))}if(r.D){var d=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;d&&(r.Ga=d,qt(r.I,r.D,d))}}n.H=3,n.h&&n.h.Ea(),n.ea&&(n.T=Date.now()-e.G,n.l.info("Handshake RTT: "+n.T+"ms"));var p=e;if((r=n).za=rr(r,r.J?r.sa:null,r.aa),p.L){pn(r.i,p);var f=p,m=r.M;m&&f.setTimeout(m),f.C&&(Pt(f),xt(f)),r.g=p}else Qn(r);0<n.j.length&&Gn(n)}else"stop"!=s[0]&&"close"!=s[0]||tr(n,7);else 3==n.H&&("stop"==s[0]||"close"==s[0]?"stop"==s[0]?tr(n,7):Un(n):"noop"!=s[0]&&n.h&&n.h.Da(s),n.A=0)}it(4)}catch(e){}}function Mt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(v(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.wa&&"function"==typeof e.wa)return e.wa();if(!e.ba||"function"!=typeof e.ba){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(v(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.ba&&"function"==typeof e.ba)return e.ba();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(v(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(t=wt.prototype).setTimeout=function(e){this.R=e},t.qb=function(e){e=e.target;var t=this.N;t&&3==Mn(e)?t.l():this.Sa(e)},t.Sa=function(e){try{if(e==this.g)e:{var t=Mn(this.g),n=this.g.La(),r=this.g.fa();if(!(3>t)&&(3!=t||K||this.g&&(this.h.h||this.g.ma()||Rn(this.g)))){this.J||4!=t||7==n||it(8==n||0>=r?3:2),Pt(this);var i=this.g.fa();this.ea=i;t:if(Dt(this)){var s=Rn(this.g);e="";var o=s.length,a=4==Mn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Nt(this),Lt(this);var c="";break t}this.h.i=new y.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(s[n],{stream:a&&n==o-1});s.length=0,this.h.g+=e,this.o=0,c=this.h.g}else c=this.g.ma();if(this.i=200==i,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.Y,t,i),this.i){if(this.ca&&!this.L){t:{if(this.g){var u,l=this.g;if((u=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(u)){var h=u;break t}}h=null}if(!(i=h)){this.i=!1,this.s=3,ot(12),Nt(this),Lt(this);break e}Ze(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ot(this,i)}this.T?(Tt(this,t,c),K&&this.i&&3==t&&(Ye(this.W,this.X,"tick",this.pb),this.X.start())):(Ze(this.j,this.m,c,null),Ot(this,c)),4==t&&Nt(this),this.i&&!this.J&&(4==t?Zn(this.l,this):(this.i=!1,xt(this)))}else(function(e){var t={};e=(e.g&&2<=Mn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!R(e[n])){var r=Oe(e[n]),i=r[0];if("string"==typeof(r=r[1])){r=r.trim();var s=t[i]||[];t[i]=s,s.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==i&&0<c.indexOf("Unknown SID")?(this.s=3,ot(12)):(this.s=0,ot(13)),Nt(this),Lt(this)}}}catch(e){}},t.pb=function(){if(this.g){var e=Mn(this.g),t=this.g.ma();this.o<t.length&&(Pt(this),Tt(this,e,t),this.i&&4!=e&&xt(this))}},t.cancel=function(){this.J=!0,Nt(this)},t.ob=function(){this.C=null;var e=Date.now();0<=e-this.aa?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.M&&(it(3),ot(17)),Nt(this),this.s=2,Lt(this)):kt(this,this.aa-e)};var Rt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ft(e){var t;this.g=this.s=this.j="",this.o=null,this.m=this.h="",this.l=!1,e instanceof Ft?(this.l=e.l,Vt(this,e.j),this.s=e.s,this.g=e.g,Bt(this,e.o),this.h=e.h,Ut(this,rn(e.i)),this.m=e.m):e&&(t=String(e).match(Rt))?(this.l=!1,Vt(this,t[1]||"",!0),this.s=Gt(t[2]||""),this.g=Gt(t[3]||"",!0),Bt(this,t[4]),this.h=Gt(t[5]||"",!0),Ut(this,t[6]||"",!0),this.m=Gt(t[7]||"")):(this.l=!1,this.i=new Jt(null,this.l))}function jt(e){return new Ft(e)}function Vt(e,t,n){e.j=n?Gt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Bt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.o=t}else e.o=null}function Ut(e,t,n){t instanceof Jt?(e.i=t,function(e,t){t&&!e.j&&(Zt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(en(this,t),nn(this,n,e))}),e)),e.j=t}(e.i,e.l)):(n||(t=$t(t,Yt)),e.i=new Jt(t,e.l))}function qt(e,t,n){e.i.set(t,n)}function zt(e){return qt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Gt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function $t(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Kt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Kt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ft.prototype.toString=function(){var e=[],t=this.j;t&&e.push($t(t,Ht,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push($t(t,Ht,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.o)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push($t(n,"/"==n.charAt(0)?Wt:Qt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",$t(n,Xt)),e.join("")},Ft.prototype.resolve=function(e){var t=jt(this),n=!!e.j;n?Vt(t,e.j):n=!!e.s,n?t.s=e.s:n=!!e.g,n?t.g=e.g:n=null!=e.o;var r=e.h;if(n)Bt(t,e.o);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var s=[],o=0;o<i.length;){var a=i[o++];"."==a?r&&o==i.length&&s.push(""):".."==a?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&o==i.length&&s.push("")):(s.push(a),r=!0)}r=s.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?Ut(t,rn(e.i)):n=!!e.m,n&&(t.m=e.m),t};var Ht=/[#\/\?@]/g,Qt=/[#\?:]/g,Wt=/[#\?]/g,Yt=/[#\?@]/g,Xt=/#/g;function Jt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Zt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function en(e,t){Zt(e),t=sn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function tn(e,t){return Zt(e),t=sn(e,t),e.g.has(t)}function nn(e,t,n){en(e,t),0<n.length&&(e.i=null,e.g.set(sn(e,t),L(n)),e.h+=n.length)}function rn(e){var t=new Jt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function sn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function on(e,t){this.g=e,this.map=t}function an(e){this.l=e||cn,e=y.PerformanceNavigationTiming?0<(e=y.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(y.g&&y.g.Na&&y.g.Na()&&y.g.Na().hc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(t=Jt.prototype).add=function(e,t){Zt(this),this.i=null,e=sn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},t.forEach=function(e,t){Zt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},t.wa=function(){Zt(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},t.ba=function(e){Zt(this);var t=[];if("string"==typeof e)tn(this,e)&&(t=t.concat(this.g.get(sn(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},t.set=function(e,t){return Zt(this),this.i=null,tn(this,e=sn(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&0<(e=this.ba(e)).length?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.ba(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};var cn=10;function un(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ln(e){return e.h?1:e.g?e.g.size:0}function hn(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function dn(e,t){e.g?e.g.add(t):e.h=t}function pn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function fn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){for(var t=e.i,n=(e=i(e.g.values())).next();!n.done;n=e.next())t=t.concat(n.value.D);return t}return L(e.i)}function mn(){}function gn(){this.g=new mn}function yn(e,t,n){var r=n||"";try{Mt(e,(function(e,n){var i=e;w(e)&&(i=Ae(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function vn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function wn(e){this.l=e.ic||null,this.j=e.rb||!1}function bn(e,t){Se.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=En,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}an.prototype.cancel=function(){if(this.i=fn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(var e=i(this.g.values()),t=e.next();!t.done;t=e.next())t.value.cancel();this.g.clear()}},mn.prototype.stringify=function(e){return y.JSON.stringify(e,void 0)},mn.prototype.parse=function(e){return y.JSON.parse(e,void 0)},T(wn,ht),wn.prototype.g=function(){return new bn(this.l,this.j)},wn.prototype.i=function(e){return function(){return e}}({}),T(bn,Se);var En=0;function _n(e){e.j.read().then(e.$a.bind(e)).catch(e.na.bind(e))}function Cn(e){e.readyState=4,e.l=null,e.j=null,e.A=null,In(e)}function In(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(t=bn.prototype).open=function(e,t){if(this.readyState!=En)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,In(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||y).fetch(new Request(this.B,t)).then(this.cb.bind(this),this.na.bind(this))},t.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Cn(this)),this.readyState=En},t.cb=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,In(this)),this.g&&(this.readyState=3,In(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.ab.bind(this),this.na.bind(this));else if(void 0!==y.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;_n(this)}else e.text().then(this.bb.bind(this),this.na.bind(this))},t.$a=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Cn(this):In(this),3==this.readyState&&_n(this)}},t.bb=function(e){this.g&&(this.response=this.responseText=e,Cn(this))},t.ab=function(e){this.g&&(this.response=e,Cn(this))},t.na=function(){this.g&&Cn(this)},t.setRequestHeader=function(e,t){this.v.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(bn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Sn=y.JSON.parse;function Dn(e){Se.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.D=!1,this.B=0,this.A=null,this.L=Tn,this.M=this.N=!1}T(Dn,Se);var Tn="",An=/^https?$/i,xn=["POST","PUT"];function kn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Pn(e),Nn(e)}function Pn(e){e.D||(e.D=!0,De(e,"complete"),De(e,"error"))}function Ln(e){if(e.h&&void 0!==g&&(!e.C[1]||4!=Mn(e)||2!=e.fa()))if(e.v&&4==Mn(e))ze(e.Oa,0,e);else if(De(e,"readystatechange"),4==Mn(e)){e.h=!1;try{var t,n=e.fa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var s=String(e.I).match(Rt)[1]||null;!s&&y.self&&y.self.location&&(s=y.self.location.protocol.slice(0,-1)),i=!An.test(s?s.toLowerCase():"")}t=i}if(t)De(e,"complete"),De(e,"success");else{e.m=6;try{var o=2<Mn(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.fa()+"]",Pn(e)}}finally{Nn(e)}}}function Nn(e,t){if(e.g){On(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||De(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function On(e){e.g&&e.M&&(e.g.ontimeout=null),e.A&&(y.clearTimeout(e.A),e.A=null)}function Mn(e){return e.g?e.g.readyState:0}function Rn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.L){case Tn:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Fn(e){var t="";return oe(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function jn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Fn(n),"string"==typeof e?(encodeURIComponent(String(t)),null!=n&&encodeURIComponent(String(n))):qt(e,t,n))}function Vn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Bn(e){this.Ja=0,this.j=[],this.l=new Je,this.sa=this.za=this.I=this.aa=this.g=this.Ga=this.D=this.qa=this.o=this.W=this.s=null,this.ib=this.Y=0,this.gb=Vn("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.ca=!0,this.Ia=this.X=-1,this.da=this.A=this.C=0,this.eb=Vn("baseRetryDelayMs",5e3,e),this.kb=Vn("retryDelaySeedMs",1e4,e),this.hb=Vn("forwardChannelMaxRetries",2,e),this.Aa=Vn("forwardChannelRequestTimeoutMs",2e4,e),this.ya=e&&e.xmlHttpFactory||void 0,this.Ka=e&&e.useFetchStreams||!1,this.M=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.L="",this.i=new an(e&&e.concurrentRequestLimit),this.Ma=new gn,this.R=e&&e.fastHandshake||!1,this.P=e&&e.encodeInitMessageHeaders||!1,this.R&&this.P&&(this.P=!1),this.fb=e&&e.ec||!1,e&&e.Ha&&this.l.Ha(),e&&e.forceLongPolling&&(this.ca=!1),this.ea=!this.R&&this.ca&&e&&e.detectBufferingProxy||!1,this.ta=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ta=e.longPollingTimeout),this.ra=void 0,this.T=0,this.N=!1,this.pa=this.B=null}function Un(e){if(zn(e),3==e.H){var t=e.Y++,n=jt(e.I);if(qt(n,"SID",e.L),qt(n,"RID",t),qt(n,"TYPE","terminate"),Kn(e,n),(t=new wt(e,e.l,t)).M=2,t.A=zt(jt(n)),n=!1,y.navigator&&y.navigator.sendBeacon)try{n=y.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&y.Image&&((new Image).src=t.A,n=!0),n||(t.g=ir(t.l,null),t.g.ja(t.A)),t.G=Date.now(),xt(t)}nr(e)}function qn(e){e.g&&(Yn(e),e.g.cancel(),e.g=null)}function zn(e){qn(e),e.u&&(y.clearTimeout(e.u),e.u=null),Jn(e),e.i.cancel(),e.m&&("number"==typeof e.m&&y.clearTimeout(e.m),e.m=null)}function Gn(e){un(e.i)||e.m||(e.m=!0,Ve(e.Qa,e),e.C=0)}function $n(e,t){var n;n=t?t.m:e.Y++;var r=jt(e.I);qt(r,"SID",e.L),qt(r,"RID",n),qt(r,"AID",e.X),Kn(e,r),e.o&&e.s&&jn(r,e.o,e.s),n=new wt(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.D.concat(e.j)),t=Hn(e,n,1e3),n.setTimeout(Math.round(.5*e.Aa)+Math.round(.5*e.Aa*Math.random())),dn(e.i,n),It(n,r,t)}function Kn(e,t){e.qa&&oe(e.qa,(function(e,n){qt(t,n,e)})),e.h&&Mt({},(function(e,n){qt(t,n,e)}))}function Hn(e,t,n){n=Math.min(e.j.length,n);var r=e.h?S(e.h.Ya,e.h,e):null;e:for(var i=e.j,s=-1;;){var o=["count="+n];-1==s?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);for(var a=!0,c=0;c<n;c++){var u=i[c].g,l=i[c].map;if(0>(u-=s))s=Math.max(0,i[c].g-100),a=!1;else try{yn(l,o,"req"+u+"_")}catch(e){r&&r(l)}}if(a){r=o.join("&");break e}}return e=e.j.splice(0,n),t.D=e,r}function Qn(e){e.g||e.u||(e.da=1,Ve(e.Pa,e),e.A=0)}function Wn(e){return!(e.g||e.u||3<=e.A||(e.da++,e.u=ct(S(e.Pa,e),er(e,e.A)),e.A++,0))}function Yn(e){null!=e.B&&(y.clearTimeout(e.B),e.B=null)}function Xn(e){e.g=new wt(e,e.l,"rpc",e.da),null===e.o&&(e.g.I=e.s),e.g.P=0;var t=jt(e.za);qt(t,"RID","rpc"),qt(t,"SID",e.L),qt(t,"AID",e.X),qt(t,"CI",e.G?"0":"1"),!e.G&&e.ta&&qt(t,"TO",e.ta),qt(t,"TYPE","xmlhttp"),Kn(e,t),e.o&&e.s&&jn(t,e.o,e.s),e.M&&e.g.setTimeout(e.M);var n=e.g;e=e.sa,n.M=1,n.A=zt(jt(t)),n.u=null,n.T=!0,St(n,e)}function Jn(e){null!=e.v&&(y.clearTimeout(e.v),e.v=null)}function Zn(e,t){var n=null;if(e.g==t){Jn(e),Yn(e),e.g=null;var r=2}else{if(!hn(e.i,t))return;n=t.D,pn(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.G;var i=e.C;De(r=nt(),new at(r,n,t,i)),Gn(e)}else Qn(e);else if(3==(i=t.s)||0==i&&0<t.ea||!(1==r&&function(e,t){return!(ln(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.D.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.gb?0:e.hb)||(e.m=ct(S(e.Qa,e,t),er(e,e.C)),e.C++,0)))}(e,t)||2==r&&Wn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:tr(e,5);break;case 4:tr(e,10);break;case 3:tr(e,6);break;default:tr(e,2)}}function er(e,t){var n=e.eb+Math.floor(Math.random()*e.kb);return e.isActive()||(n*=2),n*t}function tr(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=S(e.sb,e);n||(n=new Ft("//www.google.com/images/cleardot.gif"),y.location&&"http"==y.location.protocol||Vt(n,"https"),zt(n)),function(e,t){var n=new Je;if(y.Image){var r=new Image;r.onload=D(vn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=D(vn,n,r,"TestLoadImage: error",!1,t),r.onabort=D(vn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=D(vn,n,r,"TestLoadImage: timeout",!1,t),y.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else ot(2);e.H=0,e.h&&e.h.Ca(t),nr(e),zn(e)}function nr(e){if(e.H=0,e.pa=[],e.h){var t=fn(e.i);0==t.length&&0==e.j.length||(N(e.pa,t),N(e.pa,e.j),e.i.i.length=0,L(e.j),e.j.length=0),e.h.Ba()}}function rr(e,t,n){var r=n instanceof Ft?jt(n):new Ft(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Bt(r,r.o);else{var i=y.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Ft(null);r&&Vt(s,r),t&&(s.g=t),i&&Bt(s,i),n&&(s.h=n),r=s}return n=e.D,t=e.Ga,n&&t&&qt(r,n,t),qt(r,"VER",e.ua),Kn(e,r),r}function ir(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ka&&!e.ya?new Dn(new wn({rb:n})):new Dn(e.ya)).Ra(e.J),t}function sr(){}function or(){if(G&&!(10<=Number(Z)))throw Error("Environmental error: no available transport.")}function ar(e,t){Se.call(this),this.g=new Bn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Fa&&(e?e["X-WebChannel-Client-Profile"]=t.Fa:e={"X-WebChannel-Client-Profile":t.Fa}),this.g.W=e,(e=t&&t.fc)&&!R(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!R(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new lr(this)}function cr(e){gt.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ur(){yt.call(this),this.status=1}function lr(e){this.g=e}function hr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function dr(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function pr(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(t=Dn.prototype).Ra=function(e){this.N=e},t.ja=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ft.g(),this.C=this.u?dt(this.u):dt(ft),this.g.onreadystatechange=S(this.Oa,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void kn(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(var o=(s=i(r.keys())).next();!o.done;o=s.next())o=o.value,n.set(o,r.get(o))}for(r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),s=y.FormData&&e instanceof y.FormData,!(0<=P(xn,t))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r=(t=i(n)).next();!r.done;r=t.next())r=(n=i(r.value)).next().value,n=n.next().value,this.g.setRequestHeader(r,n);this.L&&(this.g.responseType=this.L),"withCredentials"in this.g&&this.g.withCredentials!==this.N&&(this.g.withCredentials=this.N);try{On(this),0<this.B&&((this.M=function(e){return G&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=S(this.xa,this)):this.A=ze(this.xa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){kn(this,e)}},t.xa=function(){void 0!==g&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,De(this,"timeout"),this.abort(8))},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,De(this,"complete"),De(this,"abort"),Nn(this))},t.O=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Nn(this,!0)),Dn.Z.O.call(this)},t.Oa=function(){this.s||(this.G||this.v||this.l?Ln(this):this.nb())},t.nb=function(){Ln(this)},t.isActive=function(){return!!this.g},t.fa=function(){try{return 2<Mn(this)?this.g.status:-1}catch(e){return-1}},t.ma=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},t.Za=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Sn(t)}},t.La=function(){return this.m},t.Va=function(){return"string"==typeof this.j?this.j:String(this.j)},(t=Bn.prototype).ua=8,t.H=1,t.Qa=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.Y=Math.floor(1e5*Math.random()),e=this.Y++;var t,n=new wt(this,this.l,e),r=this.s;if(this.W&&(r?ue(r=ae(r),this.W):r=this.W),null!==this.o||this.P||(n.I=r,r=null),this.R)e:{for(var i=t=0;i<this.j.length;i++){var s=this.j[i];if(void 0===(s="__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s.length:void 0))break;if(4096<(t+=s)){t=i;break e}if(4096===t||i===this.j.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=Hn(this,n,t),qt(i=jt(this.I),"RID",e),qt(i,"CVER",22),this.D&&qt(i,"X-HTTP-Session-Id",this.D),Kn(this,i),r&&(this.P?t="headers="+encodeURIComponent(String(Fn(r)))+"&"+t:this.o&&jn(i,this.o,r)),dn(this.i,n),this.fb&&qt(i,"TYPE","init"),this.R?(qt(i,"$req",t),qt(i,"SID","null"),n.ca=!0,It(n,i,null)):It(n,i,t),this.H=2}}else 3==this.H&&(e?$n(this,e):0==this.j.length||un(this.i)||$n(this))},t.Pa=function(){if(this.u=null,Xn(this),this.ea&&!(this.N||null==this.g||0>=this.T)){var e=2*this.T;this.l.info("BP detection timer enabled: "+e),this.B=ct(S(this.mb,this),e)}},t.mb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.N=!0,ot(10),qn(this),Xn(this))},t.lb=function(){null!=this.v&&(this.v=null,qn(this),Wn(this),ot(19))},t.sb=function(e){e?(this.l.info("Successfully pinged google.com"),ot(2)):(this.l.info("Failed to ping google.com"),ot(1))},t.isActive=function(){return!!this.h&&this.h.isActive(this)},(t=sr.prototype).Ea=function(){},t.Da=function(){},t.Ca=function(){},t.Ba=function(){},t.isActive=function(){return!0},t.Ya=function(){},or.prototype.g=function(e,t){return new ar(e,t)},T(ar,Se),ar.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;ot(0),e.aa=t,e.qa=n||{},e.G=e.ca,e.I=rr(e,null,e.aa),Gn(e)},ar.prototype.close=function(){Un(this.g)},ar.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Ae(e),e=n);t.j.push(new on(t.ib++,e)),3==t.H&&Gn(t)},ar.prototype.O=function(){this.g.h=null,delete this.j,Un(this.g),delete this.g,ar.Z.O.call(this)},T(cr,gt),T(ur,yt),T(lr,sr),lr.prototype.Ea=function(){De(this.g,"a")},lr.prototype.Da=function(e){De(this.g,new cr(e))},lr.prototype.Ca=function(e){De(this.g,new ur(e))},lr.prototype.Ba=function(){De(this.g,"b")},T(hr,(function(){this.blockSize=-1})),hr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},hr.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)dr(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){dr(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){dr(this,r),i=0;break}}this.h=i,this.i+=t},hr.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var fr={};function mr(e){return-128<=e&&128>e?function(e,t){var n=fr;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=function(e){return new pr([0|e],0>e?-1:0)}(e)}(e):new pr([0|e],0>e?-1:0)}function gr(e){if(isNaN(e)||!isFinite(e))return vr;if(0>e)return Cr(gr(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=yr;return new pr(t,0)}var yr=4294967296,vr=mr(0),wr=mr(1),br=mr(16777216);function Er(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function _r(e){return-1==e.h}function Cr(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new pr(n,~e.h).add(wr)}function Ir(e,t){return e.add(Cr(t))}function Sr(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Dr(e,t){this.g=e,this.h=t}function Tr(e,t){if(Er(t))throw Error("division by zero");if(Er(e))return new Dr(vr,vr);if(_r(e))return t=Tr(Cr(e),t),new Dr(Cr(t.g),Cr(t.h));if(_r(t))return t=Tr(e,Cr(t)),new Dr(Cr(t.g),t.h);if(30<e.g.length){if(_r(e)||_r(t))throw Error("slowDivide_ only works with positive integers.");for(var n=wr,r=t;0>=r.$(e);)n=Ar(n),r=Ar(r);var i=xr(n,1),s=xr(r,1);for(r=xr(r,2),n=xr(n,2);!Er(r);){var o=s.add(r);0>=o.$(e)&&(i=i.add(n),s=o),r=xr(r,1),n=xr(n,1)}return t=Ir(e,i.S(t)),new Dr(i,t)}for(i=vr;0<=e.$(t);){for(n=Math.max(1,Math.floor(e.ga()/t.ga())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=gr(n)).S(t);_r(o)||0<o.$(e);)o=(s=gr(n-=r)).S(t);Er(s)&&(s=wr),i=i.add(s),e=Ir(e,o)}return new Dr(i,e)}function Ar(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.F(r)<<1|e.F(r-1)>>>31;return new pr(n,e.h)}function xr(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.F(s+n)>>>t|e.F(s+n+1)<<32-t:e.F(s+n);return new pr(i,e.h)}(t=pr.prototype).ga=function(){if(_r(this))return-Cr(this).ga();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.F(n);e+=(0<=r?r:yr+r)*t,t*=yr}return e},t.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Er(this))return"0";if(_r(this))return"-"+Cr(this).toString(e);for(var t=gr(Math.pow(e,6)),n=this,r="";;){var i=Tr(n,t).g,s=((0<(n=Ir(n,i.S(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Er(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},t.F=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},t.$=function(e){return _r(e=Ir(this,e))?-1:Er(e)?0:1},t.abs=function(){return _r(this)?Cr(this):this},t.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.F(i))+(65535&e.F(i)),o=(s>>>16)+(this.F(i)>>>16)+(e.F(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new pr(n,-2147483648&n[n.length-1]?-1:0)},t.S=function(e){if(Er(this)||Er(e))return vr;if(_r(this))return _r(e)?Cr(this).S(Cr(e)):Cr(Cr(this).S(e));if(_r(e))return Cr(this.S(Cr(e)));if(0>this.$(br)&&0>e.$(br))return gr(this.ga()*e.ga());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.F(r)>>>16,o=65535&this.F(r),a=e.F(i)>>>16,c=65535&e.F(i);n[2*r+2*i]+=o*c,Sr(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Sr(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Sr(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Sr(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new pr(n,0)},t.jb=function(e){return Tr(this,e).h},t.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)&e.F(r);return new pr(n,this.h&e.h)},t.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)|e.F(r);return new pr(n,this.h|e.h)},t.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)^e.F(r);return new pr(n,this.h^e.h)},or.prototype.createWebChannel=or.prototype.g,ar.prototype.send=ar.prototype.u,ar.prototype.open=ar.prototype.m,ar.prototype.close=ar.prototype.close,ut.NO_ERROR=0,ut.TIMEOUT=8,ut.HTTP_ERROR=6,lt.COMPLETE="complete",pt.EventType=mt,mt.OPEN="a",mt.CLOSE="b",mt.ERROR="c",mt.MESSAGE="d",Se.prototype.listen=Se.prototype.P,Dn.prototype.listenOnce=Dn.prototype.R,Dn.prototype.getLastError=Dn.prototype.Va,Dn.prototype.getLastErrorCode=Dn.prototype.La,Dn.prototype.getStatus=Dn.prototype.fa,Dn.prototype.getResponseJson=Dn.prototype.Za,Dn.prototype.getResponseText=Dn.prototype.ma,Dn.prototype.send=Dn.prototype.ja,Dn.prototype.setWithCredentials=Dn.prototype.Ra,hr.prototype.digest=hr.prototype.l,hr.prototype.reset=hr.prototype.reset,hr.prototype.update=hr.prototype.j,pr.prototype.add=pr.prototype.add,pr.prototype.multiply=pr.prototype.S,pr.prototype.modulo=pr.prototype.jb,pr.prototype.compare=pr.prototype.$,pr.prototype.toNumber=pr.prototype.ga,pr.prototype.toString=pr.prototype.toString,pr.prototype.getBits=pr.prototype.F,pr.fromNumber=gr,pr.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Cr(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=gr(Math.pow(n,8)),i=vr,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=gr(Math.pow(n,o)),i=i.S(o).add(gr(a))):i=(i=i.S(r)).add(gr(a))}return i},e.exports.createWebChannelTransport=function(){return new or},e.exports.getStatEventTarget=function(){return nt()},e.exports.ErrorCode=ut,e.exports.EventType=lt,e.exports.Event=et,e.exports.Stat={Ab:0,Db:1,Eb:2,Xb:3,bc:4,Zb:5,$b:6,Yb:7,Wb:8,ac:9,PROXY:10,NOPROXY:11,Ub:12,Qb:13,Rb:14,Pb:15,Sb:16,Tb:17,wb:18,vb:19,xb:20},e.exports.FetchXmlHttpFactory=wn,e.exports.WebChannel=pt,e.exports.XhrIo=Dn,e.exports.Md5=hr,e.exports.Integer=pr}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},923:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(752);r.registerVersion("firebase","10.7.0","app"),Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},867:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23);Object.keys(r).forEach((function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}))},4153:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataGeneral=void 0,t.dataGeneral={recommended:[{img:"/src/resources/jpg/platesRecommended.jpg",title:"Plates",price:"Cop $23500",description:"Set of 2 ceramics plates"},{img:"https://http2.mlstatic.com/D_NQ_NP_2X_605638-MCO54127766904_032023-F.webp",title:"Harina De Maz",price:"Cop $18000",description:"Harina de Maz Harina PAN Blanca 1kg x3 Uds"},{img:"https://http2.mlstatic.com/D_NQ_NP_2X_816444-MCO70237320929_062023-F.webp",title:"Maquina De Afeitar Groomen 500 + 1 Repuesto",price:"Cop $33900",description:"Mquina de afeitar con 5 navajas de alta precisin"},{img:"https://http2.mlstatic.com/D_NQ_NP_2X_699538-MCO69510888045_052023-F.webp",title:"Silla Ejecutiva Ergonmica",price:"Cop $179900",description:"Silla Ejecutiva Ergonmica Reclinable Con Espaldar Grande"},{img:"https://http2.mlstatic.com/D_NQ_NP_2X_795428-MCO53300738016_012023-F.webp",title:"Maletero Tomcat 34lt Litros",price:"COP $99500",description:"El maletero Tomcat de 34 litros te permite recorrer la ciudad sin preocuparte por el equipaje"},{img:"https://http2.mlstatic.com/D_NQ_NP_2X_933606-MLA53057320829_122022-F.webp",title:"Set de construccin Lego Minecraft La Emboscada del Creeper",price:"COP $79900",description:"El set Lego Minecraft te permitir construir e interpretar aventuras inspiradas en el universo Minecraft"},{img:"https://www.chocolatecorona.com/sites/default/files/2022-12/chips_5.png",title:"Cookie dough Corona",price:"Cop $23500",description:"Make delicious desserts, cookies, milkshakes or make decorations with our Corona chocolate chips. They are delicious and very easy to use."},{img:"https://m.media-amazon.com/images/I/61RVXohcPXL._AC_SX679_.jpg",title:"Quest Dipped and Mini Bundle, chocolate chip cookie dough",price:"Cop $33700",description:"Quest Dipped Chocolate Cookie Dough Protein Bar tastes like a spoonful of cookie dough fresh from the bowl. Only our version is packed with chocolate-flavored chips, then dipped and topped with chocolate drizzle, and has 18g of protein, 4g of net carbs, and 1g of sugar per serving."},{img:"https://encrypted-tbn2.gstatic.com/shopping?q=tbn:ANd9GcQ-V2wcY6dM--lAlqgjiZuUojd4nKz8qZlQGkk-n08eeVTWJFd1Ge45-AGQ4DlpyzKpP2JXi7UHWE5HBDCC_mo3en9jMpH7&usqp=CAY",title:"Orso Ice Cream Caramel Cookie Dough Flavor",price:"Cop $26000",description:"A dessert after lunch is always a good idea. Orso ice cream caramel cookie dough"}],search:[{img:"https://www.chocolatecorona.com/sites/default/files/2022-12/chips_5.png",title:"Cookie dough Corona",price:"Cop $23500",description:"Make delicious desserts, cookies, milkshakes or make decorations with our Corona chocolate chips. They are delicious and very easy to use."},{img:"https://m.media-amazon.com/images/I/61RVXohcPXL._AC_SX679_.jpg",title:"Quest Dipped and Mini Bundle, chocolate chip cookie dough",price:"Cop $33700",description:"Quest Dipped Chocolate Cookie Dough Protein Bar tastes like a spoonful of cookie dough fresh from the bowl. Only our version is packed with chocolate-flavored chips, then dipped and topped with chocolate drizzle, and has 18g of protein, 4g of net carbs, and 1g of sugar per serving."},{img:"https://encrypted-tbn2.gstatic.com/shopping?q=tbn:ANd9GcQ-V2wcY6dM--lAlqgjiZuUojd4nKz8qZlQGkk-n08eeVTWJFd1Ge45-AGQ4DlpyzKpP2JXi7UHWE5HBDCC_mo3en9jMpH7&usqp=CAY",title:"Orso Ice Cream Caramel Cookie Dough Flavor",price:"Cop $26000",description:"A dessert after lunch is always a good idea. Orso ice cream caramel cookie dough"}]}},3945:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paymentSummary=t.paymentPage=t.shoopinListCard=t.purchaseSummaryCartList=t.shoopingListPage=t.uploadProductPage=t.userInfoRest=t.userInfoTitle=t.userInformationPage=t.PurchaseSummary=t.ShopingListCard=t.ShopingList=t.ProductDetailComments=t.ProductDetailCard=t.ProductDetail=t.searchResultsCard=t.SearchOption=t.optionsInformation=t.SearchPage=t.forgotPasswordMenu=t.forgotPasswordPage=t.CustomInput=t.loginregister=t.loginPage=t.SignUpInput=t.SignUpMenu=t.SignUp=t.sideMenu=t.NavBarWhite=t.NavBarRed=t.NavBarEmpty=t.NavBarLanding=t.NavSearchBarWhite=t.NavSearchBarRed=t.NavIconButton=t.NavBar=t.LandingFooter=t.MoreInfoSectiontwo=t.MoreInfoSection=t.DescriptionSection=t.LandingPage=t.SalesCard=t.salesSection=t.recommendedSectionCard=t.RecommendedSection=t.newsSection=t.categoriesButton=t.CategoriesSection=t.MainPage=t.directorioExport=void 0,t.myProductCard=t.myProductsSearch=t.myProductsTotalProducts=t.myProductsPage=t.paymentMenu=void 0,t.directorioExport=()=>{};var r=n(9199);Object.defineProperty(t,"MainPage",{enumerable:!0,get:function(){return r.MainPage}});var i=n(3683);Object.defineProperty(t,"CategoriesSection",{enumerable:!0,get:function(){return i.CategoriesSection}});var s=n(148);Object.defineProperty(t,"categoriesButton",{enumerable:!0,get:function(){return s.categoriesButton}});var o=n(6414);Object.defineProperty(t,"newsSection",{enumerable:!0,get:function(){return o.newsSection}});var a=n(8579);Object.defineProperty(t,"RecommendedSection",{enumerable:!0,get:function(){return a.RecommendedSection}});var c=n(7170);Object.defineProperty(t,"recommendedSectionCard",{enumerable:!0,get:function(){return c.recommendedSectionCard}});var u=n(1532);Object.defineProperty(t,"salesSection",{enumerable:!0,get:function(){return u.salesSection}});var l=n(3498);Object.defineProperty(t,"SalesCard",{enumerable:!0,get:function(){return l.SalesCard}});var h=n(7359);Object.defineProperty(t,"LandingPage",{enumerable:!0,get:function(){return h.LandingPage}});var d=n(9825);Object.defineProperty(t,"DescriptionSection",{enumerable:!0,get:function(){return d.DescriptionSection}});var p=n(9276);Object.defineProperty(t,"MoreInfoSection",{enumerable:!0,get:function(){return p.MoreInfoSection}});var f=n(3876);Object.defineProperty(t,"MoreInfoSectiontwo",{enumerable:!0,get:function(){return f.MoreInfoSectiontwo}});var m=n(3439);Object.defineProperty(t,"LandingFooter",{enumerable:!0,get:function(){return m.LandingFooter}});var g=n(6122);Object.defineProperty(t,"NavBar",{enumerable:!0,get:function(){return g.NavBar}});var y=n(8545);Object.defineProperty(t,"NavIconButton",{enumerable:!0,get:function(){return y.NavIconButton}});var v=n(3157);Object.defineProperty(t,"NavSearchBarRed",{enumerable:!0,get:function(){return v.NavSearchBarRed}});var w=n(4983);Object.defineProperty(t,"NavSearchBarWhite",{enumerable:!0,get:function(){return w.NavSearchBarWhite}});var b=n(6100);Object.defineProperty(t,"NavBarLanding",{enumerable:!0,get:function(){return b.NavBarLanding}});var E=n(3277);Object.defineProperty(t,"NavBarEmpty",{enumerable:!0,get:function(){return E.NavBarEmpty}});var _=n(6164);Object.defineProperty(t,"NavBarRed",{enumerable:!0,get:function(){return _.NavBarRed}});var C=n(2566);Object.defineProperty(t,"NavBarWhite",{enumerable:!0,get:function(){return C.NavBarWhite}});var I=n(9767);Object.defineProperty(t,"sideMenu",{enumerable:!0,get:function(){return I.sideMenu}});var S=n(6352);Object.defineProperty(t,"SignUp",{enumerable:!0,get:function(){return S.SignUp}});var D=n(4439);Object.defineProperty(t,"SignUpMenu",{enumerable:!0,get:function(){return D.SignUpMenu}});var T=n(6873);Object.defineProperty(t,"SignUpInput",{enumerable:!0,get:function(){return T.SignUpInput}});var A=n(5442);Object.defineProperty(t,"loginPage",{enumerable:!0,get:function(){return A.loginPage}});var x=n(4250);Object.defineProperty(t,"loginregister",{enumerable:!0,get:function(){return x.loginregister}});var k=n(6427);Object.defineProperty(t,"CustomInput",{enumerable:!0,get:function(){return k.CustomInput}});var P=n(4759);Object.defineProperty(t,"forgotPasswordPage",{enumerable:!0,get:function(){return P.forgotPasswordPage}});var L=n(8550);Object.defineProperty(t,"forgotPasswordMenu",{enumerable:!0,get:function(){return L.forgotPasswordMenu}});var N=n(1011);Object.defineProperty(t,"SearchPage",{enumerable:!0,get:function(){return N.SearchPage}});var O=n(2631);Object.defineProperty(t,"optionsInformation",{enumerable:!0,get:function(){return O.optionsInformation}});var M=n(7324);Object.defineProperty(t,"SearchOption",{enumerable:!0,get:function(){return M.SearchOption}});var R=n(4066);Object.defineProperty(t,"searchResultsCard",{enumerable:!0,get:function(){return R.searchResultsCard}});var F=n(9496);Object.defineProperty(t,"ProductDetail",{enumerable:!0,get:function(){return F.ProductDetail}});var j=n(3386);Object.defineProperty(t,"ProductDetailCard",{enumerable:!0,get:function(){return j.ProductDetailCard}});var V=n(4014);Object.defineProperty(t,"ProductDetailComments",{enumerable:!0,get:function(){return V.ProductDetailComments}});var B=n(7470);Object.defineProperty(t,"ShopingList",{enumerable:!0,get:function(){return B.ShopingList}});var U=n(1090);Object.defineProperty(t,"ShopingListCard",{enumerable:!0,get:function(){return U.ShopingListCard}});var q=n(1505);Object.defineProperty(t,"PurchaseSummary",{enumerable:!0,get:function(){return q.PurchaseSummary}});var z=n(4197);Object.defineProperty(t,"userInformationPage",{enumerable:!0,get:function(){return z.userInformationPage}});var G=n(7504);Object.defineProperty(t,"userInfoTitle",{enumerable:!0,get:function(){return G.userInfoTitle}});var $=n(965);Object.defineProperty(t,"userInfoRest",{enumerable:!0,get:function(){return $.userInfoRest}});var K=n(451);Object.defineProperty(t,"uploadProductPage",{enumerable:!0,get:function(){return K.uploadProductPage}});var H=n(496);Object.defineProperty(t,"shoopingListPage",{enumerable:!0,get:function(){return H.shoopingListPage}});var Q=n(507);Object.defineProperty(t,"purchaseSummaryCartList",{enumerable:!0,get:function(){return Q.purchaseSummaryCartList}});var W=n(7933);Object.defineProperty(t,"shoopinListCard",{enumerable:!0,get:function(){return W.shoopinListCard}});var Y=n(1929);Object.defineProperty(t,"paymentPage",{enumerable:!0,get:function(){return Y.paymentPage}});var X=n(9081);Object.defineProperty(t,"paymentSummary",{enumerable:!0,get:function(){return X.paymentSummary}});var J=n(5865);Object.defineProperty(t,"paymentMenu",{enumerable:!0,get:function(){return J.paymentMenu}});var Z=n(5294);Object.defineProperty(t,"myProductsPage",{enumerable:!0,get:function(){return Z.myProductsPage}});var ee=n(9558);Object.defineProperty(t,"myProductsTotalProducts",{enumerable:!0,get:function(){return ee.myProductsTotalProducts}});var te=n(7567);Object.defineProperty(t,"myProductsSearch",{enumerable:!0,get:function(){return te.myProductsSearch}});var ne=n(1164);Object.defineProperty(t,"myProductCard",{enumerable:!0,get:function(){return ne.myProductCard}})},8550:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forgotPasswordMenu=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/forgotPassword/forgotPasswordMenu/forgotPasswordMenu.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","menuForgotPasswordContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("h1");n.innerText="Forgot your password",t.appendChild(n);const r=this.ownerDocument.createElement("p");r.innerText="Enter the code that we send you to your email example@gmail.com to recover your password...",t.appendChild(r);const i=this.ownerDocument.createElement("signup-input");i.setAttribute("placeholder","Insert code"),t.appendChild(i);const s=this.ownerDocument.createElement("signup-input");s.setAttribute("icon","/src/resources/svg/Icons/Lock.svg"),s.setAttribute("placeholder","New password"),t.appendChild(s);const o=this.ownerDocument.createElement("signup-input");o.setAttribute("icon","/src/resources/svg/Icons/Lock.svg"),o.setAttribute("placeholder","Confirm new password"),t.appendChild(o);const a=this.ownerDocument.createElement("button");a.innerText="CHANGE PASSWORD",t.appendChild(a)}}}t.forgotPasswordMenu=r,customElements.define("forgotpassword-menu",r)},9825:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DescriptionSection=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/landingPage/descriptionSection/descriptionSection.css"),this.shadowRoot.innerHTML='\n                <div class="description-container">\n                    <div class="description-content">\n                        <h1>Your new market page!</h1>\n                        <p>A place where you can buy everything you need with that close feeling of neighborhood.</p>\n                        <div class="action-buttons">\n                            <button id="shop">Go to store!</button>\n                            <button id="create-account">Create free account</button>\n                        </div>\n                    </div>\n\n                    <img src="/src/resources/jpg/mujerBolsas.png"> \n                </div>\n            ',this.shadowRoot.querySelector("#shop").addEventListener("click",(()=>{console.log("Ir a la tienda")})),this.shadowRoot.querySelector("#create-account").addEventListener("click",(()=>{console.log("Crear cuenta")})),this.shadowRoot.appendChild(e)}}}t.DescriptionSection=r,customElements.define("description-section",r)},3439:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LandingFooter=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/landingPage/landingFooter/landingFotter.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.classList.add("footer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("img");n.setAttribute("src","/src/resources/svg/logo_light_new.svg"),t.appendChild(n)}}}t.LandingFooter=r,customElements.define("landing-footer",r)},9276:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MoreInfoSection=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/landingPage/moreInfoSection/moreInfoSection.css"),this.shadowRoot.innerHTML='\n                <div class="more-info-container">\n                <img src="/src/resources/jpg/chicaRubia.png" />\n                    <div class="more-info-content">\n                        <h1>A close feeling!</h1>\n                        <p>The strong feeling of control and closeness of yout city in the comoddity of yout house. Take the trends of your shopping with a transparent advertaiment of products and clean sellers.</p> \n                        <button id="read-more">Know more...</button>\n                    </div>\n                </div>\n            ';const t=this.shadowRoot.querySelector("#read-more");t?t.addEventListener("click",(()=>{console.log("Leer ms")})):console.error('El botn "Leer ms" no se encontr'),this.shadowRoot.appendChild(e)}}}t.MoreInfoSection=r,customElements.define("more-infosection",r)},3876:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MoreInfoSectiontwo=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/landingPage/moreInfoSectiontwo/moreInfoSectiontwo.css"),this.shadowRoot.innerHTML='\n                <div class="more-info-containertwo">\n                    <div class="more-info-content">\n                        <h2>Brand new things for your home!</h2>\n                        <p>Find everything you would need for the commodities of your place. Buy all sort of furniture and decorations to make your house feel like yours.</p>\n                    </div>\n                    <img src="/src/resources/jpg/sillonComodo.png" />\n                </div>\n            ',this.shadowRoot.appendChild(e)}}}t.MoreInfoSectiontwo=r,customElements.define("more-infosectiontwo",r)},6427:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomInput=void 0,n(3945);class r extends HTMLElement{static get observedAttributes(){return Object.keys({icon:null,placeholder:null})}constructor(){super(),this.properties={icon:"",placeholder:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"icon":this.properties.icon=n;break;case"placeholder":this.properties.placeholder=n}}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/loginRe/input/input.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("div");r.classList.add("input-container"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);const i=this.ownerDocument.createElement("img");i.setAttribute("src",`${this.properties.icon}`),r.appendChild(i);const s=this.ownerDocument.createElement("input");s.setAttribute("type","text"),s.setAttribute("placeholder",`${this.properties.placeholder}`),r.appendChild(s)}}t.CustomInput=r,customElements.define("custom-input",r)},4250:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loginregister=void 0;const r=n(181),i=n(632);n(3945);class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/loginRe/loginRe.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","MarketHubLogin"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("div");n.classList.add("central-box"),t.appendChild(n);const s=this.ownerDocument.createElement("h1");s.textContent="MarketHub",n.appendChild(s);const o=this.ownerDocument.createElement("h2");o.textContent="Enter the market",n.appendChild(o);const a=this.ownerDocument.createElement("signup-input");a.setAttribute("placeholder","Enter your email"),a.setAttribute("icon","/src/resources/svg/Icons/Email.svg"),n.appendChild(a);const c=this.ownerDocument.createElement("signup-input");c.setAttribute("placeholder","Enter your password"),c.setAttribute("icon","/src/resources/svg/Icons/Lock.svg"),n.appendChild(c);const u=this.ownerDocument.createElement("button");u.textContent="LOG IN",n.appendChild(u);const l=this.ownerDocument.createElement("a");l.textContent="Forgot your password?",l.setAttribute("href","#"),l.classList.add("forgot-password"),n.appendChild(l);const h=this.ownerDocument.createElement("a");h.classList.add("sign-up-link"),h.textContent="Dont have an account? Create one",h.setAttribute("href","#"),t.appendChild(h),u.addEventListener("click",(()=>{console.log("User button"),r.dataUsers.forEach((e=>{if(console.log(`Usuario: ${e.name}`),i.loginData.email===e.email)return console.log(`Encontro usuario: ${e.email}`),void(i.loginData.password===e.password?console.log("La contrasea es correcta"):console.log("La contrasea es incorrecta"))}))}))}}}t.loginregister=s,customElements.define("login-register",s)},148:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.categoriesButton=void 0,n(3945);class r extends HTMLElement{static get observedAttributes(){return Object.keys({text:null})}constructor(){super(),this.properties={text:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){"text"===e&&(this.properties.text=n)}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/mainPage/categoriesSection/categoriesButton/categoriesButton.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("button");r.innerText=this.properties.text,null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}t.categoriesButton=r,customElements.define("categories-button",r)},3683:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CategoriesSection=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/mainPage/categoriesSection/categoriesSection.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","sectionsContainer"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);const i=this.ownerDocument.createElement("categories-button");i.setAttribute("text","Furniture"),r.appendChild(i);const s=this.ownerDocument.createElement("categories-button");s.setAttribute("text","Plants"),r.appendChild(s);const o=this.ownerDocument.createElement("categories-button");o.setAttribute("text","Food"),r.appendChild(o);const a=this.ownerDocument.createElement("categories-button");a.setAttribute("text","Kids"),r.appendChild(a);const c=this.ownerDocument.createElement("categories-button");c.setAttribute("text","Books"),r.appendChild(c)}}t.CategoriesSection=r,customElements.define("categories-section",r)},6414:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newsSection=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(null!=this.shadowRoot||null!=this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/mainPage/newSection/newSection.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","newsSectionContaier"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("div");n.setAttribute("id","newsSection_textContainer"),t.appendChild(n);const r=this.ownerDocument.createElement("h1");r.innerText="New living rooms sets for you!",n.appendChild(r)}}}t.newsSection=r,customElements.define("news-section",r)},8579:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendedSection=void 0,n(3945);const r=n(4153);class i extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/mainPage/recommendedSection/recommendedSection.css");const i=this.ownerDocument.createElement("section");i.setAttribute("id","recommendedContainer");const s=this.ownerDocument.createElement("h2");s.innerHTML="Recommended for you";const o=this.ownerDocument.createElement("div");o.classList.add("recommendedCardsContainer"),i.appendChild(s),i.appendChild(o),r.dataGeneral.recommended.map((e=>{const t=this.ownerDocument.createElement("recommended_section-card");t.setAttribute("img",`${e.img}`),t.setAttribute("title",`${e.title}`),t.setAttribute("price",`${e.price}`),t.setAttribute("description",`${e.description}`),o.appendChild(t)})),r.dataGeneral.recommended.map((e=>{const t=this.ownerDocument.createElement("recommended_section-card");t.setAttribute("img",`${e.img}`),t.setAttribute("title",`${e.title}`),t.setAttribute("price",`${e.price}`),t.setAttribute("description",`${e.description}`),o.appendChild(t)})),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n),null===(t=this.shadowRoot)||void 0===t||t.appendChild(i)}}t.RecommendedSection=i,customElements.define("recommended-section",i)},7170:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recommendedSectionCard=void 0;const r=n(8527),i=n(4610),s=n(4158);n(3945);class o extends HTMLElement{static get observedAttributes(){return Object.keys({img:null,title:null,price:null,description:null})}constructor(){super(),this.properties={img:"",title:"",price:"",description:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"img":this.properties.img=n;break;case"title":this.properties.title=n;break;case"price":this.properties.price=n;break;case"description":this.properties.description=n}}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/mainPage/recommendedSection/recommendedSectionCard/recommendedSectionCard.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const o=this.ownerDocument.createElement("div");o.classList.add("recommendCardContainer"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("cardImageContainer"),o.appendChild(a);const c=this.ownerDocument.createElement("div");c.classList.add("cardImage"),c.style.backgroundImage=`url(${this.properties.img})`,a.appendChild(c);const u=this.ownerDocument.createElement("div");u.classList.add("textContainer"),o.appendChild(u);const l=this.ownerDocument.createElement("h2");l.innerHTML=`${this.properties.title}`,u.appendChild(l);const h=this.ownerDocument.createElement("h3");h.innerHTML=`${this.properties.price}`,u.appendChild(h);const d=this.ownerDocument.createElement("p");d.innerHTML=`${this.properties.description}`,u.appendChild(d),o.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeViewProduct)(this.properties.title)),(0,r.dispatch)((0,i.changeScreen)(s.Screens.productDetail))}))}}t.recommendedSectionCard=o,customElements.define("recommended_section-card",o)},3498:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SalesCard=void 0;class n extends HTMLElement{static get observedAttributes(){return Object.keys({image:null,text:null,sub_text:null})}constructor(){super(),this.properties={image:"",text:"",sub_text:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"image":this.properties.image=n;break;case"text":this.properties.text=n;break;case"sub_text":this.properties.sub_text=n}}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/mainPage/salesSection/salesCard/salesCard.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const r=this.ownerDocument.createElement("div");r.classList.add("saleCard"),r.style.backgroundImage=`url(${this.properties.image})`,null===(t=this.shadowRoot)||void 0===t||t.appendChild(r);const i=this.ownerDocument.createElement("div");i.classList.add("subTitleContainer"),r.appendChild(i);const s=this.ownerDocument.createElement("h3");s.innerText=`${this.properties.sub_text}`,i.appendChild(s)}}t.SalesCard=n,customElements.define("sales-card",n)},1532:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.salesSection=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(null!=this.shadowRoot||null!=this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/mainPage/salesSection/salesSection.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","salesSectionContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("sales-card");n.setAttribute("image","/src/resources/jpg/sales/ofertaCelulares.jpg"),n.setAttribute("text","50% off"),n.setAttribute("sub_text","Phones and Accessories"),t.appendChild(n);const r=this.ownerDocument.createElement("sales-card");r.setAttribute("image","/src/resources/jpg/sales/ofertaMuebles.jpg"),r.setAttribute("text","60% off"),r.setAttribute("sub_text","Home and Furniture"),t.appendChild(r);const i=this.ownerDocument.createElement("sales-card");i.setAttribute("image","/src/resources/jpg/sales/ofertaTelevisores.jpg"),i.setAttribute("text","50% off"),i.setAttribute("sub_text","TV and Audio"),t.appendChild(i)}}}t.salesSection=r,customElements.define("sales-section",r)},1164:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.myProductCard=void 0;class n extends HTMLElement{static get observedAttributes(){return Object.keys({title:null,desc:null,price:null,date:null,image:null})}constructor(){super(),this.properties={title:"",desc:"",price:"",date:"",image:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"title":this.properties.title=n;break;case"desc":this.properties.desc=n;break;case"price":this.properties.price=n;break;case"date":this.properties.date=n;break;case"image":this.properties.image=n}}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){const t=this.ownerDocument.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","/src/components/myProductsPage/myProductCard/myProductCard.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=this.ownerDocument.createElement("div");n.classList.add("myProductCardContainer"),this.shadowRoot.appendChild(n);const r=this.ownerDocument.createElement("div");r.classList.add("productImage"),r.style.backgroundImage="url(/src/resources/jpg/sofaMainPage.jpg)",n.appendChild(r);const i=this.ownerDocument.createElement("div");i.classList.add("productInfoContainer"),n.appendChild(i);const s=this.ownerDocument.createElement("h2");s.innerText="Cookie dough chocolate chips corona 250g",i.appendChild(s);const o=this.ownerDocument.createElement("p");o.innerText="Prepare delicious desserts, cookies, milkshakes or make...",i.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("priceAndInfoContainer"),i.appendChild(a);const c=this.ownerDocument.createElement("div");c.classList.add("priceContainer"),a.appendChild(c);const u=this.ownerDocument.createElement("h3");u.innerText="Price",c.appendChild(u);const l=this.ownerDocument.createElement("p");l.innerText="COP $23.500",c.appendChild(l);const h=this.ownerDocument.createElement("div");h.classList.add("priceContainer"),a.appendChild(h);const d=this.ownerDocument.createElement("h3");d.innerText="Published on",h.appendChild(d);const p=this.ownerDocument.createElement("p");p.innerText="12/09/2023",h.appendChild(p);const f=this.ownerDocument.createElement("div");f.classList.add("buttonContainer"),i.appendChild(f);const m=this.ownerDocument.createElement("p");m.innerText="Delete",f.appendChild(m);const g=this.ownerDocument.createElement("p");g.innerText="View",f.appendChild(g)}}}t.myProductCard=n,customElements.define("my_product-card",n)},7567:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.myProductsSearch=void 0;class n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/myProductsPage/myProductsSearch/myProductsSearch.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","myProductsSearchContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("h2");n.innerText="Search",t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","searchContainer"),t.appendChild(r);const i=this.ownerDocument.createElement("img");i.setAttribute("src","/src/resources/svg/navIcons/searchLight.svg"),r.appendChild(i);const s=this.ownerDocument.createElement("input");s.setAttribute("placeholder","Find your product"),r.appendChild(s)}}}t.myProductsSearch=n,customElements.define("my_products-search",n)},9558:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.myProductsTotalProducts=void 0;class n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/myProductsPage/myProductsTotalProducts/myProductsTotalProducts.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","myProductsTotalProductsContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("h2");n.innerText="Total of products",t.appendChild(n);const r=this.ownerDocument.createElement("div");r.classList.add("infoContainer"),t.appendChild(r);const i=this.ownerDocument.createElement("h3");i.innerText="Products",r.appendChild(i);const s=this.ownerDocument.createElement("p");s.innerText="10",r.appendChild(s);const o=this.ownerDocument.createElement("div");o.classList.add("infoContainer"),t.appendChild(o);const a=this.ownerDocument.createElement("h3");a.innerText="On Process",o.appendChild(a);const c=this.ownerDocument.createElement("p");c.innerText="5",o.appendChild(c);const u=this.ownerDocument.createElement("div");u.classList.add("infoContainerTotal"),t.appendChild(u);const l=this.ownerDocument.createElement("h3");l.innerText="Total",u.appendChild(l);const h=this.ownerDocument.createElement("p");h.innerText="15",u.appendChild(h)}}}t.myProductsTotalProducts=n,customElements.define("my_products-total_products",n)},6122:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavBar=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/navBar/navBar.css");const r=this.ownerDocument.createElement("nav");r.setAttribute("id","navBar");const i=this.ownerDocument.createElement("img");i.setAttribute("src","/src/resources/svg/logo_dark_v.svg"),i.setAttribute("id","logoNav");const s=this.ownerDocument.createElement("nav-searchbar"),o=this.ownerDocument.createElement("nav-iconbutton");o.setAttribute("icon","/src/resources/svg/chat_icon.svg");const a=this.ownerDocument.createElement("nav-iconbutton");a.setAttribute("icon","/src/resources/svg/userProfile_logo.svg");const c=this.ownerDocument.createElement("nav-iconbutton");c.setAttribute("icon","/src/resources/svg/upload_icon.svg");const u=this.ownerDocument.createElement("nav-iconbutton");u.setAttribute("icon","/src/resources/svg/shoopingCart_icon.svg");const l=this.ownerDocument.createElement("nav-iconbutton");l.setAttribute("icon","/src/resources/svg/options_icon.svg");const h=this.ownerDocument.createElement("div");h.classList.add("horizontalSpace"),r.appendChild(i),r.appendChild(s),r.appendChild(h),r.appendChild(o),r.appendChild(a),r.appendChild(c),r.appendChild(u),r.appendChild(l),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}t.NavBar=r,customElements.define("nav-bar",r)},3277:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavBarEmpty=void 0;const r=n(4610),i=n(8527),s=n(4158);n(3945);class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/navBar/navBarEmpty/navBarEmpty.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","navbar"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("img");n.setAttribute("src","/src/resources/svg/logo_light_new.svg"),t.appendChild(n),n.addEventListener("click",(()=>{(0,i.dispatch)((0,r.changeScreen)(s.Screens.landingPage))}))}}}t.NavBarEmpty=o,customElements.define("navbar-empty",o)},6100:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavBarLanding=void 0;const r=n(4610),i=n(8527),s=n(4158);n(3945);class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/navBar/navBarLandingPage/navBarLanding.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","navbar"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("img");n.setAttribute("src","/src/resources/svg/logo_light_new.svg"),t.appendChild(n);const o=this.ownerDocument.createElement("div");o.classList.add("horizontalSpace"),t.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("button-container"),t.appendChild(a);const c=this.ownerDocument.createElement("button");c.setAttribute("id","sign-up"),c.innerHTML="Sign Up",a.appendChild(c);const u=this.ownerDocument.createElement("button");u.setAttribute("id","login"),u.innerHTML="Sign In",a.appendChild(u),c.addEventListener("click",(()=>{(0,i.dispatch)((0,r.changeScreen)(s.Screens.signUp))})),u.addEventListener("click",(()=>{(0,i.dispatch)((0,r.changeScreen)(s.Screens.logIn))}))}}}t.NavBarLanding=o,customElements.define("nav-barlanding",o)},6164:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavBarRed=void 0;const r=n(8527),i=n(4610),s=n(4158);n(3945);class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.mount()}mount(){var e;this.render(),null===(e=this.shadowRoot)||void 0===e||e.getElementById("logo")}render(){if(this.shadowRoot){const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/navBar/navBarRed/navBarRed.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","navbar"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("img");n.setAttribute("id","logo"),n.setAttribute("src","/src/resources/svg/logo_light_new.svg"),t.appendChild(n);const o=this.ownerDocument.createElement("navsearchbar-red");t.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("horizontalSpace"),t.appendChild(a);const c=this.ownerDocument.createElement("img");c.classList.add("navIcon"),c.setAttribute("src","/src/resources/svg/navIcons/light/userLight.svg"),t.appendChild(c);const u=this.ownerDocument.createElement("img");u.classList.add("navIcon"),u.setAttribute("src","/src/resources/svg/navIcons/light/uploadLight.svg"),t.appendChild(u);const l=this.ownerDocument.createElement("img");l.classList.add("navIcon"),l.setAttribute("src","/src/resources/svg/navIcons/light/cartLight.svg"),t.appendChild(l);const h=this.ownerDocument.createElement("img");h.classList.add("navIcon"),h.setAttribute("src","/src/resources/svg/navIcons/light/menuLight.svg"),h.setAttribute("screen",s.Screens.landingPage),t.appendChild(h);const d=this.ownerDocument.createElement("div");d.classList.add("rightSpace"),t.appendChild(d),n.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeSeaarchText)("")),(0,r.dispatch)((0,i.changeScreen)(s.Screens.mainPage))})),c.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeScreen)(s.Screens.userInformation))})),u.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeScreen)(s.Screens.uploadProduct))})),l.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeScreen)(s.Screens.shoopingList))})),h.addEventListener("click",(()=>{(0,r.dispatch)((0,i.sideMenuVisibility)(!0))}))}}}t.NavBarRed=o,customElements.define("navbar-red",o)},2566:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavBarWhite=void 0;const r=n(8527),i=n(4610),s=n(4158);n(3945);class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/navBar/navBarWhite/navBarWhite.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","navbar"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("img");n.setAttribute("id","logo"),n.setAttribute("src","/src/resources/svg/logo_dark_new.svg"),t.appendChild(n);const o=this.ownerDocument.createElement("navsearchbar-white");t.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("horizontalSpace"),t.appendChild(a);const c=this.ownerDocument.createElement("img");c.classList.add("navIcon"),c.setAttribute("src","/src/resources/svg/navIcons/dark/userDark.svg"),t.appendChild(c);const u=this.ownerDocument.createElement("img");u.classList.add("navIcon"),u.setAttribute("src","/src/resources/svg/navIcons/dark/uploadDark.svg"),t.appendChild(u);const l=this.ownerDocument.createElement("img");l.classList.add("navIcon"),l.setAttribute("src","/src/resources/svg/navIcons/dark/cartDark.svg"),t.appendChild(l);const h=this.ownerDocument.createElement("img");h.classList.add("navIcon"),h.setAttribute("src","/src/resources/svg/navIcons/dark/menuDark.svg"),t.appendChild(h);const d=this.ownerDocument.createElement("div");d.classList.add("rightSpace"),t.appendChild(d),n.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeSeaarchText)("")),(0,r.dispatch)((0,i.changeScreen)(s.Screens.mainPage))})),c.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeScreen)(s.Screens.userInformation))})),u.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeScreen)(s.Screens.uploadProduct))})),l.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeScreen)(s.Screens.shoopingList))})),h.addEventListener("click",(()=>{(0,r.dispatch)((0,i.sideMenuVisibility)(!0))}))}}}t.NavBarWhite=o,customElements.define("navbar-white",o)},8545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavIconButton=void 0,n(3945);class r extends HTMLElement{static get observedAttributes(){return Object.keys({icon:null})}constructor(){super(),this.properties={icon:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){"icon"===e&&(this.properties.icon=n)}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/navBar/navIconButton/navIconButton.css");const r=this.ownerDocument.createElement("div"),i=this.ownerDocument.createElement("img");i.setAttribute("src",`${this.properties.icon}`),r.appendChild(i),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}t.NavIconButton=r,customElements.define("nav-iconbutton",r)},3157:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavSearchBarRed=void 0;const r=n(8527),i=n(4610),s=n(4158);n(3945);const o=window.location.search;console.log(o);const a=new URLSearchParams(o);console.log(a.get("search"));class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/navBar/navSearchBarRed/navSearchBarRed.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const o=this.ownerDocument.createElement("div");o.setAttribute("id","navSearchBar"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(o);const a=this.ownerDocument.createElement("img");a.setAttribute("id","navSearchLogo"),a.setAttribute("src","/src/resources/svg/navIcons/searchDark.svg"),o.appendChild(a);const c=this.ownerDocument.createElement("input");c.setAttribute("id","searchInputNav"),c.setAttribute("placeholder","Find what you want!"),c.value=r.state.searchText,o.appendChild(c),a.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeSeaarchText)(c.value)),(0,r.dispatch)((0,i.changeScreen)(s.Screens.searchPage))}))}}t.NavSearchBarRed=c,customElements.define("navsearchbar-red",c)},4983:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavSearchBarWhite=void 0;const r=n(8527),i=n(4610),s=n(4158);n(3945);const o=window.location.search;console.log(o);const a=new URLSearchParams(o);console.log(a.get("search"));class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/navBar/navSearchBarWhite/navSearchBarWhite.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const o=this.ownerDocument.createElement("div");o.setAttribute("id","navSearchBar"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(o);const a=this.ownerDocument.createElement("img");a.setAttribute("id","navSearchLogo"),a.setAttribute("src","/src/resources/svg/navIcons/searchLight.svg"),o.appendChild(a);const c=this.ownerDocument.createElement("input");c.setAttribute("id","searchInputNav"),c.setAttribute("placeholder","Find what you want!"),c.value=r.state.searchText,o.appendChild(c),a.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeSeaarchText)(c.value)),(0,r.dispatch)((0,i.changeScreen)(s.Screens.searchPage))}))}}t.NavSearchBarWhite=c,customElements.define("navsearchbar-white",c)},5865:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paymentMenu=void 0;class n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/paymentPage/paymentMenu/paymentMenu.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","paymentMenuContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("h1");n.innerText="Payment",t.appendChild(n);const r=this.ownerDocument.createElement("h2");r.innerText="Select payment method",t.appendChild(r);const i=this.ownerDocument.createElement("select");t.appendChild(i);for(let e=0;e<3;e++){const t=this.ownerDocument.createElement("option");t.innerText=`Opcion ${e}`,i.appendChild(t)}const s=this.ownerDocument.createElement("p");s.innerText="You are going to pay $87.823 with your visa card that ends with 2345",t.appendChild(s);const o=this.ownerDocument.createElement("button");o.innerText="Accept",t.appendChild(o)}}}t.paymentMenu=n,customElements.define("payment-menu",n)},9081:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paymentSummary=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){const t=this.ownerDocument.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","/src/components/paymentPage/paymentSummary/paymentSummary.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=this.ownerDocument.createElement("div");n.setAttribute("id","mainContainer"),this.shadowRoot.appendChild(n);const r=this.ownerDocument.createElement("h2");r.innerText="Summary of purchase",n.appendChild(r);const i=this.ownerDocument.createElement("div");i.classList.add("infoContainer"),n.appendChild(i);const s=this.ownerDocument.createElement("h3");s.innerText="Products",i.appendChild(s);const o=this.ownerDocument.createElement("p");o.innerText="$76.923",i.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("infoContainer"),n.appendChild(a);const c=this.ownerDocument.createElement("h3");c.innerText="Shipment",a.appendChild(c);const u=this.ownerDocument.createElement("p");u.innerText="$10.900",a.appendChild(u);const l=this.ownerDocument.createElement("div");l.classList.add("infoContainerTotal"),n.appendChild(l);const h=this.ownerDocument.createElement("h3");h.innerText="Total",l.appendChild(h);const d=this.ownerDocument.createElement("p");d.innerText="$87.823",l.appendChild(d)}}}t.paymentSummary=r,customElements.define("payment_summary-payment_page",r)},3386:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductDetailCard=void 0,n(3945);const r=n(4153),i=n(8527);class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/productdetailcomp/productdetailcard/productdetailcard.css"),this.shadowRoot.appendChild(e);let t={img:"",price:"",title:"",description:""};r.dataGeneral.recommended.map((e=>{e.title===i.state.viewProduct&&(t=e)})),console.log(`Encontro: ${t}`),console.log(t);const n=document.createElement("div");n.setAttribute("class","card-container"),this.shadowRoot.appendChild(n);const s=document.createElement("div");s.setAttribute("class","image-container"),s.style.backgroundImage=`url(${t.img})`,n.appendChild(s);const o=document.createElement("div");o.setAttribute("class","content-container"),n.appendChild(o);const a=document.createElement("h1");a.textContent=t.title,o.appendChild(a);const c=document.createElement("h2");c.textContent=t.price,o.appendChild(c);const u=document.createElement("div");u.setAttribute("class","rating-container"),o.appendChild(u);for(let e=0;e<5;e++){const e=document.createElement("img");e.setAttribute("src","/src/resources/svg/Star 1.svg"),e.setAttribute("alt","Star"),u.appendChild(e)}const l=document.createElement("h3");l.textContent="4.0",u.appendChild(l);const h=document.createElement("h3");h.textContent="Description",o.appendChild(h);const d=document.createElement("p");d.textContent=t.description,o.appendChild(d);const p=document.createElement("button");p.textContent="Purchase now",o.appendChild(p);const f=document.createElement("button");f.textContent="Add to cart",o.appendChild(f)}}}t.ProductDetailCard=s,customElements.define("product-detailcard",s)},4014:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductDetailComments=void 0;class n extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(null!=this.shadowRoot||null!=this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/productdetailcomp/productdetailcomment/productdetailcomment.css"),this.shadowRoot.appendChild(e);const t=document.createElement("div");t.setAttribute("class","comments-container"),this.shadowRoot.appendChild(t);const n=document.createElement("h1");n.textContent="Questions and Answers",t.appendChild(n);const r=document.createElement("div");r.setAttribute("class","question"),t.appendChild(r);const i=document.createElement("img");i.setAttribute("src","/src/resources/jpg/account_circle_FILL1_wght400_GRAD0_opsz48 1.png"),i.setAttribute("alt","Profile Image"),t.appendChild(i);const s=document.createElement("p");s.textContent="What's the key ingredient in a classic cookie dough recipe?",t.appendChild(s);const o=document.createElement("p");o.setAttribute("class","answer"),o.textContent="The key ingredient in a classic cookie dough recipe is all-purpose flour.",t.appendChild(o)}}}t.ProductDetailComments=n,customElements.define("product-comments",n)},2631:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.optionsInformation=void 0,n(7324);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/searchPage/optionsInformation/optionsInformation.css");const r=this.ownerDocument.createElement("div");r.setAttribute("id","optionsInformationContainer");const i=this.ownerDocument.createElement("h3");i.innerHTML="Search options";const s=this.ownerDocument.createElement("search--option");s.setAttribute("title","Price"),s.setAttribute("desc","No option selected"),s.setAttribute("opt_default","No option selected"),s.setAttribute("opt1","From cheap to expensive"),s.setAttribute("opt2","From expensive to cheap"),r.appendChild(i),r.appendChild(s),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}t.optionsInformation=r,customElements.define("options-information",r)},7324:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchOption=void 0;class n extends HTMLElement{static get observedAttributes(){return Object.keys({title:null,desc:null,opt_default:null,opt1:null,opt2:null})}constructor(){super(),this.properties={title:"",desc:"",opt_default:"",opt1:"",opt2:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"title":this.properties.title=n;break;case"desc":this.properties.desc=n;break;case"opt_default":this.properties.opt_default=n;break;case"opt1":this.properties.opt1=n;break;case"opt2":this.properties.opt2=n}}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/searchPage/optionsInformation/searchOption/searchOption.css");const r=this.ownerDocument.createElement("div");r.classList.add("optionContainer");const i=this.ownerDocument.createElement("p");i.setAttribute("id","optionTitle"),i.innerHTML=`${this.properties.title}`;const s=this.ownerDocument.createElement("div");s.setAttribute("id","optionSelectorContainer");const o=this.ownerDocument.createElement("select"),a=this.ownerDocument.createElement("option");a.innerHTML=`${this.properties.opt_default}`;const c=this.ownerDocument.createElement("option");c.innerHTML=`${this.properties.opt1}`;const u=this.ownerDocument.createElement("option");u.innerHTML=`${this.properties.opt2}`,o.appendChild(a),o.appendChild(c),o.appendChild(u),s.appendChild(o),r.append(i),r.appendChild(s),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n),null===(t=this.shadowRoot)||void 0===t||t.appendChild(r)}}t.SearchOption=n,customElements.define("search--option",n)},4066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchResultsCard=void 0;const r=n(8527),i=n(4610),s=n(4158);class o extends HTMLElement{static get observedAttributes(){return Object.keys({img:null,title:null,price:null,desc:null})}constructor(){super(),this.properties={img:"",title:"",price:"",desc:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"img":this.properties.img=n;break;case"title":this.properties.title=n;break;case"price":this.properties.price=n;break;case"desc":this.properties.desc=n}}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/searchPage/searchResultsCard/searchResultsCard.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const o=this.ownerDocument.createElement("div");o.classList.add("cardResultCotainer"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("productImgContainer"),a.style.backgroundImage=`url(${this.properties.img})`,o.appendChild(a);const c=this.ownerDocument.createElement("div");c.classList.add("productInfoContainer"),o.appendChild(c);const u=this.ownerDocument.createElement("h2");u.innerHTML=`${this.properties.title}`,c.appendChild(u);const l=this.ownerDocument.createElement("h3");l.innerHTML=`${this.properties.price}`,c.appendChild(l);const h=this.ownerDocument.createElement("p");h.innerHTML=`${this.properties.desc}`,c.appendChild(h),o.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeViewProduct)(this.properties.title)),(0,r.dispatch)((0,i.changeScreen)(s.Screens.productDetail))}))}}t.searchResultsCard=o,customElements.define("search_results-card",o)},507:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.purchaseSummaryCartList=void 0;const r=n(8527),i=n(4610),s=n(4158);n(3945);class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){const t=this.ownerDocument.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","/src/components/shoopingListPage/purchaseSummary/purchaseSummary.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=this.ownerDocument.createElement("div");n.setAttribute("id","mainContainer"),this.shadowRoot.appendChild(n);const o=this.ownerDocument.createElement("h2");o.innerText="Summary of purchase",n.appendChild(o);const a=this.ownerDocument.createElement("div");a.classList.add("infoContainer"),n.appendChild(a);const c=this.ownerDocument.createElement("h3");c.innerText="Products",a.appendChild(c);const u=this.ownerDocument.createElement("p");u.innerText="$76.923",a.appendChild(u);const l=this.ownerDocument.createElement("div");l.classList.add("infoContainer"),n.appendChild(l);const h=this.ownerDocument.createElement("h3");h.innerText="Shipment",l.appendChild(h);const d=this.ownerDocument.createElement("p");d.innerText="$10.900",l.appendChild(d);const p=this.ownerDocument.createElement("div");p.classList.add("infoContainerTotal"),n.appendChild(p);const f=this.ownerDocument.createElement("h3");f.innerText="Total",p.appendChild(f);const m=this.ownerDocument.createElement("p");m.innerText="$87.823",p.appendChild(m);const g=this.ownerDocument.createElement("button");g.innerText="PURCHASE",n.appendChild(g),g.addEventListener("click",(()=>{(0,r.dispatch)((0,i.changeScreen)(s.Screens.paymentPage))}))}}}t.purchaseSummaryCartList=o,customElements.define("purchase_summary-cart_list",o)},7933:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shoopinListCard=void 0;class n extends HTMLElement{static get observedAttributes(){return Object.keys({title:null,count:null,price:null})}constructor(){super(),this.properties={title:"",count:"",price:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"title":this.properties.title=n;break;case"price":case"count":this.properties.count=n}}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){const t=this.ownerDocument.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","/src/components/shoopingListPage/shoopinListCard/shoopinListCard.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=this.ownerDocument.createElement("div");n.classList.add("shoopinListCard_Container"),this.shadowRoot.appendChild(n);const r=this.ownerDocument.createElement("div");r.classList.add("cardImage"),r.style.backgroundImage="url(/src/resources/jpg/platesRecommended.jpg)",n.appendChild(r);const i=this.ownerDocument.createElement("div");i.classList.add("infoContainer"),n.appendChild(i);const s=this.ownerDocument.createElement("h2");s.innerText="Cookie dough chocolate chips corona 250g",i.appendChild(s);const o=this.ownerDocument.createElement("p");o.innerText="Count 1",i.appendChild(o);const a=this.ownerDocument.createElement("p");a.innerText="COP $23.500",i.appendChild(a);const c=this.ownerDocument.createElement("div");c.classList.add("buttonsContainer"),i.appendChild(c);const u=this.ownerDocument.createElement("p");u.innerText="Delete",c.appendChild(u);const l=this.ownerDocument.createElement("p");l.innerText="Purchase now",c.appendChild(l);const h=this.ownerDocument.createElement("p");h.innerText="Add more",c.appendChild(h)}}}t.shoopinListCard=n,customElements.define("shoopin_list-card",n)},1505:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PurchaseSummary=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/shoopingPage/purchaseSummary/purchaseSummary.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","summaryContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("h2");n.innerText="Summary of purchase",t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","detailsContainer"),t.appendChild(r);const i=this.ownerDocument.createElement("div");i.setAttribute("id","detailsLeft"),r.appendChild(i);const s=this.ownerDocument.createElement("p");s.innerText="Products",i.appendChild(s);const o=this.ownerDocument.createElement("p");o.innerText="Products",i.appendChild(o);const a=this.ownerDocument.createElement("h3");a.innerText="Total",i.appendChild(a);const c=this.ownerDocument.createElement("div");c.setAttribute("id","detailsRight"),r.appendChild(c);const u=this.ownerDocument.createElement("p");u.innerText="$76.923",c.appendChild(u);const l=this.ownerDocument.createElement("p");l.innerText="$10.900",c.appendChild(l);const h=this.ownerDocument.createElement("h3");h.innerText="$87.823",c.appendChild(h);const d=this.ownerDocument.createElement("button");d.innerText="PURCHASE",t.appendChild(d)}}}t.PurchaseSummary=r,customElements.define("purchase-summary",r)},1090:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShopingListCard=void 0,n(3945);class r extends HTMLElement{static get observedAttributes(){return Object.keys({image:null,title:null,count:null,price:null})}constructor(){super(),this.properties={image:"",title:"",count:"",price:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"image":this.properties.image=n;break;case"count":this.properties.count=n;break;case"price":this.properties.price=n;break;case"title":this.properties.title=n}}connectedCallback(){this.render()}render(){var e;if(this.shadowRoot){const t=this.ownerDocument.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href","/src/components/shoopingPage/shopingListCard/shopingListCard.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(t);const n=this.ownerDocument.createElement("div");n.classList.add("cardContainer"),this.shadowRoot.appendChild(n);const r=this.ownerDocument.createElement("div");r.classList.add("cardImage"),r.style.backgroundImage="url(/src/resources/jpg/platesRecommended.jpg)",n.appendChild(r);const i=this.ownerDocument.createElement("div");i.classList.add("cardTextContainer"),n.appendChild(i);const s=this.ownerDocument.createElement("h2");s.innerText="Cookie dough chocolate chips corona 250g",i.appendChild(s);const o=this.ownerDocument.createElement("h3");o.innerText="Count 12",i.appendChild(o);const a=this.ownerDocument.createElement("h3");a.innerText="COP $23.500",i.appendChild(a);const c=this.ownerDocument.createElement("div");c.classList.add("buttonContainer"),i.appendChild(c);const u=this.ownerDocument.createElement("p");u.innerHTML="DELETE",c.appendChild(u)}}}t.ShopingListCard=r,customElements.define("shopinglist-card",r)},9767:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sideMenu=void 0;const r=n(8527),i=n(4610),s=n(4158);class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),(0,r.addObserver)(this)}connectedCallback(){this.render()}render(){if(this.shadowRoot&&(this.shadowRoot.innerHTML="",!0===r.state.sideMenu)){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/sideMenu/sideMenu.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","sideMenuContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("div");n.setAttribute("id","sideMenu"),t.appendChild(n);const o=this.ownerDocument.createElement("h1");o.innerText="Options",n.appendChild(o);const a=this.ownerDocument.createElement("h2");a.innerText="My products",n.appendChild(a);const c=this.ownerDocument.createElement("h2");c.innerText="Log Out",n.appendChild(c),t.addEventListener("click",(e=>{(0,r.dispatch)((0,i.sideMenuVisibility)(!1))})),n.addEventListener("click",(e=>{e.stopPropagation()})),a.addEventListener("click",(()=>{(0,r.dispatch)((0,i.sideMenuVisibility)(!1)),(0,r.dispatch)((0,i.changeScreen)(s.Screens.myProductsPage))})),c.addEventListener("click",(()=>{(0,r.dispatch)((0,i.sideMenuVisibility)(!1)),(0,r.dispatch)((0,i.changeScreen)(s.Screens.landingPage))}))}}}t.sideMenu=o,customElements.define("side-menu",o)},6873:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignUpInput=void 0;const r=n(632),i=n(368);n(3945);class s extends HTMLElement{static get observedAttributes(){return Object.keys({icon:null,placeholder:null})}constructor(){super(),this.properties={icon:"",placeholder:""},this.attachShadow({mode:"open"})}attributeChangedCallback(e,t,n){switch(e){case"icon":this.properties.icon=n;break;case"placeholder":this.properties.placeholder=n}}connectedCallback(){this.render()}render(){var e,t;const n=this.ownerDocument.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href","/src/components/signUp/signUpInput/signUpInput.css"),null===(e=this.shadowRoot)||void 0===e||e.appendChild(n);const s=this.ownerDocument.createElement("div");s.classList.add("inputSignUp"),null===(t=this.shadowRoot)||void 0===t||t.appendChild(s);const o=this.ownerDocument.createElement("img");o.setAttribute("src",`${this.properties.icon}`),s.appendChild(o);const a=this.ownerDocument.createElement("input");switch(a.setAttribute("type","text"),a.setAttribute("placeholder",`${this.properties.placeholder}`),s.appendChild(a),this.properties.placeholder){case"Name":a.addEventListener("change",(()=>{i.registerData.name=a.value}));break;case"Last name":a.addEventListener("change",(()=>{i.registerData.lastName=a.value}));break;case"Email":a.addEventListener("change",(()=>{i.registerData.email=a.value}));break;case"Cellphone":a.addEventListener("change",(()=>{i.registerData.cellphone=a.value}));break;case"Password":a.addEventListener("change",(()=>{i.registerData.password=a.value}));break;case"Confirm Password":a.addEventListener("change",(()=>{i.registerData.confirmPassword=a.value}));break;case"Enter your email":a.addEventListener("change",(()=>{r.loginData.email=a.value,console.log(r.loginData)}));break;case"Enter your password":a.addEventListener("change",(()=>{r.loginData.password=a.value,console.log(r.loginData)}))}}}t.SignUpInput=s,customElements.define("signup-input",s)},4439:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SignUpMenu=void 0;const i=n(832),s=n(8527),o=n(4610),a=n(4158),c=n(368);n(3945);class u extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/signUp/signUpMenu/signUpMenu.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","menuSignUp"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("h1");n.innerHTML="MarketHub",t.appendChild(n);const u=this.ownerDocument.createElement("h2");u.innerHTML="Register to start shopping!",t.appendChild(u);const l=this.ownerDocument.createElement("signup-input");l.setAttribute("icon","/src/resources/svg/Icons/User.svg"),l.setAttribute("placeholder","Name"),t.appendChild(l);const h=this.ownerDocument.createElement("signup-input");h.setAttribute("icon","/src/resources/svg/Icons/User.svg"),h.setAttribute("placeholder","Last name"),t.appendChild(h);const d=this.ownerDocument.createElement("signup-input");d.setAttribute("icon","/src/resources/svg/Icons/Email.svg"),d.setAttribute("placeholder","Email"),t.appendChild(d);const p=this.ownerDocument.createElement("signup-input");p.setAttribute("icon","/src/resources/svg/Icons/Cellphone.svg"),p.setAttribute("placeholder","Cellphone"),t.appendChild(p);const f=this.ownerDocument.createElement("signup-input");f.setAttribute("icon","/src/resources/svg/Icons/Lock.svg"),f.setAttribute("placeholder","Password"),t.appendChild(f);const m=this.ownerDocument.createElement("signup-input");m.setAttribute("icon","/src/resources/svg/Icons/Lock.svg"),m.setAttribute("placeholder","Confirm Password"),t.appendChild(m);const g=this.ownerDocument.createElement("button");g.innerHTML="CREATE ACCOUNT",t.appendChild(g),g.addEventListener("click",(()=>r(this,void 0,void 0,(function*(){const e=yield(0,i.registrarUsuario)(`${c.registerData.name} ${c.registerData.lastName}`,c.registerData.email,c.registerData.cellphone,c.registerData.password);console.log(`El ID del usuario es: ${e}`),(0,s.dispatch)((0,o.changeLogedUser)(e)),(0,s.dispatch)((0,o.changeScreen)(a.Screens.mainPage))}))))}}}t.SignUpMenu=u,customElements.define("signup-menu",u)},965:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userInfoRest=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/userInformationPage/userInfoRest/userInfoRest.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","userInfoRest"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("div");n.classList.add("dataContainer"),t.appendChild(n);const r=this.ownerDocument.createElement("h2");r.innerText="Email",n.appendChild(r);const i=this.ownerDocument.createElement("h3");i.innerText="userEmail",n.appendChild(i);const s=this.ownerDocument.createElement("hr");s.classList.add("separationLine"),t.appendChild(s);const o=this.ownerDocument.createElement("div");o.classList.add("dataContainer"),t.appendChild(o);const a=this.ownerDocument.createElement("h2");a.innerText="Phone",o.appendChild(a);const c=this.ownerDocument.createElement("h3");c.innerText="userPhone",o.appendChild(c);const u=this.ownerDocument.createElement("hr");u.classList.add("separationLine"),t.appendChild(u);const l=this.ownerDocument.createElement("div");l.classList.add("dataContainer"),t.appendChild(l);const h=this.ownerDocument.createElement("h2");h.innerText="id",l.appendChild(h);const d=this.ownerDocument.createElement("h3");d.innerText="idPhone",l.appendChild(d)}}}t.userInfoRest=r,customElements.define("userinfo-rest",r)},7504:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userInfoTitle=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/components/userInformationPage/userInfoTitle/userInfoTitle.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("div");t.setAttribute("id","userInfoTitleContainer"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("div");n.setAttribute("id","userImage"),n.style.backgroundImage="url(https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?q=80&w=1000&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8dXNlcnxlbnwwfHwwfHx8MA%3D%3D)",t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","userTitleInfo"),t.appendChild(r);const i=this.ownerDocument.createElement("h1");i.innerText="UserName",r.appendChild(i);const s=this.ownerDocument.createElement("h2");s.innerText="@UserName",r.appendChild(s)}}}t.userInfoTitle=r,customElements.define("userinfo-title",r)},832:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.traerDatosUsers=t.registrarUsuario=void 0;const i=n(978),s=n(923),o=n(867),a=n(181),c=(0,s.initializeApp)(i.firebaseConfig),u=(0,o.getFirestore)(c);t.registrarUsuario=(e,t,n,i)=>r(void 0,void 0,void 0,(function*(){const r=yield(0,o.addDoc)((0,o.collection)(u,"users"),{name:e,email:t,cellphone:n,password:i});return yield(0,o.updateDoc)(r,{id:r.id}),r.id})),t.traerDatosUsers=()=>r(void 0,void 0,void 0,(function*(){(yield(0,o.getDocs)((0,o.collection)(u,"users"))).forEach((e=>{a.dataUsers.push(e.data())})),console.log(a.dataUsers)}))},978:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.firebaseConfig=void 0,t.firebaseConfig={apiKey:"AIzaSyBmVrQiwUaQzcqVryclVK7gqKQ_NkgZiUk",authDomain:"markethub-ba8c0.firebaseapp.com",projectId:"markethub-ba8c0",storageBucket:"markethub-ba8c0.appspot.com",messagingSenderId:"523379250459",appId:"1:523379250459:web:0148574d90751c47a2afbe"}},4759:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forgotPasswordPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/forgotPassword/forgotPassword.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","forgotPasswordPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-empty");t.appendChild(n);const r=this.ownerDocument.createElement("forgotpassword-menu");t.appendChild(r)}}}t.forgotPasswordPage=r,customElements.define("forgotpassword-page",r)},7359:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LandingPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/landingPage/landingPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","landingPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("nav-barlanding"),r=this.ownerDocument.createElement("description-section"),i=this.ownerDocument.createElement("more-infosection"),s=this.ownerDocument.createElement("more-infosectiontwo"),o=this.ownerDocument.createElement("landing-footer");t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(s),t.appendChild(o)}}}t.LandingPage=r,customElements.define("landing-page",r)},5442:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.loginPage=void 0,n(3945);const i=n(832);class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){return r(this,void 0,void 0,(function*(){if(this.shadowRoot){(0,i.traerDatosUsers)();const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/loginPage/loginPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","LoginPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-empty"),r=this.ownerDocument.createElement("login-register");t.appendChild(n),t.appendChild(r)}}))}}t.loginPage=s,customElements.define("login-page",s)},9199:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MainPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(null!=this.shadowRoot||null!=this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/mainPage/mainPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","mainPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-red");t.appendChild(n);const r=this.ownerDocument.createElement("categories-section");t.appendChild(r);const i=this.ownerDocument.createElement("news-section");t.appendChild(i);const s=this.ownerDocument.createElement("sales-section");t.appendChild(s);const o=this.ownerDocument.createElement("recommended-section");t.appendChild(o)}}}t.MainPage=r,customElements.define("main-page",r)},5294:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.myProductsPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/myProductsPage/myProductsPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","myProductsPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-white");t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","pageTitleContainer"),t.appendChild(r);const i=this.ownerDocument.createElement("h1");i.innerText="Your products",r.appendChild(i);const s=this.ownerDocument.createElement("p");s.innerText="These are the products that you currently are selling. From this pages you can manage them.",r.appendChild(s);const o=this.ownerDocument.createElement("div");o.setAttribute("id","cardsAndInfoContainer"),t.appendChild(o);const a=this.ownerDocument.createElement("div");a.setAttribute("id","myProductsCardsContainer"),o.appendChild(a);const c=this.ownerDocument.createElement("my_product-card");a.appendChild(c);const u=this.ownerDocument.createElement("div");u.setAttribute("id","moreInfoContainer"),o.appendChild(u);const l=this.ownerDocument.createElement("my_products-total_products");u.appendChild(l);const h=this.ownerDocument.createElement("my_products-search");u.appendChild(h)}}}t.myProductsPage=r,customElements.define("my_products-page",r)},1929:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.paymentPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/paymentPage/paymentPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","paymentPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-white");t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","summaryPaymentContainer"),t.appendChild(r);const i=this.ownerDocument.createElement("payment_summary-payment_page");r.appendChild(i);const s=this.ownerDocument.createElement("div");s.setAttribute("id","paymentMenuContainer"),t.appendChild(s);const o=this.ownerDocument.createElement("payment-menu");s.appendChild(o)}}}t.paymentPage=r,customElements.define("payment-page",r)},9496:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductDetail=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/productDetail/productDetail.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","ProductDetail"),t.style.backgroundColor="#F24333",this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-white");t.appendChild(n);const r=this.ownerDocument.createElement("div");r.classList.add("card-detail-container");const i=this.ownerDocument.createElement("product-detailcard");i.classList.add("carddetail"),r.appendChild(i);const s=this.ownerDocument.createElement("div");s.classList.add("comments-container");const o=this.ownerDocument.createElement("product-comments");o.classList.add("cardcomments"),s.appendChild(o),t.appendChild(r),t.appendChild(s)}}}t.ProductDetail=r,customElements.define("product-detail",r)},1011:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchPage=void 0,n(3945);const r=n(4153),i=n(8527);class s extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/searchPage/searchPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","searchPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-red");t.appendChild(n);const s=this.ownerDocument.createElement("div");s.setAttribute("id","mainSearchContainer"),t.appendChild(s);const o=this.ownerDocument.createElement("div");o.setAttribute("id","optionsContainer"),s.appendChild(o);const a=this.ownerDocument.createElement("div");a.setAttribute("id","resultsContainer"),s.appendChild(a);const c=this.ownerDocument.createElement("h2");c.innerHTML=`Results for "${i.state.searchText}"...`,o.appendChild(c);const u=this.ownerDocument.createElement("options-information");o.appendChild(u),r.dataGeneral.recommended.map((e=>{if(e.title.toLowerCase().includes(i.state.searchText.toLocaleLowerCase())){const t=this.ownerDocument.createElement("search_results-card");t.setAttribute("img",`${e.img}`),t.setAttribute("title",`${e.title}`),t.setAttribute("price",`${e.price}`),t.setAttribute("desc",`${e.description}`),a.appendChild(t)}}))}}}t.SearchPage=s,customElements.define("search-page",s)},496:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shoopingListPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/shoopingListPage/shoopingListPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","shoopingListPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-red");t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","cartCardsContainer"),t.appendChild(r);const i=this.ownerDocument.createElement("div");i.setAttribute("id","cardsTitleDiv"),r.appendChild(i);const s=this.ownerDocument.createElement("shoopin_list-card");r.appendChild(s);const o=this.ownerDocument.createElement("shoopin_list-card");r.appendChild(o);const a=this.ownerDocument.createElement("shoopin_list-card");r.appendChild(a);const c=this.ownerDocument.createElement("shoopin_list-card");r.appendChild(c);const u=this.ownerDocument.createElement("shoopin_list-card");r.appendChild(u);const l=this.ownerDocument.createElement("shoopin_list-card");r.appendChild(l);const h=this.ownerDocument.createElement("h1");h.innerText="Shopping List",i.appendChild(h);const d=this.ownerDocument.createElement("div");d.setAttribute("id","purchaseSummary"),t.appendChild(d);const p=this.ownerDocument.createElement("purchase_summary-cart_list");d.appendChild(p)}}}t.shoopingListPage=r,customElements.define("shooping_list-page",r)},7470:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShopingList=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/shopingList/shopingList.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","shopingList"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-red");t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","shoopingListSubContaainer"),t.appendChild(r);const i=this.ownerDocument.createElement("div");i.setAttribute("id","shoopingListCardContainer"),r.appendChild(i);const s=this.ownerDocument.createElement("div");s.setAttribute("id","cardsListTitle"),i.appendChild(s);const o=this.ownerDocument.createElement("h1");o.innerText="Shopping List",s.appendChild(o);const a=this.ownerDocument.createElement("shopinglist-card");i.appendChild(a);const c=this.ownerDocument.createElement("shopinglist-card");i.appendChild(c);const u=this.ownerDocument.createElement("shopinglist-card");i.appendChild(u);const l=this.ownerDocument.createElement("shopinglist-card");i.appendChild(l);const h=this.ownerDocument.createElement("div");h.setAttribute("id","shoopingListSummary"),r.appendChild(h);const d=this.ownerDocument.createElement("purchase-summary");h.appendChild(d)}}}t.ShopingList=r,customElements.define("shoping-list",r)},6352:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignUp=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/signUp/signUp.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","SignUp"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-empty");t.appendChild(n);const r=this.ownerDocument.createElement("signup-menu");t.appendChild(r)}}}t.SignUp=r,customElements.define("sign-up",r)},451:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uploadProductPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/uploadProductPage/uploadProductPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","uploadProductPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-red");t.appendChild(n);const r=this.ownerDocument.createElement("div");r.setAttribute("id","uploadProductContainer"),t.appendChild(r);const i=this.ownerDocument.createElement("div");i.setAttribute("id","inputImageContainer"),r.appendChild(i);const s=this.ownerDocument.createElement("div");s.setAttribute("id","divInputImage"),s.style.backgroundImage="url(/src/resources/svg/navIcons/dark/uploadDark.svg)",i.appendChild(s);const o=this.ownerDocument.createElement("input");o.setAttribute("type","file"),s.appendChild(o);const a=this.ownerDocument.createElement("p");a.innerText="No file selected",i.appendChild(a);const c=this.ownerDocument.createElement("div");c.setAttribute("id","containerProductInputs"),r.appendChild(c);const u=this.ownerDocument.createElement("h1");u.innerText="Name of the product",c.appendChild(u);const l=this.ownerDocument.createElement("input");l.setAttribute("type","text"),l.setAttribute("placeholder","Enter the name of your new product"),c.appendChild(l);const h=this.ownerDocument.createElement("h1");h.innerText="Description of the product",c.appendChild(h);const d=this.ownerDocument.createElement("input");d.setAttribute("type","text"),d.setAttribute("placeholder","Describe for what purpose you created the product"),c.appendChild(d);const p=this.ownerDocument.createElement("h1");p.innerText="Price of the product",c.appendChild(p);const f=this.ownerDocument.createElement("div");f.setAttribute("id","priceContainer"),c.appendChild(f);const m=this.ownerDocument.createElement("input");m.setAttribute("type","number"),m.setAttribute("placeholder","Set price"),f.appendChild(m);const g=this.ownerDocument.createElement("button");g.innerText="+",g.setAttribute("id","priceUp"),f.appendChild(g);const y=this.ownerDocument.createElement("button");y.innerText="-",y.setAttribute("id","priceDown"),f.appendChild(y);const v=this.ownerDocument.createElement("button");v.setAttribute("id","uploadButton"),v.innerText="UPLOAD PRODUCT",c.appendChild(v)}}}t.uploadProductPage=r,customElements.define("uploadproduct-page",r)},4197:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userInformationPage=void 0,n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}render(){if(this.shadowRoot){const e=this.ownerDocument.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href","/src/pages/userInformationPage/userInformationPage.css"),this.shadowRoot.appendChild(e);const t=this.ownerDocument.createElement("section");t.setAttribute("id","userInformationPage"),this.shadowRoot.appendChild(t);const n=this.ownerDocument.createElement("navbar-red");t.appendChild(n);const r=this.ownerDocument.createElement("userinfo-title");t.appendChild(r);const i=this.ownerDocument.createElement("userinfo-rest");t.appendChild(i);const s=this.ownerDocument.createElement("div");s.setAttribute("id","buttonsContainer"),t.appendChild(s);const o=this.ownerDocument.createElement("button");o.setAttribute("id","buttonChangeData"),o.innerText="Change your data",s.appendChild(o);const a=this.ownerDocument.createElement("button");a.setAttribute("id","buttonLogOut"),a.innerText="LOG OUT",s.appendChild(a)}}}t.userInformationPage=r,customElements.define("userinformationpage-page",r)},4610:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeLogedUser=t.sideMenuVisibility=t.changeViewProduct=t.changeSeaarchText=t.changeScreen=void 0;const r=n(2823);t.changeScreen=e=>({type:r.Actions.CHANGE_SCREEN,payload:e}),t.changeSeaarchText=e=>({type:r.Actions.CHANGE_SEARCH_TEXT,payload:e}),t.changeViewProduct=e=>({type:r.Actions.CHANGE_VIEW_PRODUCT,payload:e}),t.sideMenuVisibility=e=>({type:r.Actions.SIDE_MENU_VISIBILITY,payload:e}),t.changeLogedUser=e=>({type:r.Actions.CHANGE_LOGED_USER,payload:e})},8527:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addObserver=t.dispatch=t.state=void 0;const r=n(4158),i=n(4601),s=[];t.state={screen:r.Screens.landingPage,searchText:"",viewProduct:"",sideMenu:!1,logedUserID:""},t.dispatch=e=>{const n=JSON.parse(JSON.stringify(t.state));t.state=(0,i.reducer)(e,n),s.forEach((e=>e.render())),console.log(t.state)},t.addObserver=e=>{s.push(e)}},4601:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=void 0;const r=n(2823);t.reducer=(e,t)=>{switch(e.type){case r.Actions.CHANGE_SCREEN:return Object.assign(Object.assign({},t),{screen:e.payload});case r.Actions.CHANGE_SEARCH_TEXT:return Object.assign(Object.assign({},t),{searchText:e.payload});case r.Actions.CHANGE_VIEW_PRODUCT:return Object.assign(Object.assign({},t),{viewProduct:e.payload});case r.Actions.SIDE_MENU_VISIBILITY:return Object.assign(Object.assign({},t),{sideMenu:e.payload});case r.Actions.CHANGE_LOGED_USER:return Object.assign(Object.assign({},t),{logedUserID:e.payload});default:return t}}},4158:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Screens=void 0,function(e){e.landingPage="landingPage",e.mainPage="mainPage",e.signUp="signUp",e.logIn="logIn",e.forgotPassword="forgotPassword",e.searchPage="searchPage",e.shopingList="shopingList",e.productDetail="productDetail",e.userInformation="userInformation",e.uploadProduct="uploadProduct",e.shoopingList="shoopingList",e.paymentPage="paymentPage",e.myProductsPage="myProductsPage"}(n||(t.Screens=n={}))},2823:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Actions=void 0,function(e){e.CHANGE_SCREEN="CHANGE_SCREEN",e.CHANGE_SEARCH_TEXT="CHANGE_SEARCH_TEXT",e.CHANGE_VIEW_PRODUCT="CHANGE_VIEW_PRODUCT",e.SIDE_MENU_VISIBILITY="SIDE_MENU_VISIBILITY",e.CHANGE_LOGED_USER="CHANGE_LOGED_USER"}(n||(t.Actions=n={}))},181:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataUsers=void 0,t.dataUsers=[]},632:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reiniciarloginData=t.loginData=void 0,t.loginData={email:"",password:""},t.reiniciarloginData=()=>{t.loginData={email:"",password:""}}},368:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reiniciarRegisterData=t.registerData=void 0,t.registerData={name:"",lastName:"",email:"",cellphone:"",password:"",confirmPassword:""},t.reiniciarRegisterData=()=>{t.registerData={name:"",lastName:"",email:"",cellphone:"",password:"",confirmPassword:""}}},424:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteDB:()=>g,openDB:()=>m,unwrap:()=>f,wrap:()=>p});const r=(e,t)=>t.some((t=>e instanceof t));let i,s;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(f(this),e),p(o.get(this))}:function(...e){return p(t.apply(f(this),e))}:function(e,...n){const r=t.call(f(this),e,...n);return c.set(r,e.sort?e.sort():[e]),p(r)}:(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));a.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e);var t}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(p(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&o.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=d(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const f=e=>l.get(e);function m(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=p(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(p(o.result),e.oldVersion,e.newVersion,p(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function g(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),p(n).then((()=>{}))}const y=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],w=new Map;function b(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=v.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!y.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return w.set(t,s),s}var E;E=h,h={...E,get:(e,t,n)=>b(e,t)||E.get(e,t,n),has:(e,t)=>!!b(e,t)||E.has(e,t)}},582:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>O,__assign:()=>s,__asyncDelegator:()=>S,__asyncGenerator:()=>I,__asyncValues:()=>D,__await:()=>C,__awaiter:()=>f,__classPrivateFieldGet:()=>P,__classPrivateFieldIn:()=>N,__classPrivateFieldSet:()=>L,__createBinding:()=>g,__decorate:()=>a,__disposeResources:()=>R,__esDecorate:()=>u,__exportStar:()=>y,__extends:()=>i,__generator:()=>m,__importDefault:()=>k,__importStar:()=>x,__makeTemplateObject:()=>T,__metadata:()=>p,__param:()=>c,__propKey:()=>h,__read:()=>w,__rest:()=>o,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>b,__spreadArray:()=>_,__spreadArrays:()=>E,__values:()=>v,default:()=>F});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function a(e,t,n,r){var i,s=arguments.length,o=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,n,o):i(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t,n,r,i,s){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=r.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?r.static?e:e.prototype:null,h=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),d=!1,p=n.length-1;p>=0;p--){var f={};for(var m in r)f[m]="access"===m?{}:r[m];for(var m in r.access)f.access[m]=r.access[m];f.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(e||null))};var g=(0,n[p])("accessor"===c?{get:h.get,set:h.set}:h[u],f);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=o(g.get))&&(h.get=a),(a=o(g.set))&&(h.set=a),(a=o(g.init))&&i.unshift(a)}else(a=o(g))&&("field"===c?i.unshift(a):h[u]=a)}l&&Object.defineProperty(l,r.name,h),d=!0}function l(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function m(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(w(arguments[t]));return e}function E(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)r[i]=s[o];return r}function _(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function C(e){return this instanceof C?(this.v=e,this):new C(e)}function I(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){s.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof C?Promise.resolve(n.value.v).then(c,u):l(s[0][2],n)}catch(e){l(s[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function S(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:C(e[r](t)),done:!1}:i?i(t):t}:i}}function D(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var A=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function x(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return A(t,e),t}function k(e){return e&&e.__esModule?e:{default:e}}function P(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function L(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function N(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function O(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose]}if("function"!=typeof r)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var M="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function R(e){function t(t){e.error=e.hasError?new M(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:i,__assign:s,__rest:o,__decorate:a,__param:c,__metadata:p,__awaiter:f,__generator:m,__createBinding:g,__exportStar:y,__values:v,__read:w,__spread:b,__spreadArrays:E,__spreadArray:_,__await:C,__asyncGenerator:I,__asyncDelegator:S,__asyncValues:D,__makeTemplateObject:T,__importStar:x,__importDefault:k,__classPrivateFieldGet:P,__classPrivateFieldSet:L,__classPrivateFieldIn:N,__addDisposableResource:O,__disposeResources:R}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";const e=n(8527),t=n(4158);n(3945);class r extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),(0,e.addObserver)(this)}connectedCallback(){this.render()}render(){if(null!=this.shadowRoot||null!=this.shadowRoot){this.shadowRoot.innerHTML="",document.body.classList.remove(...document.body.classList);const n=this.ownerDocument.createElement("side-menu");switch(this.shadowRoot.appendChild(n),e.state.screen){case t.Screens.landingPage:const e=this.ownerDocument.createElement("landing-page");this.shadowRoot.appendChild(e),document.body.classList.add("landingPage");break;case t.Screens.signUp:const n=this.ownerDocument.createElement("sign-up");this.shadowRoot.appendChild(n);break;case t.Screens.mainPage:const r=this.ownerDocument.createElement("main-page");this.shadowRoot.appendChild(r);break;case t.Screens.logIn:const i=this.ownerDocument.createElement("login-page");this.shadowRoot.appendChild(i);break;case t.Screens.forgotPassword:const s=this.ownerDocument.createElement("forgotpassword-page");this.shadowRoot.appendChild(s);break;case t.Screens.searchPage:const o=this.ownerDocument.createElement("search-page");this.shadowRoot.appendChild(o);break;case t.Screens.shopingList:const a=this.ownerDocument.createElement("shoping-list");this.shadowRoot.appendChild(a);break;case t.Screens.productDetail:const c=this.ownerDocument.createElement("product-detail");this.shadowRoot.appendChild(c);break;case t.Screens.userInformation:const u=this.ownerDocument.createElement("userinformationpage-page");this.shadowRoot.appendChild(u);break;case t.Screens.uploadProduct:const l=this.ownerDocument.createElement("uploadproduct-page");this.shadowRoot.appendChild(l);break;case t.Screens.shoopingList:const h=this.ownerDocument.createElement("shooping_list-page");this.shadowRoot.appendChild(h);break;case t.Screens.paymentPage:const d=this.ownerDocument.createElement("payment-page");this.shadowRoot.appendChild(d);break;case t.Screens.myProductsPage:const p=this.ownerDocument.createElement("my_products-page");this.shadowRoot.appendChild(p)}}}}customElements.define("app-container",r)})()})();